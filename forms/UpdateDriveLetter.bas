Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =5760
    DatasheetFontHeight =11
    ItemSuffix =60
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0x889c6f9a77e9e340
    End
    DatasheetFontName ="Calibri"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            AutoHeight =1
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =3795
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Update Drive Letter"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =4095
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5280
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =5280
                    LayoutCachedTop =120
                    LayoutCachedWidth =5646
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            Height =960
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =4020
                    Top =540
                    Width =1199
                    Height =315
                    TabIndex =1
                    BorderColor =7169897
                    Name ="txtNewLetter"
                    Format =">"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =4020
                    LayoutCachedTop =540
                    LayoutCachedWidth =5219
                    LayoutCachedHeight =855
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =34
                            Left =360
                            Top =540
                            Width =3600
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtNewLetter_Label"
                            Caption ="Enter the new letter for this drive:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =360
                            LayoutCachedTop =540
                            LayoutCachedWidth =3960
                            LayoutCachedHeight =810
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin ComboBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =4020
                    Top =120
                    Width =1200
                    Height =315
                    BorderColor =7169897
                    Name ="cboOldLetter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Left([FilePath],1) AS DriveLetter FROM Photos GROUP BY Left([FilePath],1)"
                        ";"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =4020
                    LayoutCachedTop =120
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =435
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =34
                            Left =360
                            Top =120
                            Width =3600
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboOldLetter_Label"
                            Caption ="Select the drive letter you want to update:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =360
                            LayoutCachedTop =120
                            LayoutCachedWidth =3960
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5280
                    Top =120
                    Width =240
                    Height =315
                    TabIndex =3
                    ForeColor =2366701
                    Name ="txtOldLetterReqd"
                    ControlSource ="=IIf([cboOldLetter] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5280
                    LayoutCachedTop =120
                    LayoutCachedWidth =5520
                    LayoutCachedHeight =435
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5280
                    Top =540
                    Width =240
                    Height =315
                    TabIndex =4
                    ForeColor =2366701
                    Name ="txtNewLetterReqd"
                    ControlSource ="=IIf([txtNewLetter] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5280
                    LayoutCachedTop =540
                    LayoutCachedWidth =5520
                    LayoutCachedHeight =855
                End
            End
        End
        Begin FormFooter
            Height =660
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =840
                    Top =60
                    Width =1920
                    Height =420
                    Name ="cmdUpdate"
                    Caption ="Update"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =840
                    LayoutCachedTop =60
                    LayoutCachedWidth =2760
                    LayoutCachedHeight =480
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =3720
                    Top =60
                    Width =1920
                    Height =420
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3720
                    LayoutCachedTop =60
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =480
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =215
                    TextAlign =2
                    TextFontFamily =34
                    Width =5760
                    Height =660
                    FontSize =14
                    TopMargin =115
                    BackColor =6108695
                    BorderColor =0
                    ForeColor =-2147483608
                    Name ="lblStatus"
                    Caption ="Updating location..."
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =660
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The Drive Updater form encountered an error."

Private Sub cboOldLetter_AfterUpdate()
'Enable/disable update button

Call txtNewLetter_AfterUpdate

End Sub

Private Sub cmdCancel_Click()
'Close form

On Error GoTo ErrHandler

DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, Me.Name & " Form Help"

End Sub

Private Sub cmdUpdate_Click()
'Run update query on Photos table

Dim lngImages As Long
Dim strSQL As String
Dim strFind As String
Dim strReplace As String

On Error GoTo ErrHandler

'Test folders and required fields
If TestControls And TestPaths Then
    LockForm True
Else
    Exit Sub
End If

'Prompt for confirmation
strFind = Me.cboOldLetter
lngImages = DCount("*", "Photos", "Left([FilePath],1)=" & chr(34) & strFind & chr(34))
If MsgBox("Location will be updated for " & lngImages & " photos." & _
    vbNewLine & vbNewLine & "Press OK to continue.", vbOKCancel, _
    "Confirm Update") = vbCancel Then
    MsgBox "Update Canceled."
    GoTo UpdateExit
End If

'Update Photos Table
strFind = strFind & ":\"
strReplace = Me.txtNewLetter & ":\"
strSQL = "UPDATE Photos SET Photos.FilePath = Replace([FilePath],'" & _
    strFind & "','" & strReplace & "');"
DoCmd.SetWarnings False
DoCmd.RunSQL strSQL

MsgBox "Drive letter updated."

UpdateExit:
    DoCmd.SetWarnings True
    LockForm False
    ResetForm
    DoCmd.Close
    Exit Sub

ErrHandler:
    ErrorMsg "Update failed.", Err.Number, Err.Description
    Resume UpdateExit

End Sub

Private Sub txtNewLetter_AfterUpdate()
'Enable/disable update button

On Error GoTo ErrHandler

If IsNull(Me.txtNewLetter) Then
    Me.cmdUpdate.Enabled = False
    Exit Sub
End If

If IsNull(Me.cboOldLetter) Then
    Me.cmdUpdate.Enabled = False
    Exit Sub
End If

Me.cmdUpdate.Enabled = True
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub LockForm(Optional bLocked As Boolean = True)
'Prevent changes while updating

Me.txtFocus.SetFocus
AccessCloseButtonEnabled Not bLocked
Me.cmdUpdate.Enabled = Not bLocked
Me.cmdCancel.Enabled = Not bLocked
Me.txtNewLetter.Enabled = Not bLocked
Me.cboOldLetter.Enabled = Not bLocked
Me.lblStatus.Visible = bLocked
Me.Repaint
DoEvents

End Sub

Private Sub ResetForm()
'Clear controls

Me.txtFocus.SetFocus
Me.cmdUpdate.Enabled = False
Me.cboOldLetter = Null
Me.txtNewLetter = Null
Me.cboOldLetter.Requery

End Sub

Private Function TestControls() As Boolean
'Test for required information in the form

TestControls = True

'New letter blank
If IsNull(Me.txtNewLetter) Then
    MsgBox "You must specify the new drive letter to continue.", _
        vbExclamation, "Update canceled."
    TestControls = False
End If

'Old letter blank
If IsNull(Me.cboOldLetter) Then
    MsgBox "You must select the letter you want to update.", _
        vbExclamation, "Update canceled."
    TestControls = False
End If

End Function

Private Function TestPaths() As Boolean
'Test for correct paths before getting started

Dim fso As Object

Set fso = CreateObject("scripting.FileSystemObject")
TestPaths = True

'Target doesn't exist
If Not fso.FolderExists(Me.txtNewLetter & ":") Then
    MsgBox "The drive you specified doesn't exist.", _
        vbExclamation, "Update Canceled."
    TestPaths = False
End If

Set fso = Nothing

'Same letter
If Me.cboOldLetter = Me.txtNewLetter Then
    MsgBox "The drive letters are the same.", vbExclamation, _
        "Update Canceled."
    TestPaths = False
End If

End Function
