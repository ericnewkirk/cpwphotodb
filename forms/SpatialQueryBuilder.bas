Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ViewsAllowed =1
    TabularCharSet =163
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =11520
    DatasheetFontHeight =11
    ItemSuffix =91
    Right =20595
    Bottom =14325
    RecSrcDt = Begin
        0xc9986d622d66e440
    End
    Caption ="SpatialQueryBuilder"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =163
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =7680
                    Height =525
                    FontSize =20
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Label2"
                    Caption ="Spatial Query Builder"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =11040
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    HorizontalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =11040
                    LayoutCachedTop =120
                    LayoutCachedWidth =11406
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =6240
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =3900
                    Width =2760
                    Height =285
                    TabIndex =1
                    BorderColor =7169897
                    Name ="cboSpecies"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, Species.CommonName FROM Species WHERE (((Species.Speci"
                        "esID)>0)) ORDER BY Species.CommonName;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3900
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =4185
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =900
                            Top =3900
                            Width =1799
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpecies_Label"
                            Caption ="Filter by species:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =900
                            LayoutCachedTop =3900
                            LayoutCachedWidth =2699
                            LayoutCachedHeight =4185
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =2880
                    Top =4230
                    Width =2760
                    TabIndex =3
                    Name ="cmdMultiSp"
                    Caption ="Select Multiple Species"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4230
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =4590
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =3900
                    Width =2490
                    Height =285
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtMultiSp"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3900
                    LayoutCachedWidth =5370
                    LayoutCachedHeight =4185
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =2820
                    Width =7502
                    Height =597
                    TabIndex =5
                    Name ="Frame100"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =2820
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =3417
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =2700
                            Width =1440
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label101"
                            Caption ="Location Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =2700
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =2985
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =3060
                    Width =2519
                    Height =285
                    TabIndex =6
                    BorderColor =7169897
                    Name ="cboStudyArea"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT StudyAreas.StudyAreaID, First(StudyAreas.StudyAreaName) AS FirstOfStudyAr"
                        "eaName FROM StudyAreas INNER JOIN CameraLocations ON StudyAreas.StudyAreaID = Ca"
                        "meraLocations.StudyAreaID GROUP BY StudyAreas.StudyAreaID ORDER BY First(StudyAr"
                        "eas.StudyAreaName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"
                    AllowValueListEdits =0

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3060
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =3345
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =3060
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboStudyArea_Label"
                            Caption ="Study Area:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =3060
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =3345
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5040
                    Top =5160
                    Width =1920
                    Height =420
                    TabIndex =7
                    Name ="cmdExport"
                    Caption ="Export"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5040
                    LayoutCachedTop =5160
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =5580
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =960
                    Top =5160
                    Width =1920
                    Height =420
                    TabIndex =8
                    Name ="cmdQuery"
                    Caption ="Open Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =960
                    LayoutCachedTop =5160
                    LayoutCachedWidth =2880
                    LayoutCachedHeight =5580
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =5700
                    Width =1920
                    Height =420
                    TabIndex =9
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =5700
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =6120
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =5160
                    Width =1920
                    Height =420
                    TabIndex =10
                    Name ="cmdSave"
                    Caption ="Save Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =5160
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =5580
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5520
                    Top =120
                    Width =2100
                    TabIndex =4
                    Name ="cmdUpdate"
                    Caption ="Update Results"
                    OnClick ="=RefreshResults()"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5520
                    LayoutCachedTop =120
                    LayoutCachedWidth =7620
                    LayoutCachedHeight =480
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =255
                    Left =120
                    Top =3660
                    Width =7502
                    Height =1317
                    TabIndex =11
                    Name ="Frame80"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =3660
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =4977
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =240
                            Top =3540
                            Width =1440
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label81"
                            Caption ="Species Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =3540
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =3825
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =4635
                    Width =2760
                    Height =285
                    TabIndex =12
                    BorderColor =7169897
                    Name ="cboSpeciesGroup"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT SpeciesGroups.GroupID, First(SpeciesGroups.GroupName) AS FirstOfGroupName"
                        " FROM SpeciesGroups INNER JOIN Species ON SpeciesGroups.GroupID = Species.GroupI"
                        "D GROUP BY SpeciesGroups.GroupID ORDER BY First(SpeciesGroups.GroupName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4635
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =4920
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =900
                            Top =4635
                            Width =1799
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpeciesGroup_Label"
                            Caption ="Filter by Group:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =900
                            LayoutCachedTop =4635
                            LayoutCachedWidth =2699
                            LayoutCachedHeight =4920
                        End
                    End
                End
                Begin Subform
                    CanGrow = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =7920
                    Top =360
                    Width =3480
                    Height =5760
                    TabIndex =13
                    Name ="ResultsSubform"
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =7920
                    LayoutCachedTop =360
                    LayoutCachedWidth =11400
                    LayoutCachedHeight =6120
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =7920
                            Top =120
                            Width =1440
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="ResultsSubform_Label"
                            Caption ="Results Preview:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =7920
                            LayoutCachedTop =120
                            LayoutCachedWidth =9360
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =85
                    Left =120
                    Top =540
                    Width =7502
                    Height =898
                    TabIndex =14
                    Name ="optSpatial"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =540
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =1438
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =420
                            Width =1230
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label59"
                            Caption ="Spatial Fields:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =420
                            LayoutCachedWidth =1470
                            LayoutCachedHeight =705
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =808
                            OptionValue =1
                            Name ="Option61"
                            Tag ="3: 2.8736/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =808
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1048
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =780
                                    Width =1019
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label62"
                                    Caption ="Lat/Long"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =780
                                    LayoutCachedWidth =1849
                                    LayoutCachedHeight =1065
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =1138
                            OptionValue =2
                            Name ="Option63"
                            Tag ="3: 3.1028/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =1138
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1378
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =1110
                                    Width =1020
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label64"
                                    Caption ="UTM"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =1110
                                    LayoutCachedWidth =1850
                                    LayoutCachedHeight =1395
                                End
                            End
                        End
                    End
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =85
                    Left =120
                    Top =1678
                    Width =7502
                    Height =898
                    TabIndex =15
                    Name ="optQueryType"
                    AfterUpdate ="=EnableSpecies()"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =1678
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =2576
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =1558
                            Width =1020
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label86"
                            Caption ="Query Type:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =1558
                            LayoutCachedWidth =1260
                            LayoutCachedHeight =1843
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =1946
                            OptionValue =1
                            Name ="Option87"
                            Tag ="3: 2.8736/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =1946
                            LayoutCachedWidth =860
                            LayoutCachedHeight =2186
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =1918
                                    Width =3614
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label88"
                                    Caption ="Camera Locations Only"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =1918
                                    LayoutCachedWidth =4444
                                    LayoutCachedHeight =2203
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =2276
                            OptionValue =2
                            Name ="Option89"
                            Tag ="3: 3.1028/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =2276
                            LayoutCachedWidth =860
                            LayoutCachedHeight =2516
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =825
                                    Top =2250
                                    Width =1920
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label90"
                                    Caption ="Locations with Results"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =825
                                    LayoutCachedTop =2250
                                    LayoutCachedWidth =2745
                                    LayoutCachedHeight =2535
                                End
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The Spatial Query form encountered an error."

Private Sub cboSpecies_AfterUpdate()
'disable group combo

On Error GoTo ErrHandler

DisableButtons

If Not IsNull(Me.cboSpecies) Then
    Me.cmdUpdate.SetFocus
End If

Me.cmdMultiSp.Enabled = IsNull(Me.cboSpecies)
Me.cboSpeciesGroup.Enabled = IsNull(Me.cboSpecies)

ErrHandler:
    Exit Sub

End Sub

Private Sub cboSpeciesGroup_AfterUpdate()
'Disable species filters

On Error GoTo ErrHandler

DisableButtons

If Not IsNull(Me.cboSpeciesGroup) Then
    Me.cmdUpdate.SetFocus
End If

Me.cmdMultiSp.Enabled = IsNull(Me.cboSpeciesGroup)
Me.cboSpecies.Enabled = IsNull(Me.cboSpeciesGroup)

ErrHandler:
    Exit Sub

End Sub

Private Sub cmdClose_Click()
'Close the form

On Error GoTo ErrHandler

Me.ResultsSubform.SourceObject = ""
DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdExport_Click()
'Open the form for exporting quieries

On Error GoTo ErrHandler

DoCmd.OpenForm "ExportQuery", , , _
    "QueryName='" & GetQueryName() & "'", , acDialog, "Spatial"
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the export form.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "Spatial Query Help"

End Sub

Private Sub cmdMultiSp_Click()
'Allows user to select multiple species

Me.cboSpecies = Null
Me.cboSpeciesGroup = Null

If Me.cmdMultiSp.Caption = "Remove Multi-Species Filter" Then
    Me.cboSpecies.Tag = ""
    Me.cboSpecies.Enabled = True
    Me.cboSpecies.SetFocus
    Me.cboSpeciesGroup.Enabled = True
    Me.txtMultiSp = Null
    Me.txtMultiSp.Visible = False
    Me.cmdMultiSp.Caption = "Select Multiple Species"
Else
    'Create temporary table
    SpSelectTable
    'Go to selection form
    DoCmd.OpenForm "SpeciesTemp", , , , , acDialog, "Spatial"
    If Len(Me.cboSpecies.Tag) > 0 Then
        Me.cmdMultiSp.Caption = "Remove Multi-Species Filter"
        Me.cmdMultiSp.SetFocus
        Me.cboSpecies.Enabled = False
        Me.cboSpeciesGroup.Enabled = False
        Me.txtMultiSp = "(Multiple)"
        Me.txtMultiSp.Visible = True
    End If
End If

DisableButtons
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdQuery_Click()
'Open the query results in a separate tab

On Error GoTo ErrHandler

DoCmd.OpenQuery GetQueryName()

Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the query.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdSave_Click()
'Saves a new query in the database

Dim strQryName As String
Dim lngObjID As Long
Dim lngGroupID As Long

On Error GoTo ErrHandler

'Prompt for name
strQryName = InputBox("Enter a name for the new query:")
SaveQuery strQryName, _
    CurrentDb.QueryDefs(GetQueryName()).SQL

'Add the query to the My Queries nav pane group
lngObjID = Nz(DLookup("ID", "MSysObjects", "Name='" & _
    strQryName & "'"), 0)
lngGroupID = Nz(DLookup("ID", "MSysNavPaneGroups", "Name='" & _
    "My Queries'"), 0)
If lngObjID <> 0 And lngGroupID <> 0 Then
    DoCmd.SetWarnings False
    DoCmd.RunSQL "INSERT INTO MSysNavPaneGroupToObjects " & _
        "( GroupID, ObjectID ) VALUES ( " & lngGroupID & _
        ", " & lngObjID & " )"
End If

CSExit:
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred while saving the query.", _
        Err.Number, Err.Description
    Resume CSExit

End Sub

Private Sub Form_Close()
'Restore switchboard

RestoreSwitchboard

End Sub

Private Sub Form_Open(Cancel As Integer)
'Minimize switchboard

On Error GoTo ErrHandler

HideSwitchboard acForm, Me.Name
BuildQuery
RefreshResults
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub BuildQuery()
'Updates the SQL for the detection query

Dim strSelect As String
Dim strFrom As String
Dim strWhere As String
Dim strGroup As String
Dim strOrder As String
Dim strSQL As String

'Build select and from based on type
If Me.optQueryType = 1 Then
    'Camera locations query
    strSelect = "SELECT CameraLocations.LocationID, " & _
        "CameraLocations.LocationName, StudyAreas.StudyAreaID, " & _
        "StudyAreas.StudyAreaName, "
    If Me.optSpatial = 1 Then
        'Lat/long fields
        strSelect = strSelect & "CameraLocations.LatitudeDD AS " & _
            "Latitude, CameraLocations.LongitudeDD AS Longitude, "
        strWhere = "WHERE (((CameraLocations.LatitudeDD) Is Not Null) " & _
            "AND ((CameraLocations.LongitudeDD) Is Not Null)"
    Else
        'UTM fields
        strSelect = strSelect & "CameraLocations.UTM_E, " & _
            "CameraLocations.UTM_N, CameraLocations.UTMZone, "
        strWhere = "WHERE (((CameraLocations.UTM_E) Is Not Null) " & _
            "AND ((CameraLocations.UTM_N) Is Not Null)"
    End If
    strSelect = strSelect & "CameraLocations.AccessNotes "
    strFrom = "FROM StudyAreas INNER JOIN " & _
        "CameraLocations ON StudyAreas.StudyAreaID = " & _
        "CameraLocations.StudyAreaID "
    strOrder = "ORDER BY CameraLocations.LocationName"
Else
    'Results query
    strSelect = "SELECT First(StudyAreas.StudyAreaID) AS StudyAreaID, " & _
        "First(StudyAreas.StudyAreaName) AS StudyAreaName, " & _
        "CameraLocations.LocationID, " & _
        "First(CameraLocations.LocationName) AS LocationName, " & _
        "Species.SpeciesID, First(Species.CommonName) AS CommonName, " & _
        "Count(Photos.ImageID) AS Photos, "
    strFrom = "FROM ((StudyAreas INNER JOIN CameraLocations ON " & _
        "StudyAreas.StudyAreaID = CameraLocations.StudyAreaID) " & _
        "INNER JOIN Visits ON CameraLocations.LocationID = " & _
        "Visits.LocationID) INNER JOIN ((Photos INNER JOIN " & _
        "qryPhotoSpecies ON Photos.ImageID = qryPhotoSpecies.ImageID) " & _
        "INNER JOIN Species ON qryPhotoSpecies.SpeciesID = " & _
        "Species.SpeciesID) ON Visits.VisitID = Photos.VisitID "
    If Me.optSpatial = 1 Then
        'Lat/long fields
        strSelect = strSelect & "First(CameraLocations.LatitudeDD) AS " & _
            "Latitude, First(CameraLocations.LongitudeDD) AS Longitude "
        strWhere = "WHERE (((CameraLocations.LatitudeDD) Is Not Null) " & _
            "AND ((CameraLocations.LongitudeDD) Is Not Null)"
    Else
        'UTM fields
        strSelect = strSelect & "First(CameraLocations.UTM_E) AS " & _
            "UTM_E, First(CameraLocations.UTM_N) AS UTM_N, " & _
            "First(CameraLocations.UTMZone) AS [Zone], " & _
            "First(CameraLocations.UTMDatum) AS Datum, " & _
            "First(Nz([CameraLocations].[UTMHemisphere],'N')) AS " & _
            "Hemisphere "
        strWhere = "WHERE (((CameraLocations.UTM_E) Is Not Null) " & _
            "AND ((CameraLocations.UTM_N) Is Not Null)"
    End If
    strGroup = "GROUP BY CameraLocations.LocationID, Species.SpeciesID "
    strOrder = "ORDER BY First(StudyAreas.StudyAreaName), " & _
        "First(CameraLocations.LocationName), First(Species.CommonName)"
End If

'Add filters
If Not IsNull(Me.cboStudyArea) Then
    strWhere = strWhere & " AND ((StudyAreas.StudyAreaID) = " & _
        Me.cboStudyArea & ")"
End If
If (Me.optQueryType = 2) Then
    If Not IsNull(Me.cboSpecies) Then
        strWhere = strWhere & " AND ((Species.SpeciesID) = " & _
            Me.cboSpecies & ")"
    Else
        If Not IsNull(Me.cboSpeciesGroup) Then
            strWhere = strWhere & " AND ((Species.GroupID) = " & _
                Me.cboSpeciesGroup & ")"
        Else
            If Len(Nz(Me.cboSpecies.Tag, "")) > 0 Then
                strWhere = strWhere & " AND ((Species.SpeciesID) " & _
                    "In (" & Me.cboSpecies.Tag & "))"
            End If
        End If
    End If
End If
strWhere = strWhere & ") "

'Assemble SQL statement
strSQL = strSelect & strFrom & strWhere & strGroup & strOrder & ";"

'Replace query SQL
SaveQuery GetQueryName(), strSQL

End Sub

Private Function DisableButtons() As Integer
'Disable output when data is not up to date

Dim strAC As String

On Error Resume Next
strAC = Me.ActiveControl.Name

On Error GoTo 0

If strAC = "cmdSave" Or strAC = "cmdExport" Or _
    strAC = "cmdQuery" Then
    Me.txtFocus.SetFocus
End If

Me.cmdSave.Enabled = False
Me.cmdExport.Enabled = False
Me.cmdQuery.Enabled = False
Me.cmdUpdate.Visible = True

End Function

Private Function EnableSpecies() As Integer

Dim bEnabled As Boolean

bEnabled = (Me.optQueryType = 2)

Me.txtMultiSp = Null
Me.txtMultiSp.Visible = False
Me.cboSpecies.Tag = ""
Me.cmdMultiSp.Caption = "Select Multiple Species"
Me.cboSpecies = Null
Me.cboSpeciesGroup = Null

Me.cboSpecies.Enabled = bEnabled
Me.cboSpeciesGroup.Enabled = bEnabled
Me.cmdMultiSp.Enabled = bEnabled

DisableButtons

End Function

Private Function GetQueryName() As String

Dim strQuery As String

strQuery = "qry"

If Me.optQueryType = 1 Then
    strQuery = strQuery & "CameraLocations"
Else
    strQuery = strQuery & "ResultsByLocation"
End If

If Me.optSpatial = 1 Then
    strQuery = strQuery & "LatLong"
Else
    strQuery = strQuery & "UTM"
End If

GetQueryName = strQuery

End Function

Private Function RefreshResults() As Integer
'Edit query definition and display new results in preview pane

Dim strAC As String

On Error Resume Next
strAC = Me.ActiveControl.Name

On Error GoTo 0

'Update query results and enable output buttons
Me.ResultsSubform.SourceObject = ""
BuildQuery
Me.ResultsSubform.SourceObject = "query." & GetQueryName()
Me.cmdQuery.Enabled = True
Me.cmdExport.Enabled = True
Me.cmdSave.Enabled = True

'Disable update button
If strAC = "cmdUpdate" Then
    Me.txtFocus.SetFocus
End If
Me.cmdUpdate.Visible = False

End Function
