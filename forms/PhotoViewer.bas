Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =186
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =19440
    DatasheetFontHeight =11
    ItemSuffix =131
    Left =2796
    Top =2412
    Right =22788
    Bottom =11808
    TimerInterval =300
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0x0ea7f44b96eae340
    End
    Caption ="PhotoViewer"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    OnTimer ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =255
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            BorderLineStyle =0
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Chart
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            BorderLineStyle =0
        End
        Begin Tab
            TextFontCharSet =186
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            BorderLineStyle =0
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =5040
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Camera Trapping Photo Viewer"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =5340
                    LayoutCachedHeight =585
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    TextFontFamily =34
                    Left =15405
                    Top =60
                    Width =3735
                    Height =435
                    FontSize =16
                    BackColor =6108695
                    BorderColor =16252927
                    ForeColor =-2147483608
                    Name ="lblFilters"
                    Caption ="Filters"
                    FontName ="Trebuchet MS"
                    OnClick ="[Event Procedure]"
                    LayoutCachedLeft =15405
                    LayoutCachedTop =60
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =495
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =10260
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin Image
                    PictureType =1
                    Left =4740
                    Top =1140
                    Width =9960
                    Height =7500
                    Name ="CurrImage"
                    OnDblClick ="[Event Procedure]"
                    ControlSource ="=[CamFilmStrip]![ImgPath]"

                    LayoutCachedLeft =4740
                    LayoutCachedTop =1140
                    LayoutCachedWidth =14700
                    LayoutCachedHeight =8640
                    TabIndex =35
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =8595
                    Top =9540
                    Width =1200
                    Height =314
                    TabIndex =13
                    Name ="chkAdvance"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    ControlTipText ="Check to advance the form on a timer like a slideshow"

                    LayoutCachedLeft =8595
                    LayoutCachedTop =9540
                    LayoutCachedWidth =9795
                    LayoutCachedHeight =9854
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =6300
                            Top =9540
                            Width =2235
                            Height =314
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label15"
                            Caption ="Advance Automatically"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =6300
                            LayoutCachedTop =9540
                            LayoutCachedWidth =8535
                            LayoutCachedHeight =9854
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =11715
                    Top =9540
                    Width =1200
                    Height =315
                    TabIndex =14
                    BorderColor =7169897
                    Name ="txtSeconds"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Specify how long to display each photo before moving to the next"

                    LayoutCachedLeft =11715
                    LayoutCachedTop =9540
                    LayoutCachedWidth =12915
                    LayoutCachedHeight =9855
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =9420
                            Top =9540
                            Width =2235
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label17"
                            Caption ="Seconds per photo:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =9420
                            LayoutCachedTop =9540
                            LayoutCachedWidth =11655
                            LayoutCachedHeight =9855
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4380
                    Top =8760
                    Width =2160
                    Height =555
                    TabIndex =15
                    Name ="cmdEditID"
                    Caption ="Edit Species ID"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Opens the PhotoID form with this photo loaded"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =4380
                    LayoutCachedTop =8760
                    LayoutCachedWidth =6540
                    LayoutCachedHeight =9315
                End
                Begin Subform
                    OverlapFlags =87
                    Width =4140
                    Height =10260
                    TabIndex =21
                    BorderColor =7233610
                    Name ="CamFilmStrip"
                    SourceObject ="Form.CamFilmStrip"

                    LayoutCachedWidth =4140
                    LayoutCachedHeight =10260
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =4380
                    Top =720
                    Width =10680
                    Height =330
                    FontSize =11
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="lblFileName"
                    Caption ="XXX_00001.jpg"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =4380
                    LayoutCachedTop =720
                    LayoutCachedWidth =15060
                    LayoutCachedHeight =1050
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =1
                    TextFontFamily =34
                    Left =15180
                    Width =4260
                    Height =10260
                    FontSize =11
                    BackColor =6108695
                    BorderColor =16252927
                    ForeColor =7169897
                    Name ="FilterDataBorder"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15180
                    LayoutCachedWidth =19440
                    LayoutCachedHeight =10260
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =7079
                    Width =3720
                    Height =330
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblDate"
                    Caption ="Date: 10/8/2014"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =7079
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =7409
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =2
                    TextFontFamily =34
                    Left =15420
                    Top =6480
                    Width =3720
                    Height =435
                    FontSize =16
                    BackColor =16252927
                    BorderColor =16252927
                    ForeColor =-2147483608
                    Name ="Label51"
                    Caption ="Image Data"
                    FontName ="Trebuchet MS"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =6480
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =6915
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =7529
                    Width =3720
                    Height =330
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblTime"
                    Caption ="Time: 12:18 PM"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =7529
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =7859
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =7980
                    Width =3720
                    Height =330
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblEasting"
                    Caption ="UTM E: "
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =7980
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =8310
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =8429
                    Width =3720
                    Height =330
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblNorthing"
                    Caption ="UTM N: "
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =8429
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =8759
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =8879
                    Width =3720
                    Height =720
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblSpecies"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =8879
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =9599
                End
                Begin Label
                    OldBorderStyle =1
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =15420
                    Top =9719
                    Width =3720
                    Height =435
                    FontSize =11
                    BackColor =16252927
                    BorderColor =7169897
                    ForeColor =16252927
                    Name ="lblComments"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =15420
                    LayoutCachedTop =9719
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =10154
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2160
                    Left =16800
                    Top =540
                    Width =2340
                    Height =315
                    BorderColor =7169897
                    Name ="cboAreaFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT StudyAreas.StudyAreaID, First(StudyAreas.StudyAreaName) & ' (' & Count(qr"
                        "yPVComboRowSource.ImgID) & ')' As AText FROM qryPVComboRowSource INNER JOIN Stud"
                        "yAreas ON qryPVComboRowSource.StudyAreaID = StudyAreas.StudyAreaID GROUP BY Stud"
                        "yAreas.StudyAreaID ORDER BY First(StudyAreas.StudyAreaName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=UpdateForm()"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by study area"

                    LayoutCachedLeft =16800
                    LayoutCachedTop =540
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =855
                    Begin
                        Begin Label
                            OverlapFlags =223
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =540
                            Width =1200
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboAreaFilter_Label"
                            Caption ="Study Area:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =540
                            LayoutCachedWidth =16620
                            LayoutCachedHeight =870
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =16980
                    Top =540
                    Width =2160
                    Height =315
                    TabIndex =2
                    BorderColor =7169897
                    Name ="cboSeasonFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryPVComboRowSource.FieldSeason, FieldSeason & ' (' & Count(ImgID) & ')' "
                        "AS SText FROM qryPVComboRowSource GROUP BY qryPVComboRowSource.FieldSeason ORDER"
                        " BY qryPVComboRowSource.FieldSeason;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=UpdateForm()"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by year when camera was set"

                    LayoutCachedLeft =16980
                    LayoutCachedTop =540
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =855
                    Begin
                        Begin Label
                            OverlapFlags =223
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =540
                            Width =1350
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboSeasonFilter_Label"
                            Caption ="Field Season:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =540
                            LayoutCachedWidth =16770
                            LayoutCachedHeight =870
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =16500
                    Top =540
                    Width =2640
                    Height =315
                    TabIndex =3
                    BorderColor =7169897
                    Name ="cboSpeciesFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, First(Species.ShortName) & ' (' & Count(qryPVComboWith"
                        "Species.ImgID) & ')' As SText FROM qryPVComboWithSpecies INNER JOIN Species ON q"
                        "ryPVComboWithSpecies.SpeciesID = Species.SpeciesID GROUP BY Species.SpeciesID OR"
                        "DER BY First(Species.ShortName);"
                    ColumnWidths ="0;2160"
                    AfterUpdate ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by species"

                    LayoutCachedLeft =16500
                    LayoutCachedTop =540
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =855
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =540
                            Width =885
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboSpeciesFilter_Label"
                            Caption ="Species:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =540
                            LayoutCachedWidth =16305
                            LayoutCachedHeight =870
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =223
                    Left =18599
                    Top =1440
                    Width =240
                    TabIndex =7
                    Name ="chkHighlight"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display only photos marked as highlights"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =1440
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =1680
                    Begin
                        Begin Label
                            OverlapFlags =223
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =1440
                            Width =1680
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkHighlight_Label"
                            Caption ="Highlights only:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =1440
                            LayoutCachedWidth =17100
                            LayoutCachedHeight =1770
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =223
                    TextFontFamily =34
                    Left =15420
                    Top =990
                    Width =3720
                    Height =314
                    TabIndex =4
                    Name ="cmdMultiSpecies"
                    Caption ="Multiple Species"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =15420
                    LayoutCachedTop =990
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1304
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =16560
                    Top =990
                    Width =2580
                    Height =315
                    TabIndex =8
                    BorderColor =7169897
                    Name ="cboDateFilter"
                    RowSourceType ="Value List"
                    RowSource ="\"Before\";\"Between\";\"After\""
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="Null"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by date or date range"
                    AllowValueListEdits =0

                    LayoutCachedLeft =16560
                    LayoutCachedTop =990
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1305
                    Begin
                        Begin Label
                            OverlapFlags =223
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =990
                            Width =885
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboDateFilter_Label"
                            Caption ="Date:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =990
                            LayoutCachedWidth =16305
                            LayoutCachedHeight =1320
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =16560
                    Top =2790
                    Width =2580
                    Height =315
                    TabIndex =9
                    BorderColor =7169897
                    Name ="cboTimeFilter"
                    RowSourceType ="Value List"
                    RowSource ="\"Before\";\"Between\";\"After\""
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="Null"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by time or time range"
                    AllowValueListEdits =0

                    LayoutCachedLeft =16560
                    LayoutCachedTop =2790
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =3105
                    Begin
                        Begin Label
                            OverlapFlags =223
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =2790
                            Width =885
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboTimeFilter_Label"
                            Caption ="Time:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =2790
                            LayoutCachedWidth =16305
                            LayoutCachedHeight =3120
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =16799
                    Top =3240
                    Width =2340
                    Height =315
                    TabIndex =10
                    BorderColor =7169897
                    Name ="txtTime1"
                    Format ="Medium Time"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="#12/30/1899#"
                    ShowDatePicker =0

                    LayoutCachedLeft =16799
                    LayoutCachedTop =3240
                    LayoutCachedWidth =19139
                    LayoutCachedHeight =3555
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =16799
                    Top =4140
                    Width =2340
                    Height =315
                    TabIndex =11
                    BorderColor =7169897
                    Name ="txtTime2"
                    Format ="Medium Time"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="#12/30/1899 12:0:0#"
                    ShowDatePicker =0

                    LayoutCachedLeft =16799
                    LayoutCachedTop =4140
                    LayoutCachedWidth =19139
                    LayoutCachedHeight =4455
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =223
                    TextAlign =2
                    TextFontFamily =34
                    Left =16799
                    Top =3690
                    Width =2340
                    Height =315
                    FontSize =11
                    BackColor =16252927
                    ForeColor =16252927
                    Name ="lblTimeAnd"
                    Caption ="And"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =16799
                    LayoutCachedTop =3690
                    LayoutCachedWidth =19139
                    LayoutCachedHeight =4005
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =223
                    TextAlign =2
                    TextFontFamily =34
                    Left =16800
                    Top =1890
                    Width =2340
                    Height =315
                    FontSize =11
                    BackColor =16252927
                    ForeColor =16252927
                    Name ="lblDateAnd"
                    Caption ="And"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =16800
                    LayoutCachedTop =1890
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =2205
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =255
                    TextFontFamily =34
                    Left =15420
                    Top =990
                    Width =3720
                    Height =314
                    TabIndex =5
                    Name ="cmdRemoveMultiSp"
                    Caption ="Remove Multi-Species Filter"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Include multiple species"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =15420
                    LayoutCachedTop =990
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1304
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10020
                    Top =8760
                    Width =2160
                    Height =555
                    TabIndex =17
                    Name ="cmdQuery"
                    Caption ="View Query Results"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Opens a query with the information for all the photos that match your filter set"
                        "tings"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =10020
                    LayoutCachedTop =8760
                    LayoutCachedWidth =12180
                    LayoutCachedHeight =9315
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7200
                    Top =8760
                    Width =2160
                    Height =555
                    TabIndex =16
                    Name ="cmdCopy"
                    Caption ="Copy Photos"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Copies all the photos that match your filter settings to a specified location"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =7200
                    LayoutCachedTop =8760
                    LayoutCachedWidth =9360
                    LayoutCachedHeight =9315
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    TabIndex =20
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =16560
                    Top =990
                    Width =2580
                    Height =315
                    TabIndex =12
                    BorderColor =7169897
                    Name ="cboLocationFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT CameraLocations.LocationID, First(StudyAreas.StudyAreaAbbr) & ' - ' & Fir"
                        "st(CameraLocations.LocationName) & ' (' & Count(qryPVComboRowSource.ImgID) & ')'"
                        " As LText FROM (qryPVComboRowSource INNER JOIN CameraLocations ON qryPVComboRowS"
                        "ource.LocationID = CameraLocations.LocationID) INNER JOIN StudyAreas ON CameraLo"
                        "cations.StudyAreaID = StudyAreas.StudyAreaID GROUP BY CameraLocations.LocationID"
                        " ORDER BY First(StudyAreas.StudyAreaAbbr), First(CameraLocations.LocationName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by camera location"

                    LayoutCachedLeft =16560
                    LayoutCachedTop =990
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1305
                    Begin
                        Begin Label
                            OverlapFlags =255
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =990
                            Width =975
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboLocationFilter_Label"
                            Caption ="Location:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =990
                            LayoutCachedWidth =16395
                            LayoutCachedHeight =1320
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =12840
                    Top =8760
                    Width =2160
                    Height =555
                    TabIndex =18
                    Name ="cmdDelete"
                    Caption ="Delete Photos"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Deletes all the photos or records that match your filter settings"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =12840
                    LayoutCachedTop =8760
                    LayoutCachedWidth =15000
                    LayoutCachedHeight =9315
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =14700
                    Top =120
                    Width =366
                    Height =366
                    TabIndex =19
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="=HelpMsg(\"PhotoViewer\")"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =14700
                    LayoutCachedTop =120
                    LayoutCachedWidth =15066
                    LayoutCachedHeight =486
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =16500
                    Top =990
                    Width =2640
                    Height =315
                    TabIndex =6
                    BorderColor =7169897
                    Name ="cboDetailFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DetailID, First(DetailText) & \" (\" & Count(ImgID) & \")\"  FROM qryPVCo"
                        "mboWithDetails  GROUP BY DetailID ORDER BY First(DetailText);"
                    ColumnWidths ="0;2160"
                    AfterUpdate ="=UpdateForm()"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by detail"

                    LayoutCachedLeft =16500
                    LayoutCachedTop =990
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1305
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =990
                            Width =885
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboDetailFilter_Label"
                            Caption ="Detail:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =990
                            LayoutCachedWidth =16305
                            LayoutCachedHeight =1320
                        End
                    End
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =15420
                    Top =120
                    Width =1080
                    Height =300
                    TabIndex =22
                    ForeColor =16252927
                    Name ="cmdLocationFilters"
                    Caption ="Location"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    BackStyle =0

                    LayoutCachedLeft =15420
                    LayoutCachedTop =120
                    LayoutCachedWidth =16500
                    LayoutCachedHeight =420
                    Overlaps =1
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =16800
                    Top =120
                    Width =1080
                    Height =300
                    TabIndex =23
                    ForeColor =16252927
                    Name ="cmdSpeciesFilters"
                    Caption ="Species"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =16800
                    LayoutCachedTop =120
                    LayoutCachedWidth =17880
                    LayoutCachedHeight =420
                    Overlaps =1
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =18060
                    Top =120
                    Width =1080
                    Height =300
                    TabIndex =24
                    ForeColor =16252927
                    Name ="cmdDateFilters"
                    Caption ="Date/Time"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =18060
                    LayoutCachedTop =120
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =420
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =16560
                    Top =1440
                    Width =2580
                    Height =315
                    TabIndex =25
                    BorderColor =7169897
                    Name ="cboVisitFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Visits.VisitID, First(Visits.VisitDate) & IIf(First(Visits.VisitTypeID)=1"
                        ",' (Check) (',' (Pull) (') & Count(qryPVComboRowSource.ImgID) & ')' As VText FRO"
                        "M qryPVComboRowSource INNER JOIN Visits ON qryPVComboRowSource.VisitID = Visits."
                        "VisitID GROUP BY Visits.VisitID ORDER BY First(Visits.VisitDate), First(Visits.V"
                        "isitTypeID);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=UpdateForm()"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Filter by visit"

                    LayoutCachedLeft =16560
                    LayoutCachedTop =1440
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1755
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =1440
                            Width =975
                            Height =330
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="cboVisitFilter_Label"
                            Caption ="Visit:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =1440
                            LayoutCachedWidth =16395
                            LayoutCachedHeight =1770
                        End
                    End
                End
                Begin ComboBox
                    Visible = NotDefault
                    OverlapFlags =223
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =16798
                    Top =2340
                    Width =2340
                    Height =315
                    TabIndex =1
                    BorderColor =7169897
                    Name ="cboDate2"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ImageDate FROM qryPVComboRowSource GROUP BY ImageDate ORDER BY ImageDate;"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =16798
                    LayoutCachedTop =2340
                    LayoutCachedWidth =19138
                    LayoutCachedHeight =2655
                End
                Begin ComboBox
                    Visible = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =16800
                    Top =1440
                    Width =2340
                    Height =315
                    TabIndex =26
                    BorderColor =7169897
                    Name ="cboDate1"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ImageDate FROM qryPVComboRowSource GROUP BY ImageDate ORDER BY ImageDate;"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =16800
                    LayoutCachedTop =1440
                    LayoutCachedWidth =19140
                    LayoutCachedHeight =1755
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =215
                    Left =18600
                    Top =1890
                    Width =240
                    TabIndex =27
                    Name ="chkNotNone"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    ControlTipText ="Check to display only photos containing multiple species"

                    LayoutCachedLeft =18600
                    LayoutCachedTop =1890
                    LayoutCachedWidth =18840
                    LayoutCachedHeight =2130
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =1890
                            Width =3045
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkNotNone_Label"
                            Caption ="All species except 'None':"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =1890
                            LayoutCachedWidth =18465
                            LayoutCachedHeight =2204
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =18599
                    Top =2340
                    Width =240
                    TabIndex =28
                    Name ="chkMultipleSp"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display only photos that have been ID'd as something other than 'none'"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =2340
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =2580
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =2340
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkMultipleSp_Label"
                            Caption =">1 Species in Photo:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =2340
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =2654
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =18599
                    Top =2790
                    Width =240
                    TabIndex =29
                    Name ="chkVerified"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display photos with ID's flagged as verified"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =2790
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =3030
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =2790
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkVerified_Label"
                            Caption ="Photos with verified ID's:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =2790
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =3104
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =18599
                    Top =3240
                    Width =240
                    TabIndex =30
                    Name ="chkPending"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display photos with ID's marked as pending"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =3240
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =3480
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =3240
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkPending_Label"
                            Caption ="Photos with pending ID's:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =3240
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =3554
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =215
                    Left =18599
                    Top =3690
                    Width =240
                    TabIndex =31
                    Name ="chkMultiObs"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display photos that have been ID'd by more than one person"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =3690
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =3930
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =3690
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkMultiObs_Label"
                            Caption ="Photos with multiple observers:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =3690
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =4004
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =18599
                    Top =4124
                    Width =240
                    TabIndex =32
                    Name ="chkOneObs"
                    AfterUpdate ="=UpdateForm()"
                    DefaultValue ="0"
                    ControlTipText ="Check to display photos that have been ID'd by only one person"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =4124
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =4364
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =4124
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkOneObs_Label"
                            Caption ="Photos with one observer:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =4124
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =4438
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =215
                    Left =18599
                    Top =4558
                    Width =240
                    TabIndex =33
                    Name ="chkNoObs"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    ControlTipText ="Check to display only photos that have not been ID'd"

                    LayoutCachedLeft =18599
                    LayoutCachedTop =4558
                    LayoutCachedWidth =18839
                    LayoutCachedHeight =4798
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =15420
                            Top =4558
                            Width =3060
                            Height =314
                            FontSize =11
                            BackColor =16252927
                            BorderColor =16252927
                            ForeColor =16252927
                            Name ="chkNoObs_Label"
                            Caption ="Photos that haven't been ID'd:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =15420
                            LayoutCachedTop =4558
                            LayoutCachedWidth =18480
                            LayoutCachedHeight =4872
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    FontUnderline = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =16560
                    Top =5220
                    Height =300
                    TabIndex =34
                    ForeColor =15709952
                    Name ="cmdClearFilters"
                    Caption ="Clear Filters"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =16560
                    LayoutCachedTop =5220
                    LayoutCachedWidth =18000
                    LayoutCachedHeight =5520
                    Overlaps =1
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    TextFontFamily =34
                    Left =6180
                    Top =180
                    Width =6840
                    Height =420
                    FontSize =14
                    ForeColor =15709952
                    Name ="lblUpdating"
                    Caption ="Updating filters..."
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =6180
                    LayoutCachedTop =180
                    LayoutCachedWidth =13020
                    LayoutCachedHeight =600
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =95
                    TextFontCharSet =204
                    TextAlign =2
                    TextFontFamily =34
                    Width =0
                    Height =0
                    FontSize =16
                    FontWeight =700
                    BorderColor =7169897
                    ForeColor =-2147483608
                    Name ="lblNotFound"
                    Caption ="Image Not Found"
                    FontName ="Franklin Gothic Book"
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The PhotoViewer form encountered an error."
Private Const strFilterError As String = "Filter failed."
Private bLoadData As Boolean

'------------------------------
'Events for form and controls
'------------------------------

Private Sub cboAreaFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboAreaFilter")

End Sub

Private Sub cboDate1_AfterUpdate()
'Check for required info, update

If Not (IsNull(Me.cboDateFilter) Or IsNull(Me.cboDate1)) Then
    If Not (IsNull(Me.cboDate2) And Me.cboDateFilter = "Between") Then
        UpdateForm
    End If
End If

End Sub

Private Sub cboDate2_AfterUpdate()
'Check for required info, update

If Not (IsNull(Me.cboDateFilter) Or IsNull(Me.cboDate1)) Then
    If Not (IsNull(Me.cboDate2) And Me.cboDateFilter = "Between") Then
        UpdateForm
    End If
End If

End Sub

Private Sub cboDateFilter_AfterUpdate()
'Show/hide relevant controls and update filter

On Error GoTo ErrHandler

'Hide date entry boxes
If IsNull(Me.cboDateFilter) Then
    Me.cboDate1.Visible = False
    Me.cboDate2.Visible = False
Else
    'Show 1st date entry box
    Me.cboDate1.Visible = True
    If Me.cboDateFilter = "Between" Then
        'Show 2nd box only for "Between"
        Me.cboDate2.Visible = True
    Else
        Me.cboDate2.Visible = False
    End If
End If

'Show "and" if second box is visible
Me.lblDateAnd.Visible = Me.cboDate2.Visible

'Check for required info, update
If Not (IsNull(Me.cboDateFilter) Or IsNull(Me.cboDate1)) Then
    If Not (IsNull(Me.cboDate2) And Me.cboDateFilter = "Between") Then
        UpdateForm
    End If
End If

Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cboDateFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboDateFilter")

End Sub

Private Sub cboDetailFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboDetailFilter")

End Sub

Private Sub cboLocationFilter_AfterUpdate()
'Enable/disable visit dropdown and update

On Error GoTo ErrHandler

If IsNull(Me.cboLocationFilter) Then
    'Visit filter disabled
    Me.cboAreaFilter.SetFocus
    Me.cboVisitFilter = Null
    Me.cboVisitFilter.Enabled = False
Else
    'Visit filter enabled
    Me.cboVisitFilter.Enabled = True
    Me.cboVisitFilter.SetFocus
End If

'Update filter and combos
UpdateForm

Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cboLocationFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboLocationFilter")

End Sub

Private Sub cboSeasonFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboSeasonFilter")

End Sub

Private Sub cboSpeciesFilter_AfterUpdate()
'Show/hide relevant fields

On Error GoTo ErrHandler

'Clear detail
Me.cboDetailFilter = Null

If IsNull(Me.cboSpeciesFilter) Then
    'No species selected, detail unavail., multiple avail.
    Me.cmdMultiSpecies.Visible = True
    Me.cmdMultiSpecies.SetFocus
    Me.cboDetailFilter.Visible = False
    Me.cmdRemoveMultiSp.Visible = False
Else
    'Species selected, detail avail., multiple unavail.
    Me.cboDetailFilter.Visible = True
    Me.cboDetailFilter.SetFocus
    Me.cmdMultiSpecies.Visible = False
    Me.cmdRemoveMultiSp.Visible = False
End If

'Update filter for form and dropdowns
UpdateForm

Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cboSpeciesFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboSpeciesFilter")

End Sub

Private Sub cboTimeFilter_AfterUpdate()
'Show/hide relevant fields and update filter

On Error GoTo ErrHandler

If IsNull(Me.cboTimeFilter) Then
    'Hide time entry boxes
    Me.txtTime1.Visible = False
    Me.txtTime2.Visible = False
    Me.lblTimeAnd.Visible = False
Else
    'Show 1st time entry box
    Me.txtTime1.Visible = True
    If Me.cboTimeFilter = "Between" Then
        'Show "AND" & 2nd box only for "between"
        Me.txtTime2.Visible = True
        Me.lblTimeAnd.Visible = True
    Else
        Me.txtTime2.Visible = False
        Me.lblTimeAnd.Visible = False
    End If
End If

'Update filter for form and dropdowns
UpdateForm
Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cboTimeFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboTimeFilter")

End Sub

Private Sub cboVisitFilter_NotInList(NewData As String, Response As Integer)
'Ignore bad entry

Response = IgnoreNotInList("cboVisitFilter")

End Sub

Private Sub chkAdvance_AfterUpdate()
'Set timer interval when box is checked to trigger ontimer event

On Error GoTo ErrHandler

If Me.chkAdvance = True Then
    If IsNull(Me.txtSeconds) Then
        Me.txtSeconds = 2
    End If
    If IsNumeric(Me.txtSeconds) Then
        Me.TimerInterval = 1000 * Me.txtSeconds
    End If
Else
    Me.TimerInterval = 0
    Me.txtFocus.SetFocus
End If
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub chkNoObs_AfterUpdate()
'Show/hide relevant fields

Me.cboSpeciesFilter.Enabled = Not Me.chkNoObs
Me.cmdMultiSpecies.Enabled = Not Me.chkNoObs

'Update filter for form and dropdowns
UpdateForm

End Sub

Private Sub chkNotNone_AfterUpdate()
'Show/hide relevant fields

Me.cboSpeciesFilter.Enabled = Not Me.chkNotNone
Me.cmdMultiSpecies.Enabled = Not Me.chkNotNone

'Update filter for form and dropdowns
UpdateForm

End Sub

Private Sub cmdClearFilters_Click()
'Clear filter controls and update form

Me.txtFocus.SetFocus

'Clear location controls
Me.cboAreaFilter = Null
Me.cboLocationFilter = Null
Me.cboVisitFilter = Null
Me.cboVisitFilter.Enabled = False

'Clear species controls
Me.cboSpeciesFilter = Null
Me.cboSpeciesFilter.Tag = ""
Me.cboDetailFilter = Null
Me.cboDetailFilter.Visible = False
Me.cmdRemoveMultiSp.Visible = False
Me.cmdMultiSpecies.Visible = _
    Me.cboSpeciesFilter.Visible
Me.chkHighlight = False
Me.chkNotNone = False
Me.chkMultipleSp = False
Me.chkVerified = False
Me.chkPending = False
Me.chkMultiObs = False
Me.chkOneObs = False
Me.chkNoObs = False

'Clear date/time controls
Me.cboSeasonFilter = Null
Me.cboDateFilter = Null
Me.cboDate1 = Null
Me.cboDate2 = Null
Me.cboTimeFilter = Null
Me.txtTime1 = #12:00:00 AM#
Me.txtTime1 = #12:00:00 PM#

'Update filter for form and dropdowns
UpdateForm

End Sub

Private Sub cmdCopy_Click()
'Open form to copy photos

On Error GoTo ErrHandler

'Save the current filter to photoviewerquery
UpdateQuery GetFilter("Form")

'Open the form to copy photos
DoCmd.OpenForm "CopyPhotos", , , , , acDialog

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdDateFilters_Click()
'Show date filter fields

ShowHideGroup "Date", True

End Sub

Private Sub cmdDelete_Click()
'Open form to delete photos/records

On Error GoTo ErrHandler

'Save the current filter to photoviewerquery
UpdateQuery GetFilter("Form")

'Open the form to delete photos
DoCmd.OpenForm "DeletePhotos", , , , , acDialog

'Refresh PhotoViewer form
Me.Refresh
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdEditID_Click()
'Open PhotoID form to current photo

On Error GoTo ErrHandler

DoCmd.OpenForm "PhotoID", acDesign, , , , acHidden
Forms("PhotoID").RecordSource = "PhotoIDRecSource"
DoCmd.Close acForm, "PhotoID", acSaveYes

DoCmd.OpenForm "PhotoID", , , "ImageID = " & Me.CamFilmStrip.Form.ImgID, , _
    acDialog

'Refresh photoviewer to update Species, Comments
Call Me.CamFilmStrip.Form.Form_Current
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "PhotoViewer Form Help"

End Sub

Private Sub cmdLocationFilters_Click()
'Show location filter fields

ShowHideGroup "Location", True

End Sub

Private Sub cmdMultiSpecies_Click()
'Open form for selecting species and apply filter

On Error GoTo ErrHandler

'Create temporary table
SpSelectTable

'Go to selection form
DoCmd.OpenForm "SpeciesTemp", , , , , acDialog, "PhotoViewer"

'Check tag property to see if filter was applied
If Len(Me.cboSpeciesFilter.Tag) > 0 Then
    'Filtered to multiple species, show/hide controls
    Me.cmdRemoveMultiSp.Visible = True
    Me.cmdRemoveMultiSp.SetFocus
    Me.cboSpeciesFilter = Null
    Me.cboSpeciesFilter.Enabled = False
    Me.cmdMultiSpecies.Visible = False
End If

'Update filter for form and dropdowns
UpdateForm

Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cmdQuery_Click()
'Save current filters to query and open results

On Error GoTo ErrHandler

DoCmd.Minimize

'Save the current filter to photoviewerquery
UpdateQuery GetFilter("Form")

'Open the result set
DoCmd.OpenForm "PhotoViewerQueryResults"

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdRemoveMultiSp_Click()
'Clear multi-species filter

On Error GoTo ErrHandler

'Clear tag property
Me.cboSpeciesFilter.Tag = ""

'Show/hide appropriate controls
Me.cboSpeciesFilter.Enabled = True
Me.cboSpeciesFilter = Null
Me.cboSpeciesFilter.SetFocus
Me.cmdMultiSpecies.Visible = True
Me.cmdRemoveMultiSp.Visible = False

'Update filter for form and dropdowns
UpdateForm

Exit Sub

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description

End Sub

Private Sub cmdSpeciesFilters_Click()
'Show species/ID status filter fields

ShowHideGroup "Species", True

End Sub

Private Sub CurrImage_DblClick(Cancel As Integer)
'Open jpg in windows

On Error GoTo ErrHandler

'Open photo or browse dialog
If Not IsNull(Me.CamFilmStrip.Form.ImgID) Then
    If OpenPhotoWithDialog(Me.CamFilmStrip.Form.ImgPath, _
        Me.CamFilmStrip.Form.ImgID) Then
        Me.CurrImage.Requery
        With Me.lblNotFound
            .Visible = False
            .Width = 0
            .Height = 0
            .Left = 0
            .Top = 0
        End With
    End If
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Open(Cancel As Integer)
'Hide switchboard and show loading message

On Error GoTo ErrHandler

bLoadData = True
HideSwitchboard acForm, Me.Name
Me.lblUpdating.Caption = "Loading photo data..."
Me.lblUpdating.Visible = True
DoCmd.Hourglass True
DoEvents

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Timer()
'Load form data if newly opened
'Otherwise advance subform to next record

On Error GoTo ErrHandler

If bLoadData Then
    'Hide progress
    Me.TimerInterval = 0
    Application.Echo False
    bLoadData = False
    'Load data
    UpdateFilter ""
    UpdateCheckboxes
    DoEvents
    'Hide message
    Me.lblUpdating.Visible = False
    Me.lblUpdating.Caption = "Updating filters..."
Else
    'Check for subsequent record
    If Me.CamFilmStrip.Form.CurrentRecord < _
        Me.CamFilmStrip.Form.RecordsetClone.RecordCount Then
        'Advance to next photo
        Me.CamFilmStrip.SetFocus
        DoCmd.GoToRecord
        Me.txtSeconds.SetFocus
    Else
        ' Display message if current record is the last one
        Me.TimerInterval = 0
        MsgBox "No more images.", , "The End"
    End If
End If

FTExit:
        DoCmd.Hourglass False
        Application.Echo True
        Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description
    Resume FTExit

End Sub

Private Sub Form_Unload(Cancel As Integer)
'Bring back switchboard

RestoreSwitchboard

End Sub

Private Sub txtSeconds_AfterUpdate()
'Update timer interval

On Error GoTo ErrHandler

If IsNumeric(Me.txtSeconds) And Me.chkAdvance.Value = True Then
    Me.TimerInterval = 1000 * Me.txtSeconds
Else
    Me.TimerInterval = 0
End If
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub ClearImageData()
'Clears image data in case filter returns 0 records

Me.lblFileName.Caption = ""
Me.lblDate.Caption = ""
Me.lblTime.Caption = ""
Me.lblEasting.Caption = ""
Me.lblNorthing.Caption = ""
Me.lblSpecies.Caption = ""
Me.lblComments.Caption = ""

End Sub

Private Sub EnableCheckbox(strCtl As String, _
    Optional bDisable As Boolean)
'Enable/disable control and set label color

If Not Me.Controls(strCtl).Value Then
    Me.Controls(strCtl).Locked = bDisable
    If bDisable Then
        Me.Controls(strCtl & "_Label").ForeColor = 7169897
    Else
        Me.Controls(strCtl & "_Label").ForeColor = 16252927
    End If
End If

End Sub

Private Function GetFilter(strType As String) As String
'Creates filter string from control values
'strType determines whether filter applies to subform ("Form")
'or combo boxes (anything else, ex. "Combo")

Dim strFilter As String

'Add location criteria
If Not IsNull(Me.cboVisitFilter) Then
    strFilter = "((VisitID) = " & _
        Me.cboVisitFilter & ") AND "
End If
If Not IsNull(Me.cboLocationFilter) Then
    strFilter = strFilter & "((LocationID) = " & _
        Me.cboLocationFilter & ") AND "
End If
If Not IsNull(Me.cboAreaFilter) Then
    strFilter = strFilter & "((StudyAreaID) = " & _
        Me.cboAreaFilter & ") AND "
End If

'Add species criteria
If strType = "Form" Then
    'Use subquery syntax to return 1 row per photo
    If Len(Me.cboSpeciesFilter.Tag) > 0 Then
        'Multiple species
        strFilter = strFilter & "((ImgID) In (SELECT ImageID FROM Detections " & _
            "WHERE SpeciesID In (" & Me.cboSpeciesFilter.Tag & _
            ") AND StatusID<3)) AND "
    Else
        'Single species/detail
        If Not IsNull(Me.cboDetailFilter) Then
            strFilter = strFilter & "((ImgID) In (SELECT ImageID FROM Detections " & _
                "WHERE DetailID=" & Me.cboDetailFilter & " AND StatusID<3)) AND "
        Else
            If Not IsNull(Me.cboSpeciesFilter) Then
                strFilter = strFilter & "((ImgID) In (SELECT ImageID FROM Detections " & _
                    "WHERE SpeciesID=" & Me.cboSpeciesFilter & " AND StatusID<3)) AND "
            End If
        End If
    End If
    If Me.chkNotNone Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE " & _
            "NotNone=True)) AND "
    End If
    If Me.chkNoObs Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE ObsCount=0)) AND "
    End If
    If Me.chkOneObs Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE ObsCount=1)) AND "
    End If
    If Me.chkMultiObs Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE ObsCount>1)) AND "
    End If
    If Me.chkVerified Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE Verified=True)) AND "
    End If
    If Me.chkPending Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE Pending=True)) AND "
    End If
    If Me.chkMultipleSp Then
        strFilter = strFilter & "((ImgID) In (" & _
            "SELECT ImageID FROM Photos WHERE MultiSp=True)) AND "
    End If
Else
    'Use normal criteria syntax for combos
    If Len(Me.cboSpeciesFilter.Tag) > 0 Then
        'Multiple species
        strFilter = strFilter & "((SpeciesID) In (" & _
            Me.cboSpeciesFilter.Tag & ")) AND "
    Else
        'Single species/detail
        If Not IsNull(Me.cboSpeciesFilter) Then
            strFilter = strFilter & "((SpeciesID) = " & Me.cboSpeciesFilter & ") AND "
        End If
        If Not IsNull(Me.cboDetailFilter) Then
            strFilter = strFilter & "((DetailID) = " & Me.cboSpeciesFilter & ") AND "
        End If
    End If
    If Me.chkNotNone Then
        strFilter = strFilter & "((NotNone) = True) AND "
    End If
    If Me.chkNoObs Then
        strFilter = strFilter & "((ObsCount) = 0) AND "
    End If
    If Me.chkOneObs Then
        strFilter = strFilter & "((ObsCount) = 1) AND "
    End If
    If Me.chkMultiObs Then
        strFilter = strFilter & "((ObsCount) > 1) AND "
    End If
    If Me.chkVerified Then
        strFilter = strFilter & "((Verified) = True) AND "
    End If
    If Me.chkPending Then
        strFilter = strFilter & "((Pending) = True) AND "
    End If
    If Me.chkMultipleSp Then
        strFilter = strFilter & "((MultiSp) = True) AND "
    End If
End If

'Add checkbox criteria
If Me.chkHighlight Then
    strFilter = strFilter & "((Highlight) = Yes) AND "
End If

'Add date criteria
If Not IsNull(Me.cboSeasonFilter) Then
    strFilter = strFilter & "((FieldSeason) = " & _
        Me.cboSeasonFilter & ") AND "
End If
If Not (IsNull(Me.cboDateFilter) Or IsNull(Me.cboDate1)) Then
    Select Case Me.cboDateFilter
        Case "Before"
            strFilter = strFilter & "((ImageDate) < #" & USDate(Me.cboDate1) & "#) AND "
        Case "After"
            strFilter = strFilter & "((ImageDate) > #" & USDate(Me.cboDate1) & "#) AND "
        Case "Between"
            If IsNull(Me.cboDate2) Then
                strFilter = strFilter & "((ImageDate) >= #" & USDate(Me.cboDate1) & "#) AND "
            Else
                strFilter = strFilter & "((ImageDate) Between #" & USDate(Me.cboDate1) & _
                    "# And #" & USDate(Me.cboDate2) & "#) AND "
            End If
    End Select
End If

'Add time criteria
If Not (IsNull(Me.cboTimeFilter) Or IsNull(Me.txtTime1)) Then
    Select Case Me.cboTimeFilter
        Case "Before"
            strFilter = strFilter & "((TimeValue(ImageDate)) < #" & _
                USDate(TimeValue(Me.txtTime1)) & "#)  AND "
        Case "After"
            strFilter = strFilter & "((TimeValue(ImageDate)) > #" & _
                USDate(TimeValue(Me.txtTime1)) & "#)  AND "
        Case "Between"
            If IsNull(Me.txtTime2) Then
                strFilter = strFilter & "((TimeValue(ImageDate)) >= #" & _
                    USDate(TimeValue(Me.txtTime1)) & "#)  AND "
            Else
                If Me.txtTime2 > Me.txtTime1 Then
                    strFilter = strFilter & "((TimeValue(ImageDate)) >= #" & _
                        USDate(TimeValue(Me.txtTime1)) & "#)  AND " & _
                        "((TimeValue(ImageDate)) <= #" & _
                        USDate(TimeValue(Me.txtTime2)) & "#)  AND "
                Else
                    strFilter = strFilter & "(((TimeValue(ImageDate)) >= #" & _
                        USDate(TimeValue(Me.txtTime1)) & "#)  OR " & _
                        "((TimeValue(ImageDate)) <= #" & _
                        USDate(TimeValue(Me.txtTime2)) & "#))  AND "
                End If
            End If
    End Select
End If

'Remove trailing " AND "
If Len(strFilter) > 0 Then
    strFilter = Left(strFilter, Len(strFilter) - 5)
End If

GetFilter = strFilter

End Function

Private Function GetRowSource(strSelect As String, strFrom As String, _
    Optional strFilter As String = "", Optional strGroup As String = "", _
    Optional strOrder As String = "") As String
'Combines separate clauses into row source SQL statement

Dim strResult As String

strResult = "SELECT " & strSelect & " FROM " & strFrom
If Len(strFilter) > 0 Then
    strResult = strResult & " WHERE (" & strFilter & ")"
End If
If Len(strGroup) > 0 Then
    strResult = strResult & " GROUP BY " & strGroup
End If
If Len(strOrder) > 0 Then
    strResult = strResult & " ORDER BY " & strOrder
End If

strResult = strResult & ";"
GetRowSource = strResult

End Function

Private Function IgnoreNotInList(strCtl As String) As Integer
'Sets the combo box back to null and suppresses messages

On Error Resume Next

Me.Controls(strCtl).Value = Null

IgnoreNotInList = acDataErrContinue

End Function

Private Function RemoveFilterClause(strFilter As String, _
    strField As String) As String
'Removes criteria for a given field from filter string

Dim strResult As String
Dim strReplace As String
Dim i As Integer

'Find criteria for strField
i = InStr(1, strFilter, "((" & strField)
If i > 0 Then
    'Isolate clause
    strReplace = Mid(strFilter, i)
    i = InStr(1, strReplace, ") AND ((")
    If i > 0 Then
        strReplace = Left(strReplace, i + 5)
    End If
    strResult = Replace(strFilter, strReplace, "")
    If InStr(1, strResult, "((" & strField) > 0 Then
        'Repeat in case multiple criteria reference strField
        strResult = RemoveFilterClause(strResult, strField)
    End If
    'Find last parenthesis and cut string there
    i = InStrRev(strResult, ")")
    If i > 0 Then
        strResult = Left(strResult, i)
    End If
Else
    strResult = strFilter
End If

RemoveFilterClause = strResult

End Function

Private Sub ShowHideGroup(strGroup As String, bShow As Boolean)
'Show a particular filter group and hide the others

On Error GoTo ErrHandler

Me.txtFocus.SetFocus

Select Case strGroup
    Case "Location"
        If bShow Then
            'Hide other groups
            ShowHideGroup "Species", False
            ShowHideGroup "Date", False
        End If
        'Show filter controls
        Me.cboAreaFilter.Visible = bShow
        Me.cboLocationFilter.Visible = bShow
        Me.cboVisitFilter.Visible = bShow
        'Move cursor
        If bShow Then
            Me.cboAreaFilter.SetFocus
        End If

    Case "Species"
        If bShow Then
            'Hide other groups
            ShowHideGroup "Location", False
            ShowHideGroup "Date", False
        End If
        'Show filter controls
        Me.cboSpeciesFilter.Visible = bShow
        Me.cboDetailFilter.Visible = bShow And _
            Not IsNull(Me.cboSpeciesFilter)
        Me.cmdMultiSpecies.Visible = bShow And _
            IsNull(Me.cboSpeciesFilter) And _
            Not Len(Me.cboSpeciesFilter.Tag) > 0
        Me.cmdRemoveMultiSp.Visible = bShow And _
            IsNull(Me.cboSpeciesFilter) And _
            Len(Me.cboSpeciesFilter.Tag) > 0
        Me.chkHighlight.Visible = bShow
        Me.chkNotNone.Visible = bShow
        Me.chkMultipleSp.Visible = bShow
        Me.chkVerified.Visible = bShow
        Me.chkPending.Visible = bShow
        Me.chkMultiObs.Visible = bShow
        Me.chkOneObs.Visible = bShow
        Me.chkNoObs.Visible = bShow
        'Move cursor
        If bShow Then
            SafeSetFocus Me.cboSpeciesFilter, Me.cmdRemoveMultiSp
        End If

    Case "Date"
        If bShow Then
            'Hide other groups
            ShowHideGroup "Location", False
            ShowHideGroup "Species", False
        End If
        'Show filter controls
        Me.cboSeasonFilter.Visible = bShow
        Me.cboDateFilter.Visible = bShow
        Me.cboTimeFilter.Visible = bShow
        Me.cboDate1.Visible = bShow And _
            Not IsNull(Me.cboDateFilter)
        Me.cboDate2.Visible = bShow And _
            Nz(Me.cboDateFilter, "") = "Between"
        Me.lblDateAnd.Visible = bShow And _
            Nz(Me.cboDateFilter, "") = "Between"
        Me.txtTime1.Visible = bShow And _
            Not IsNull(Me.cboTimeFilter)
        Me.txtTime2.Visible = bShow And _
            Nz(Me.cboTimeFilter, "") = "Between"
        Me.lblTimeAnd.Visible = bShow And _
            Nz(Me.cboTimeFilter, "") = "Between"
        'Move cursor
        If bShow Then
            Me.cboSeasonFilter.SetFocus
        End If

End Select

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub UpdateCheckboxes()
'Enables or disables checkboxes based on other filters

Dim db As DAO.Database
Dim rs As DAO.Recordset
Dim strFrom As String
Dim strFilter As String

'Set source query
If Not IsNull(Me.cboDetailFilter) Then
    strFrom = "qryPVComboWithDetails"
Else
    If Not (IsNull(Me.cboSpeciesFilter) And _
        Len(Me.cboSpeciesFilter.Tag) = 0 And _
        Me.chkNotNone.Value = False) Then
        strFrom = "qryPVComboWithSpecies"
    Else
        strFrom = "qryPVComboRowSource"
    End If
End If

'Get filter
strFilter = GetFilter("Combo")
If Len(strFilter) > 0 Then
    strFilter = " WHERE (" & strFilter & ")"
End If

'Get records
Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT * FROM " & strFrom & _
    strFilter)

'Search records for checkbox criteria
If Not (rs.BOF And rs.EOF) Then
    'Highlights
    rs.FindFirst "Highlight=True"
    EnableCheckbox "chkHighlight", rs.NoMatch
    'Species other than none
    If IsNull(Me.cboSpeciesFilter) And _
        Len(Me.cboSpeciesFilter.Tag) = 0 Then
            rs.FindFirst "NotNone=True"
            EnableCheckbox "chkNotNone", rs.NoMatch
    Else
        EnableCheckbox "chkNotNone", True
    End If
    'Multiple species in same photo
    rs.FindFirst "MultiSp=True"
    EnableCheckbox "chkMultipleSp", rs.NoMatch
    'Verified ID's
    rs.FindFirst "Verified=True"
    EnableCheckbox "chkVerified", rs.NoMatch
    'Pending ID's
    rs.FindFirst "Pending=True"
    EnableCheckbox "chkPending", rs.NoMatch
    'Multiple observers
    rs.FindFirst "ObsCount>1"
    EnableCheckbox "chkMultiObs", rs.NoMatch
    'One observer
    rs.FindFirst "ObsCount=1"
    EnableCheckbox "chkOneObs", rs.NoMatch
    'No observers yet
    rs.FindFirst "ObsCount=0"
    EnableCheckbox "chkNoObs", rs.NoMatch
End If

rs.Close
Set rs = Nothing
Set db = Nothing

End Sub

Public Sub UpdateFilter(strFilter As String)
'Applies filter to subform

Me.CamFilmStrip.Form.Filter = strFilter
Me.CamFilmStrip.Form.FilterOn = Len(strFilter) > 0

End Sub

Private Function UpdateForm() As Integer
'Updates form elements when filter options are changed

On Error GoTo ErrHandler

'Indicate code is running
DoCmd.Hourglass True
Me.lblUpdating.Visible = True
Application.Echo False

'Update filter and controls
ClearImageData
UpdateRowSource GetFilter("Combo")
UpdateCheckboxes
UpdateLinks
UpdateFilter GetFilter("Form")
UpdateForm = 1

UpdateFormExit:
    Me.lblUpdating.Visible = False
    DoCmd.Hourglass False
    Application.Echo True
    DoCmd.SelectObject acForm, "PhotoViewer", False
    DoCmd.Restore
    Exit Function

ErrHandler:
    ErrorMsg strFilterError, Err.Number, Err.Description
    Resume UpdateFormExit

End Function

Private Sub UpdateLinks()
'Changes active filter links to blue, inactive to white

Dim bFilter As Boolean

'Location group
If Not (IsNull(Me.cboAreaFilter) And _
    IsNull(Me.cboLocationFilter)) Then
    Me.cmdLocationFilters.ForeColor = 15709952
    bFilter = True
Else
    Me.cmdLocationFilters.ForeColor = 16252927
End If

'Species group
If Len(Me.cboSpeciesFilter.Tag) > 0 Or _
    (Not IsNull(Me.cboSpeciesFilter)) Or _
    Me.chkHighlight.Value Or _
    Me.chkMultipleSp.Value Or _
    Me.chkNotNone.Value Or _
    Me.chkVerified.Value Or _
    Me.chkPending.Value Or _
    Me.chkMultiObs.Value Or _
    Me.chkOneObs.Value Or _
    Me.chkNoObs.Value Then
    Me.cmdSpeciesFilters.ForeColor = 15709952
    bFilter = True
Else
    Me.cmdSpeciesFilters.ForeColor = 16252927
End If

'Date group
If Not ((IsNull(Me.cboDateFilter) Or _
    IsNull(Me.cboDate1)) And _
    (IsNull(Me.cboTimeFilter) Or _
    IsNull(Me.txtTime1)) And _
    IsNull(Me.cboSeasonFilter)) Then
    Me.cmdDateFilters.ForeColor = 15709952
    bFilter = True
Else
    Me.cmdDateFilters.ForeColor = 16252927
End If

'Show "remove" link if filter is active
Me.cmdClearFilters.Visible = bFilter

End Sub

Private Sub UpdateQuery(strFilter As String)
'Save PhotoViewerQuery with current filters

Dim strSQL As String
Dim strWhere As String

'Get SQL from form's record source
strSQL = CurrentDb.QueryDefs("FilmStripRecSource").SQL

'Build WHERE clause from form's filter
strWhere = strFilter
If Len(strWhere) > 0 Then
    strWhere = Replace(strWhere, "((ImgID)", _
        "((Photos.ImageID)")
    strWhere = Replace(strWhere, "LocationID", _
        "CameraLocations.LocationID")
    strWhere = Replace(strWhere, "VisitID", _
        "Visits.VisitID")
    strWhere = Replace(strWhere, "FieldSeason", _
        "Year(SetVisits.VisitDate)")
    strWhere = "WHERE (" & strWhere & ") "
End If

'Insert WHERE clause into SQL statement
strSQL = Replace(strSQL, "ORDER BY", strWhere & "ORDER BY")

'Overwrite query
SaveQuery "PhotoViewerQuery", strSQL

End Sub

Private Sub UpdateRowSource(strFilter As String)
'Updates combo boxes based on current filter

Dim strRS As String
Dim strFrom As String

'Set source query
If Not IsNull(Me.cboDetailFilter) Then
    strFrom = "qryPVComboWithDetails"
Else
    If Not (IsNull(Me.cboSpeciesFilter) And _
        Len(Me.cboSpeciesFilter.Tag) = 0 And _
        Me.chkNotNone.Value = False) Then
        strFrom = "qryPVComboWithSpecies"
    Else
        strFrom = "qryPVComboRowSource"
    End If
End If

'Update study area combo row source
strRS = GetRowSource("StudyAreas.StudyAreaID, " & _
    "First(StudyAreas.StudyAreaName) & ' (' & " & _
    "Count(" & strFrom & ".ImgID) & ')' As AText", _
    strFrom & " INNER JOIN StudyAreas ON " & _
    strFrom & ".StudyAreaID = StudyAreas.StudyAreaID", _
    RemoveFilterClause(strFilter, "StudyAreaID"), _
    "StudyAreas.StudyAreaID", "First(StudyAreas.StudyAreaName)")
'Apply new row source
Me.cboAreaFilter.RowSource = strRS
If Not IsNull(Me.cboAreaFilter) Then
    Me.cboAreaFilter.Requery
End If

'Update location combo row source
strRS = GetRowSource("CameraLocations.LocationID, " & _
    "First(StudyAreas.StudyAreaAbbr) & ' - ' & " & _
    "First(CameraLocations.LocationName) & " & _
    "' (' & Count(" & strFrom & ".ImgID) & ')' As LText", _
    "(" & strFrom & " INNER JOIN CameraLocations ON " & _
    strFrom & ".LocationID = CameraLocations.LocationID) " & _
    "INNER JOIN StudyAreas ON CameraLocations.StudyAreaID = " & _
    "StudyAreas.StudyAreaID", Replace(RemoveFilterClause(strFilter, _
    "LocationID"), "StudyAreaID", strFrom & ".StudyAreaID"), _
    "CameraLocations.LocationID", "First(StudyAreas.StudyAreaAbbr), " & _
    "First(CameraLocations.LocationName)")
'Apply new row source
Me.cboLocationFilter.RowSource = strRS
If Not IsNull(Me.cboLocationFilter) Then
    Me.cboLocationFilter.Requery
End If

'Update visit combo row source
strRS = GetRowSource("Visits.VisitID, " & _
    "First(Visits.VisitDate) & " & _
    "IIf(First(Visits.VisitTypeID)=1,' (Check) (',' (Pull) (') & " & _
    "Count(" & strFrom & ".ImgID) & ')' As VText", _
    strFrom & " INNER JOIN Visits ON " & _
    strFrom & ".VisitID = Visits.VisitID", _
    Replace(RemoveFilterClause(strFilter, "VisitID"), _
    "LocationID", strFrom & ".LocationID"), _
    "Visits.VisitID", "First(Visits.VisitDate), First(Visits.VisitTypeID)")
'Apply new row source
Me.cboVisitFilter.RowSource = strRS
If Not IsNull(Me.cboVisitFilter) Then
    Me.cboVisitFilter.Requery
End If

'Update season combo row source
strRS = GetRowSource("FieldSeason, FieldSeason & ' (' & " & _
    "Count(ImgID) & ')' As SText", _
    strFrom, RemoveFilterClause(strFilter, "FieldSeason"), _
    "FieldSeason", "FieldSeason")
'Apply new row source
Me.cboSeasonFilter.RowSource = strRS
If Not IsNull(Me.cboSeasonFilter) Then
    Me.cboSeasonFilter.Requery
End If

'Update row source for date combos
strRS = GetRowSource("ImageDate", strFrom, _
    RemoveFilterClause(strFilter, "ImageDate"), _
    "ImageDate", "ImageDate")
'Apply new row source
Me.cboDate1.RowSource = strRS
Me.cboDate2.RowSource = strRS

'Update species combo row source
strFrom = "qryPVComboWithSpecies"
strRS = GetRowSource("Species.SpeciesID, " & _
    "First(Species.ShortName) & ' (' & " & _
    "Count(" & strFrom & ".ImgID) & ')' As SText", _
    strFrom & " INNER JOIN Species ON " & _
    strFrom & ".SpeciesID = Species.SpeciesID", _
    RemoveFilterClause(strFilter, "SpeciesID"), _
    "Species.SpeciesID", "First(Species.ShortName)")
'Apply new row source
Me.cboSpeciesFilter.RowSource = strRS
If Not IsNull(Me.cboSpeciesFilter) Then
    Me.cboSpeciesFilter.Requery
End If

'Update detail combo row source
If Not IsNull(Me.cboSpeciesFilter) Then
    'Get SQL
    strFrom = "qryPVComboWithDetails"
    strRS = GetRowSource(strFrom & ".DetailID, " & _
        "First(DetectionDetails.DetailText) & ' (' & " & _
        "Count(" & strFrom & ".ImgID) & ')' As DText", _
        strFrom & " INNER JOIN DetectionDetails ON " & _
        strFrom & ".DetailID = DetectionDetails.DetailID", _
        Replace(RemoveFilterClause(strFilter, "DetailID"), _
        "SpeciesID", strFrom & ".SpeciesID"), _
        strFrom & ".DetailID", "First(DetectionDetails.DetailText)")
    'Apply new row source
    Me.cboDetailFilter.RowSource = strRS
    If Not IsNull(Me.cboDetailFilter) Then
        Me.cboDetailFilter.Requery
    End If
End If

End Sub
