Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =2
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =11520
    DatasheetFontHeight =11
    ItemSuffix =235
    Right =19890
    Bottom =13095
    RecSrcDt = Begin
        0x889c6f9a77e9e340
    End
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            GridlineColor =7233610
        End
        Begin Rectangle
            BackStyle =0
            BorderLineStyle =0
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin Line
            BorderLineStyle =0
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin Image
            BackStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            GridlineColor =16118511
            BorderLineStyle =0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            GridlineColor =7233610
        End
        Begin OptionGroup
            BackStyle =1
            BorderLineStyle =0
            BorderColor =11644565
        End
        Begin BoundObjectFrame
            SizeMode =3
            BorderLineStyle =0
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            GridlineColor =7233610
        End
        Begin ListBox
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            GridlineColor =7233610
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            GridlineColor =7233610
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderLineStyle =0
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            GridlineColor =7233610
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            GridlineColor =16118511
            BorderLineStyle =0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            BorderLineStyle =0
        End
        Begin Attachment
            BackStyle =0
            BorderLineStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            GridlineColor =7233610
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            AutoHeight =1
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =5670
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Mark-Recapture Query Builder"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =5970
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =11040
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    HorizontalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =11040
                    LayoutCachedTop =120
                    LayoutCachedWidth =11406
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =7860
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin Subform
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =7920
                    Top =360
                    Width =3480
                    Height =7380
                    TabIndex =17
                    Name ="ResultsSubform"
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =7920
                    LayoutCachedTop =360
                    LayoutCachedWidth =11400
                    LayoutCachedHeight =7740
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =7920
                            Top =120
                            Width =1440
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="ResultsSubform_Label"
                            Caption ="Results Preview:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =7920
                            LayoutCachedTop =120
                            LayoutCachedWidth =9360
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2040
                    Top =1560
                    Width =1019
                    Height =285
                    TabIndex =4
                    BorderColor =7169897
                    Name ="txtStartTime"
                    Format ="Medium Time"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"
                    ShowDatePicker =0

                    LayoutCachedLeft =2040
                    LayoutCachedTop =1560
                    LayoutCachedWidth =3059
                    LayoutCachedHeight =1845
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =829
                            Top =1560
                            Width =1019
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtStartTime_Label"
                            Caption ="Start Time:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =829
                            LayoutCachedTop =1560
                            LayoutCachedWidth =1848
                            LayoutCachedHeight =1845
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    TabIndex =14
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =255
                    Left =120
                    Top =660
                    Width =7502
                    Height =1318
                    TabIndex =1
                    Name ="optStartDate"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =660
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =1978
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =240
                            Top =540
                            Width =1725
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label59"
                            Caption ="Start Date Options:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =540
                            LayoutCachedWidth =1965
                            LayoutCachedHeight =825
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =119
                            Left =600
                            Top =928
                            OptionValue =1
                            Name ="Option61"
                            Tag ="3: 2.8736/.1667"

                            LayoutCachedLeft =600
                            LayoutCachedTop =928
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1168
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =900
                                    Width =1019
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label62"
                                    Caption ="Relative"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =900
                                    LayoutCachedWidth =1849
                                    LayoutCachedHeight =1185
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =119
                            Left =600
                            Top =1258
                            OptionValue =2
                            Name ="Option63"
                            Tag ="3: 3.1028/.1667"

                            LayoutCachedLeft =600
                            LayoutCachedTop =1258
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1498
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =1230
                                    Width =1020
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label64"
                                    Caption ="Absolute"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =1230
                                    LayoutCachedWidth =1850
                                    LayoutCachedHeight =1515
                                End
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =255
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =3855
                    Top =900
                    Width =465
                    Height =285
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtDaysAfterStart"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    GroupTable =1
                    RightPadding =38
                    BottomPadding =38

                    LayoutCachedLeft =3855
                    LayoutCachedTop =900
                    LayoutCachedWidth =4320
                    LayoutCachedHeight =1185
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GroupTable =1
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =2040
                            Top =900
                            Width =1755
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtDaysAfterStart_Label1"
                            Caption ="First occasion starts"
                            FontName ="Franklin Gothic Book"
                            GroupTable =1
                            BottomPadding =38
                            LayoutCachedLeft =2040
                            LayoutCachedTop =900
                            LayoutCachedWidth =3795
                            LayoutCachedHeight =1185
                            LayoutGroup =1
                            GroupTable =1
                        End
                    End
                End
                Begin Label
                    OverlapFlags =247
                    TextAlign =1
                    TextFontFamily =34
                    Left =4494
                    Top =900
                    Width =2700
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtDaysAfterStart_Label2"
                    Caption ="days after camera set date"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =4494
                    LayoutCachedTop =900
                    LayoutCachedWidth =7194
                    LayoutCachedHeight =1185
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =4920
                    Top =1230
                    Width =2280
                    Height =285
                    TabIndex =3
                    BorderColor =7169897
                    Name ="txtStartDate"
                    Format ="mmmm d"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="DateValue(DMin(\"ImageDate\",\"Photos\"))"
                    GroupTable =3
                    RightPadding =38
                    BottomPadding =38

                    LayoutCachedLeft =4920
                    LayoutCachedTop =1230
                    LayoutCachedWidth =7200
                    LayoutCachedHeight =1515
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    GroupTable =3
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextAlign =1
                            TextFontFamily =34
                            Left =2040
                            Top =1230
                            Width =2820
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtStartDate_Label"
                            Caption ="Enter start date for first interval:"
                            FontName ="Franklin Gothic Book"
                            GroupTable =3
                            BottomPadding =38
                            LayoutCachedLeft =2040
                            LayoutCachedTop =1230
                            LayoutCachedWidth =4860
                            LayoutCachedHeight =1515
                            LayoutGroup =2
                            GroupTable =3
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =2400
                    Width =1379
                    Height =285
                    TabIndex =5
                    BorderColor =7169897
                    Name ="txtIntNumber"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="4"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2400
                    LayoutCachedWidth =4259
                    LayoutCachedHeight =2685
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =840
                            Top =2400
                            Width =1875
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtIntNumber_Label"
                            Caption ="Number of occasions:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =2400
                            LayoutCachedWidth =2715
                            LayoutCachedHeight =2685
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =255
                    Left =120
                    Top =2160
                    Width =7502
                    Height =957
                    TabIndex =15
                    Name ="Frame83"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =2160
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =3117
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =240
                            Top =2040
                            Width =1560
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label84"
                            Caption ="Interval Options:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =2040
                            LayoutCachedWidth =1800
                            LayoutCachedHeight =2325
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =2730
                    Width =1379
                    Height =285
                    TabIndex =6
                    BorderColor =7169897
                    Name ="txtIntDuration"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="2"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2730
                    LayoutCachedWidth =4259
                    LayoutCachedHeight =3015
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =840
                            Top =2730
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtIntDuration_Label"
                            Caption ="Duration:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =2730
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =3015
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =4494
                    Top =2730
                    Width =1560
                    Height =285
                    TabIndex =7
                    BorderColor =7169897
                    Name ="cboIntDurationUnits"
                    RowSourceType ="Value List"
                    RowSource ="\"Day(s)\";\"Week(s)\""
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="\"Week(s)\""
                    AllowValueListEdits =0

                    LayoutCachedLeft =4494
                    LayoutCachedTop =2730
                    LayoutCachedWidth =6054
                    LayoutCachedHeight =3015
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =4427
                    Width =7502
                    Height =2277
                    TabIndex =16
                    Name ="Frame100"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =4427
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =6704
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =4307
                            Width =660
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label101"
                            Caption ="Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =4307
                            LayoutCachedWidth =900
                            LayoutCachedHeight =4592
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4997
                    Width =2519
                    Height =285
                    TabIndex =9
                    BorderColor =7169897
                    Name ="txtNorthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4997
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5282
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4997
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtNorthOfUTM_Label1"
                            Caption ="North of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4997
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5282
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =5326
                    Width =2519
                    Height =285
                    TabIndex =10
                    BorderColor =7169897
                    Name ="txtSouthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =5326
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5611
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =5326
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtSouthOfUTM_Label1"
                            Caption ="South of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =5326
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5611
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =4667
                    Width =2519
                    Height =285
                    TabIndex =8
                    BorderColor =7169897
                    Name ="cboStudyArea"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT StudyAreas.StudyAreaID, StudyAreas.StudyAreaName FROM StudyAreas;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"
                    AllowValueListEdits =0

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4667
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4952
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4667
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboStudyArea_Label"
                            Caption ="Study Area:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4667
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4952
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =5656
                    Width =2519
                    Height =285
                    TabIndex =11
                    BorderColor =7169897
                    Name ="txtEastOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =5656
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5941
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =5656
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtEastOfUTM_Label1"
                            Caption ="East of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =5656
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5941
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =5986
                    Width =2519
                    Height =285
                    TabIndex =12
                    BorderColor =7169897
                    Name ="txtWestOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =5986
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6271
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =5986
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtWestOfUTM_Label1"
                            Caption ="West of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =5986
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6271
                        End
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4997
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtNorthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4997
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5282
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =5326
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtSouthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =5326
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5611
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =5656
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtEastOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =5656
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5941
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =5986
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtWestOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =5986
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =6271
                End
                Begin ComboBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =1920
                    Top =120
                    Width =3180
                    Height =315
                    BorderColor =7169897
                    Name ="cboSpecies"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, Species.CommonName FROM (Species INNER JOIN Independen"
                        "tDetections ON Species.SpeciesID = IndependentDetections.SpeciesID) INNER JOIN I"
                        "ndividualDetections ON IndependentDetections.IndDetectionID = IndividualDetectio"
                        "ns.IndDetectionID GROUP BY Species.SpeciesID, Species.CommonName HAVING (((Speci"
                        "es.SpeciesID)>0)) ORDER BY Species.CommonName;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"

                    LayoutCachedLeft =1920
                    LayoutCachedTop =120
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =435
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =34
                            Left =120
                            Top =120
                            Width =1590
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpecies_Label"
                            Caption ="Select the species:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =1710
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5160
                    Top =120
                    Width =300
                    Height =315
                    TabIndex =18
                    ForeColor =2366701
                    Name ="txtSpeciesReqd"
                    ControlSource ="=IIf([cboSpecies] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5160
                    LayoutCachedTop =120
                    LayoutCachedWidth =5460
                    LayoutCachedHeight =435
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4320
                    Top =899
                    Width =144
                    Height =285
                    TabIndex =19
                    ForeColor =2366701
                    Name ="txtDaysAfterStartReqd"
                    ControlSource ="=IIf([txtDaysAfterStart] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =4320
                    LayoutCachedTop =899
                    LayoutCachedWidth =4464
                    LayoutCachedHeight =1184
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3060
                    Top =1560
                    Width =300
                    Height =285
                    TabIndex =20
                    ForeColor =2366701
                    Name ="txtStartTimeReqd"
                    ControlSource ="=IIf([txtStartTime] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3060
                    LayoutCachedTop =1560
                    LayoutCachedWidth =3360
                    LayoutCachedHeight =1845
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7200
                    Top =1230
                    Width =300
                    Height =285
                    TabIndex =21
                    ForeColor =2366701
                    Name ="txtStartDateReqd"
                    ControlSource ="=IIf([txtStartDate] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =7200
                    LayoutCachedTop =1230
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =1515
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6060
                    Top =2730
                    Width =300
                    Height =285
                    TabIndex =22
                    ForeColor =2366701
                    Name ="txtIntDurationUnitsReqd"
                    ControlSource ="=IIf([cboIntDurationUnits] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =6060
                    LayoutCachedTop =2730
                    LayoutCachedWidth =6360
                    LayoutCachedHeight =3015
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4260
                    Top =2400
                    Width =180
                    Height =285
                    TabIndex =23
                    ForeColor =2366701
                    Name ="txtIntNumberReqd"
                    ControlSource ="=IIf([txtIntNumber] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =4260
                    LayoutCachedTop =2400
                    LayoutCachedWidth =4440
                    LayoutCachedHeight =2685
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4260
                    Top =2730
                    Width =180
                    Height =285
                    TabIndex =24
                    ForeColor =2366701
                    Name ="txtIntDurationReqd"
                    ControlSource ="=IIf([txtIntDuration] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =4260
                    LayoutCachedTop =2730
                    LayoutCachedWidth =4440
                    LayoutCachedHeight =3015
                End
                Begin ComboBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =6315
                    Width =2519
                    Height =285
                    TabIndex =13
                    BorderColor =7169897
                    Name ="cboSurveyYear"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Year([CameraSetDate]) AS Yr FROM CameraSetDates GROUP BY Year([CameraSetD"
                        "ate]);"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =6315
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6600
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =6315
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSurveyYear_Label"
                            Caption ="Survey year:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =6315
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6600
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4860
                    Top =6827
                    Width =1920
                    Height =420
                    TabIndex =27
                    Name ="cmdExport"
                    Caption ="Export"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =4860
                    LayoutCachedTop =6827
                    LayoutCachedWidth =6780
                    LayoutCachedHeight =7247
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2820
                    Top =6827
                    Width =1920
                    Height =420
                    TabIndex =26
                    Name ="cmdSave"
                    Caption ="Save"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =2820
                    LayoutCachedTop =6827
                    LayoutCachedWidth =4740
                    LayoutCachedHeight =7247
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =780
                    Top =6827
                    Width =1920
                    Height =420
                    TabIndex =25
                    Name ="cmdQuery"
                    Caption ="Open Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =780
                    LayoutCachedTop =6827
                    LayoutCachedWidth =2700
                    LayoutCachedHeight =7247
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2820
                    Top =7367
                    Width =1920
                    Height =420
                    TabIndex =28
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =2820
                    LayoutCachedTop =7367
                    LayoutCachedWidth =4740
                    LayoutCachedHeight =7787
                End
                Begin Label
                    OverlapFlags =247
                    TextFontFamily =34
                    Left =3420
                    Top =1560
                    Width =3600
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtStartTime_Label2"
                    Caption ="(Leave blank to use time from first photo)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =3420
                    LayoutCachedTop =1560
                    LayoutCachedWidth =7020
                    LayoutCachedHeight =1845
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =3300
                    Width =7502
                    Height =943
                    TabIndex =29
                    Name ="optOutput"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"

                    LayoutCachedLeft =120
                    LayoutCachedTop =3300
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =4243
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =3180
                            Width =1485
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label221"
                            Caption ="Output Format:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =240
                            LayoutCachedTop =3180
                            LayoutCachedWidth =1725
                            LayoutCachedHeight =3465
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =306
                            Top =3538
                            OptionValue =1
                            Name ="Option222"

                            LayoutCachedLeft =306
                            LayoutCachedTop =3538
                            LayoutCachedWidth =566
                            LayoutCachedHeight =3778
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =540
                                    Top =3512
                                    Width =1755
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label223"
                                    Caption ="SECR (R/DENSITY)"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =540
                                    LayoutCachedTop =3512
                                    LayoutCachedWidth =2295
                                    LayoutCachedHeight =3797
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =306
                            Top =3868
                            OptionValue =2
                            Name ="Option224"

                            LayoutCachedLeft =306
                            LayoutCachedTop =3868
                            LayoutCachedWidth =566
                            LayoutCachedHeight =4108
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =536
                                    Top =3840
                                    Width =1035
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label225"
                                    Caption ="Mark"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =536
                                    LayoutCachedTop =3840
                                    LayoutCachedWidth =1571
                                    LayoutCachedHeight =4125
                                End
                            End
                        End
                    End
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =215
                    Left =2880
                    Top =3300
                    Width =4742
                    Height =943
                    TabIndex =30
                    Name ="optDetector"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="1"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3300
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =4243
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =3000
                            Top =3180
                            Width =1485
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label229"
                            Caption ="Detector Type:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =3000
                            LayoutCachedTop =3180
                            LayoutCachedWidth =4485
                            LayoutCachedHeight =3465
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =215
                            Left =3066
                            Top =3538
                            OptionValue =1
                            Name ="Option230"

                            LayoutCachedLeft =3066
                            LayoutCachedTop =3538
                            LayoutCachedWidth =3326
                            LayoutCachedHeight =3778
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =3300
                                    Top =3512
                                    Width =1755
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label231"
                                    Caption ="Count"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =3300
                                    LayoutCachedTop =3512
                                    LayoutCachedWidth =5055
                                    LayoutCachedHeight =3797
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =215
                            Left =3066
                            Top =3868
                            OptionValue =2
                            Name ="Option232"

                            LayoutCachedLeft =3066
                            LayoutCachedTop =3868
                            LayoutCachedWidth =3326
                            LayoutCachedHeight =4108
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =3296
                                    Top =3840
                                    Width =1035
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label233"
                                    Caption ="Proximity"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =3296
                                    LayoutCachedTop =3840
                                    LayoutCachedWidth =4331
                                    LayoutCachedHeight =4125
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5580
                    Top =120
                    Width =2040
                    TabIndex =31
                    Name ="cmdUpdate"
                    Caption ="Update Results"
                    OnClick ="=RefreshResults()"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5580
                    LayoutCachedTop =120
                    LayoutCachedWidth =7620
                    LayoutCachedHeight =480
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The SECRQueryBuilder form encountered an error."

Private Sub cmdClose_Click()
'Close the form

On Error GoTo ErrHandler

DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdExport_Click()
'Open form for exporting queries

Dim strQName As String

On Error GoTo ErrHandler

strQName = Replace(Me.ResultsSubform.SourceObject, "Query.", "")

DoCmd.OpenForm "ExportQuery", , , "QueryName='" & strQName & "'", _
    , acDialog, GetSettings() & GetEffort()
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the export form.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "SECR Query Help"

End Sub

Private Sub cmdQuery_Click()
'Show query results in a separate tab

On Error GoTo ErrHandler

DoCmd.Close
DoCmd.OpenQuery "SECRQuery"
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the query.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdSave_Click()
'Saves a new query in the database

Dim strQryName As String
Dim db As Database
Dim qdf As QueryDef

On Error GoTo ErrHandler

'Prompt for name
strQryName = InputBox("Enter a name for the new query:")
Set db = CurrentDb
For Each qdf In db.QueryDefs
    If qdf.Name = strQryName Then
        'Existing query - prompt to overwrite
        If MsgBox("Existing query " & strQryName & " will be overwritten." & _
            vbNewLine & vbNewLine & "OK to continue?", vbOKCancel) _
            = vbCancel Then
            'Canceled by user
            GoTo cmdSaveExit
        Else
            'Delete existing query
            db.QueryDefs.Delete strQryName
        End If
    End If
Next qdf

'Create new query
SaveQuery strQryName

cmdSaveExit:
    Set qdf = Nothing
    Set db = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred while saving the query.", _
        Err.Number, Err.Description
    Resume cmdSaveExit

End Sub

Private Sub Form_Close()
'Restore switchboard

If IsLoaded("Switchboard") Then
    DoCmd.SelectObject acForm, "Switchboard", False
    DoCmd.Restore
End If

End Sub

Private Sub Form_Open(Cancel As Integer)
'Hide switchboard and fit to window

On Error GoTo ErrHandler

If IsLoaded("Switchboard") Then
    DoCmd.SelectObject acForm, "Switchboard", False
    DoCmd.Minimize
    DoCmd.SelectObject acForm, "SECRQueryBuilder"
    DoCmd.Restore
End If
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub optOutput_AfterUpdate()

DisableButtons
Me.optDetector.Visible = (Me.optOutput = 1)

End Sub

Private Sub optStartDate_AfterUpdate()
'Show relevant controls and hide others

Dim bRelStart As Boolean

On Error GoTo ErrHandler

'Get start type
bRelStart = (Me.optStartDate = 1)
'Show/hide controls
Me.txtDaysAfterStart.Visible = bRelStart
Me.txtDaysAfterStart_Label2.Visible = bRelStart
Me.txtDaysAfterStartReqd.Visible = bRelStart
Me.txtStartDate.Visible = Not bRelStart
Me.txtStartDateReqd.Visible = Not bRelStart
Me.txtStartTime_Label2.Visible = bRelStart
Me.txtStartTimeReqd.Visible = Not bRelStart
'Set default start time
If IsNull(Me.txtStartTime) And bRelStart = False Then
    Me.txtStartTime = #12:00:00 PM#
End If

DisableButtons
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub txtEastOfUTM_Enter()
'Show help label

On Error Resume Next

Me.txtEastOfUTM_Label2.Visible = True

End Sub

Private Sub txtEastOfUTM_Exit(Cancel As Integer)
'Hide help label

On Error Resume Next

Me.txtEastOfUTM_Label2.Visible = False

End Sub

Private Sub txtNorthOfUTM_Enter()
'Show help label

On Error Resume Next

Me.txtNorthOfUTM_Label2.Visible = True

End Sub

Private Sub txtNorthOfUTM_Exit(Cancel As Integer)
'Hide help label

On Error Resume Next

Me.txtNorthOfUTM_Label2.Visible = False

End Sub

Private Sub txtSouthOfUTM_Enter()
'Show help label

On Error Resume Next

Me.txtSouthOfUTM_Label2.Visible = True

End Sub

Private Sub txtSouthOfUTM_Exit(Cancel As Integer)
'Hide help label

On Error Resume Next

Me.txtSouthOfUTM_Label2.Visible = False

End Sub

Private Sub txtWestOfUTM_Enter()
'Show help label

On Error Resume Next

Me.txtWestOfUTM_Label2.Visible = True

End Sub

Private Sub txtWestOfUTM_Exit(Cancel As Integer)
'Hide help label

On Error Resume Next

Me.txtWestOfUTM_Label2.Visible = False

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Function BuildDetectorWhere() As String
'Returns the where clause for qrySECRDetSubquery

Dim strWhere As String

'Start with visit type filter
strWhere = " WHERE (((Visits.VisitTypeID)=3) AND "

'Add filters one at a time
If Not IsNull(Me.cboStudyArea) Then
    strWhere = strWhere & "((CameraLocations.StudyAreaID) = " & _
        Me.cboStudyArea & ") AND "
End If

If Not IsNull(Me.txtNorthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N) >= " & _
        Me.txtNorthOfUTM & ") AND "
End If

If Not IsNull(Me.txtSouthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N) <= " & _
        Me.txtSouthOfUTM & ") AND "
End If

If Not IsNull(Me.txtEastOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E) >= " & _
        Me.txtEastOfUTM & ") AND "
End If

If Not IsNull(Me.txtWestOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E) <= " & _
        Me.txtWestOfUTM & ") AND "
End If

If Not IsNull(Me.cboSurveyYear) Then
    strWhere = strWhere & "((Year(Visits.VisitDate)) = " & _
        Me.cboSurveyYear & ") AND "
End If

'Remove last "and" and finish off where clause
strWhere = Left(strWhere, Len(strWhere) - 5) & ")"

BuildDetectorWhere = strWhere

End Function

Private Sub BuildMarkQuery(iOccasions As Integer)

Dim qdf As QueryDef
Dim strGroupBy As String
Dim strSQL As String

'Build label SQL for group and select clauses
strGroupBy = "[Individual] & ': ' & [Session]"

'Build select statement
strSQL = "SELECT " & strGroupBy & " As Label, "
strSQL = strSQL & GetMarkCaptures(iOccasions)
strSQL = strSQL & GetMarkGroups()

'Add from and group by clauses
strSQL = strSQL & "FROM SECRQuery GROUP BY " & strGroupBy

'Update MarkRecaptureQuery with new SQL
Set qdf = CurrentDb.QueryDefs("MarkRecaptureQuery")
qdf.SQL = strSQL

Set qdf = Nothing

End Sub

Private Function BuildQuery() As String
'Generate SQL statement and update SECRQuery

Dim strStart As String
Dim strSession As String
Dim strSQL As String
Dim qdf As QueryDef
Dim lngSpeciesID As Long
Dim iDuration As Integer
Dim iOccasions As Integer

'Get parameters
lngSpeciesID = Nz(Me.cboSpecies, 0)
iDuration = Me.txtIntDuration
If Me.cboIntDurationUnits = "Week(s)" Then
    iDuration = iDuration * 7
End If
iOccasions = Nz(Me.txtIntNumber, 1)

'Get SQL for start date and session
strStart = BuildStartString()
strSession = BuildSessionString()

'Build select statement
strSQL = "SELECT " & strSession & ", "
If Me.optDetector = 2 Then
    'Grouped query for proximity detectors
    strSQL = strSQL & "qryCRSubquery.IndividualID, " & _
        "SECROccNumber(" & strStart & ", " & iDuration & _
        ", qryCRSubquery.ModifiedStart) " & _
        "As Occasion, qryCRSubquery.LocationID, First('# ' & " & _
        "qryCRSubquery.StudyAreaName) AS StudyArea, " & _
        "First(qryCRSubquery.LocationName) AS Location, " & _
        "First(qryCRSubquery.IndividualName) AS Individual "
Else
    'Ungrouped query for count detectors
    strSQL = strSQL & "qryCRSubquery.IndividualID, " & _
        "SECROccNumber(" & strStart & ", " & iDuration & _
        ", qryCRSubquery.ModifiedStart) " & _
        "As Occasion, qryCRSubquery.LocationID, '# ' & " & _
        "qryCRSubquery.StudyAreaName AS StudyArea, " & _
        "qryCRSubquery.LocationName AS Location, " & _
        "qryCRSubquery.IndividualName AS Individual "
End If

'Add from clause
strSQL = strSQL & "FROM qryCRSubquery "

'Add where clause
strSQL = strSQL & BuildWhere(strStart, iDuration * iOccasions, lngSpeciesID)

'Add group by clause
If Me.optDetector = 2 Then
    'Only applies when proximity detector is selected
    strSQL = strSQL & " GROUP BY " & Replace(strSession, _
        " AS Session", "") & ", qryCRSubquery.IndividualID, " & _
        "SECROccNumber(" & strStart & ", " & iDuration & _
        ", qryCRSubquery.ModifiedStart), qryCRSubquery.LocationID"
End If

'Update SECRQuery with new SQL
Set qdf = CurrentDb.QueryDefs("SECRQuery")
qdf.SQL = strSQL

'Build SQL statement for detector subquery
strStart = Replace(strStart, "qryCRSubquery.CameraYear", _
    "Year(Visits.VisitDate)")
strStart = Replace(strStart, "qryCRSubquery.OccasionStart", _
    "Nz(DMin('ActiveStart','Visits','SetVisitID='&[Visits].[VisitID])," & _
    "[Visits].[VisitDate])")
strSession = Replace(strSession, "qryCRSubquery].[StudyAreaName", _
    "StudyAreas].[StudyAreaName")
strSession = Replace(strSession, "qryCRSubquery].[LocationID", _
    "Visits].[LocationID")
strSession = Replace(strSession, "qryCRSubquery].[CameraSetDate", _
    "Visits].[VisitDate")
strSQL = "SELECT CameraLocations.LocationID, CameraLocations.UTM_E, " & _
    "CameraLocations.UTM_N, SECREffortString(CameraLocations.LocationID, " & _
    strStart & ", " & iDuration & ", " & iOccasions & ", 12) AS Effort, " & _
    "'#' & CameraLocations.LocationName As Location, " & strSession & _
    " FROM (StudyAreas INNER JOIN CameraLocations ON " & _
    "StudyAreas.StudyAreaID = CameraLocations.StudyAreaID) INNER JOIN " & _
    "Visits ON CameraLocations.LocationID = Visits.LocationID"
strSQL = strSQL & BuildDetectorWhere()

'Overwrite detector subquery
Set qdf = CurrentDb.QueryDefs("qrySECRDetSubquery")
qdf.SQL = strSQL

Set qdf = Nothing

If Me.optOutput = 2 Then
    BuildMarkQuery iOccasions
    BuildQuery = "MarkRecaptureQuery"
Else
    BuildQuery = "SECRQuery"
End If

End Function

Private Function BuildSessionString() As String
'Return the SQL statement for the session field

Dim strResult As String

strResult = "Left(Replace([qryCRSubquery].[StudyAreaName]," & _
    "' ',''),12) & DCount('*','Visits','VisitTypeID=3 And " & _
    "LocationID=' & [qryCRSubquery].[LocationID] & " & _
    "' And VisitDate<=#' & [qryCRSubquery].[CameraSetDate] & '#"
If Not IsNull(Me.cboSurveyYear) Then
    strResult = strResult & " And Year(VisitDate)=" & Me.cboSurveyYear
End If
strResult = strResult & "') AS Session"

BuildSessionString = strResult

End Function

Private Function BuildStartString() As String
'Generate SQL for StartDatetime field

Dim dblDelay As Double
Dim strDateField As String
Dim dStart As Date

If Me.optStartDate = 1 Then
    'Relative Start, get delay and start time
    dblDelay = Nz(Me.txtDaysAfterStart, 0) + _
        Nz(Me.txtStartTime, 0)
    If dblDelay > 0 Then
        'Strip time from occasionstart field and
        'add specified number of days and start time
        strDateField = "CDate(DateValue(" & _
            "qryCRSubquery.OccasionStart) + " & _
            dblDelay & ")"
    Else
        'No delay or start time specified,
        'use occasionstart field
        strDateField = "qryCRSubquery.OccasionStart"
    End If
Else
    'Absolute start, use date specified (corrected for year)
    dStart = Nz(Me.txtStartDate, 0)
    dStart = dStart + Nz(Me.txtStartTime, 0)
    strDateField = "ReplaceYear(#" & USDate(dStart) & _
        "#,qryCRSubquery.CameraYear)"
End If

BuildStartString = strDateField

End Function

Private Function BuildWhere(strStartDate As String, _
    iAddDays As Integer, lngSpeciesID As Long) As String
'Returns the where clause for SECRQuery

Dim strWhere As String

'Start with criteria that are always included
strWhere = "((qryCRSubquery.ModifiedStart) " & _
    "Between " & strStartDate & " And DateAdd('s', -1, " & _
    "DateAdd('d', " & iAddDays & ", " & strStartDate & _
    "))) AND ((qryCRSubquery.SpeciesID)=" & _
    lngSpeciesID & ") AND ((qryCRSubquery.IndividualID)>0) AND "

'Add filters one at a time
If Not IsNull(Me.cboStudyArea) Then
    strWhere = strWhere & "((qryCRSubquery.StudyAreaID) = " & _
        Me.cboStudyArea & ") AND "
End If

If Not IsNull(Me.txtNorthOfUTM) Then
    strWhere = strWhere & "((qryCRSubquery.UTM_N) >= " & _
        Me.txtNorthOfUTM & ") AND "
End If

If Not IsNull(Me.txtSouthOfUTM) Then
    strWhere = strWhere & "((qryCRSubquery.UTM_N) <= " & _
        Me.txtSouthOfUTM & ") AND "
End If

If Not IsNull(Me.txtEastOfUTM) Then
    strWhere = strWhere & "((qryCRSubquery.UTM_E) >= " & _
        Me.txtEastOfUTM & ") AND "
End If

If Not IsNull(Me.txtWestOfUTM) Then
    strWhere = strWhere & "((qryCRSubquery.UTM_E) <= " & _
        Me.txtWestOfUTM & ") AND "
End If

If Not IsNull(Me.cboSurveyYear) Then
    strWhere = strWhere & "((qryCRSubquery.CameraYear) = " & _
        Me.cboSurveyYear & ") AND "
End If

If Len(strWhere) > 0 Then
    'Remove last "and" and finish off where clause
    strWhere = Left(strWhere, Len(strWhere) - 5)
    strWhere = " WHERE (" & strWhere & ")"
End If

BuildWhere = strWhere

End Function

Private Function DisableButtons() As Integer
'Disable output buttons when settings have changed

Dim strAC As String

strAC = Me.ActiveControl.Name

If strAC = "cmdQuery" Or strAC = "cmdSave" Or _
    strAC = "cmdExport" Then
    Me.txtFocus.SetFocus
End If

Me.cmdQuery.Enabled = False
Me.cmdSave.Enabled = False
Me.cmdExport.Enabled = False
If TestForm() Then
    Me.cmdUpdate.Visible = True
Else
    If strAC = "cmdUpdate" Then
        Me.txtFocus.SetFocus
        Me.cmdUpdate.Visible = False
    End If
End If

End Function

Private Function GetEffort() As String

Dim strResult As String

If Me.optOutput = 2 Then
    strResult = GetMarkEffort()
Else
    strResult = ""
End If

GetEffort = strResult

End Function

Private Function GetMarkCaptures(iOccasions As Integer) As String

Dim strResult As String
Dim i As Integer

i = 0
Do Until i = iOccasions
    strResult = strResult & "Max(IIf([Occasion]=" & i + 1 & _
        ",1,0)) As Occasion" & i + 1 & ", "
    i = i + 1
Loop

GetMarkCaptures = strResult

End Function

Private Function GetMarkEffort() As String

Dim db As DAO.Database
Dim qdf As QueryDef
Dim rs As DAO.Recordset
Dim strSQL As String
Dim i As Integer
Dim strResult As String

i = 0

'Build select statement
strSQL = "SELECT qrySECRDetSubquery.Session, "
Do Until i = Me.txtIntNumber
    'Add fields for each occasion
    strSQL = strSQL & "Sum(SECRSplitEffortString(" & _
        "qrySECRDetSubquery.Effort, " & i + 1 & ")) As GroupEffort" & _
        i + 1 & ", "
    i = i + 1
Loop
'Remove last comma
strSQL = Left(strSQL, Len(strSQL) - 2) & " "
'Finish SQL statement
strSQL = strSQL & "FROM qrySECRDetSubquery GROUP BY qrySECRDetSubquery.Session"

Set db = CurrentDb
Set qdf = db.QueryDefs("qryMarkEffort")
qdf.SQL = strSQL
Set rs = qdf.OpenRecordset
If Not (rs.BOF And rs.EOF) Then
    rs.MoveFirst
    Do Until rs.EOF
        i = 0
        strResult = strResult & "*//*Effort for " & rs!Session & "    "
        Do Until i = Me.txtIntNumber
            strResult = strResult & "   Occ" & i + 1 & ": " & _
                rs.Fields("GroupEffort" & i + 1).Value
            i = i + 1
        Loop
        rs.MoveNext
    Loop
End If
rs.Close

GetMarkEffort = strResult

Set rs = Nothing
Set qdf = Nothing
Set db = Nothing

End Function

Private Function GetMarkGroups() As String

Dim db As DAO.Database
Dim rs As DAO.Recordset
Dim i As Integer
Dim strResult As String

'Get unique study area/group combinations
Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT Session " & _
    "FROM SECRQuery GROUP BY Session")
i = 0
If Not (rs.EOF And rs.BOF) Then
    rs.MoveFirst
    'Loop through combinations creating a group field for each
    Do Until rs.EOF
        strResult = strResult & "Max(IIf([Session]='" & _
            rs!Session & "',1,0)) As Group" & i + 1 & ", "
        rs.MoveNext
        i = i + 1
    Loop
    'Remove last comma
    strResult = Left(strResult, Len(strResult) - 2) & " "
Else
    'No records, punt
    strResult = "1 As Group1 "
End If

rs.Close
Set rs = Nothing
Set db = Nothing

GetMarkGroups = strResult

End Function

Private Function GetSettings() As String
'Creates settings string for exporting queries

Dim strSpecies As String
Dim strStart As String
Dim strOcc As String
Dim strDuration As String
Dim strFilterS As String

'Get species and occasions
strSpecies = Me.cboSpecies.Column(1)
strOcc = Me.txtIntNumber & " occasions"

'Generate start string
strStart = "first occasion starts "
If Me.optStartDate = 1 Then
    strStart = strStart & Me.txtDaysAfterStart & _
        " days after set date"
Else
    strStart = strStart & Format(Me.txtStartDate, "mmmm d")
End If
If IsNull(Me.txtStartTime) Then
    strStart = strStart & " at ActiveStart"
Else
    strStart = strStart & " at " & Format(Me.txtStartTime, "short time")
End If

'Get duration
strDuration = Me.txtIntDuration & " " & Me.cboIntDurationUnits & _
    " per occasion"

'Get detector type
If Me.optOutput = 1 Then
    If Me.optDetector = 1 Then
        strSpecies = strSpecies & "; Count detector type"
    Else
        strSpecies = strSpecies & "; Proximity detector type"
    End If
End If

'Get filters
If Not IsNull(Me.cboStudyArea) Then
    strFilterS = "Study area = " & Me.cboStudyArea.Column(1) & _
    " AND "
End If
If Not IsNull(Me.txtNorthOfUTM) Then
    strFilterS = strFilterS & "North of " & _
        Me.txtNorthOfUTM & " And "
End If
If Not IsNull(Me.txtSouthOfUTM) Then
    strFilterS = strFilterS & "South of " & _
        Me.txtSouthOfUTM & " And "
End If
If Not IsNull(Me.txtEastOfUTM) Then
    strFilterS = strFilterS & "East of " & _
        Me.txtEastOfUTM & " And "
End If
If Not IsNull(Me.txtWestOfUTM) Then
    strFilterS = strFilterS & "West of " & _
        Me.txtWestOfUTM & " And "
End If
If Not IsNull(Me.cboSurveyYear) Then
    strFilterS = strFilterS & "Camera set in " & _
        Me.cboSurveyYear
End If
If Right(strFilterS, 5) = " AND " Then
    strFilterS = Left(strFilterS, Len(strFilterS) - 5)
End If
If Len(strFilterS) = 0 Then
    strFilterS = "No filters"
Else
    strFilterS = "Filters: " & strFilterS
End If

'Combine components into one string
GetSettings = strSpecies & "; " & strOcc & "; " & strStart & _
    "; " & strDuration & "; " & strFilterS

End Function

Private Function RefreshResults() As Integer
'Update query and display new results in preview pane

Dim strAC As String

strAC = Me.ActiveControl.Name

'Clear results pane
Me.ResultsSubform.SourceObject = ""
'Check required fields
If TestForm() = True Then
    'Populate results pane
    Me.ResultsSubform.SourceObject = "query." & BuildQuery()
    Me.cmdQuery.Enabled = True
    Me.cmdSave.Enabled = True
    Me.cmdExport.Enabled = True
End If

'Disable update button
If strAC = "cmdUpdate" Then
    Me.txtFocus.SetFocus
End If
Me.cmdUpdate.Visible = False

End Function

Private Sub SaveQuery(strQueryName As String)
'Saves the current SQL statement to a new query object in the DB

Dim db As Database
Dim strSQL As String
Dim qdf As QueryDef
Dim lngObjID As Long
Dim lngGroupID As Long

On Error GoTo ErrHandler

'Create the query object
Set db = CurrentDb
'Get SQL statement
strSQL = db.QueryDefs("SECRQuery").SQL

'Create query object
Set qdf = db.CreateQueryDef(strQueryName, strSQL)

'Add the query to the My Queries nav pane group
lngObjID = Nz(DLookup("ID", "MSysObjects", "Name='" & _
    strQueryName & "'"), 0)
lngGroupID = Nz(DLookup("ID", "MSysNavPaneGroups", "Name='" & _
    "My Queries'"), 0)
If lngObjID <> 0 And lngGroupID <> 0 Then
    DoCmd.SetWarnings False
    strSQL = "INSERT INTO MSysNavPaneGroupToObjects ( GroupID, " & _
        "ObjectID ) VALUES ( " & lngGroupID & ", " & lngObjID & " )"
    DoCmd.RunSQL strSQL
End If

SaveExit:
    Set qdf = Nothing
    Set db = Nothing
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred while saving the query. " & _
        "Please try again.", Err.Number, Err.Description
    Resume SaveExit

End Sub

Private Function TestForm() As Boolean
'Ensures controls are populated correctly before
'refreshing query results

'Check fields that are always required
TestForm = Not (IsNull(Me.cboSpecies) Or _
    IsNull(Me.txtIntNumber) Or IsNull(Me.txtIntDuration) Or _
    IsNull(Me.cboIntDurationUnits))

'Check fields based on start type
If TestForm = True Then
    If Me.optStartDate = 1 Then
        TestForm = Not IsNull(Me.txtDaysAfterStart)
    Else
        TestForm = Not (IsNull(Me.txtStartDate) Or _
            IsNull(Me.txtStartTime))
    End If
End If

End Function
