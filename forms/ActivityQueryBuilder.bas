Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ViewsAllowed =1
    TabularCharSet =163
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =11520
    DatasheetFontHeight =11
    ItemSuffix =80
    Right =20595
    Bottom =14325
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0xc9986d622d66e440
    End
    Caption ="ActivityQueryBuilder"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =163
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =7680
                    Height =525
                    FontSize =20
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Label2"
                    Caption ="Activity Query Builder"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =11040
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    HorizontalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =11040
                    LayoutCachedTop =120
                    LayoutCachedWidth =11406
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =10980
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin Subform
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =7920
                    Top =360
                    Width =3480
                    Height =10500
                    Name ="ResultsSubform"
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =7920
                    LayoutCachedTop =360
                    LayoutCachedWidth =11400
                    LayoutCachedHeight =10860
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =7920
                            Top =120
                            Width =1440
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="ResultsSubform_Label"
                            Caption ="Results Preview:"
                            FontName ="Franklin Gothic Book"
                            VerticalAnchor =1
                            LayoutCachedLeft =7920
                            LayoutCachedTop =120
                            LayoutCachedWidth =9360
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2340
                    Top =120
                    Width =2760
                    Height =315
                    TabIndex =2
                    BorderColor =7169897
                    Name ="cboSpecies"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, Species.CommonName FROM Species WHERE (((Species.Speci"
                        "esID)>0)) ORDER BY Species.CommonName;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"

                    LayoutCachedLeft =2340
                    LayoutCachedTop =120
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =435
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =34
                            Left =120
                            Top =120
                            Width =2114
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpecies_Label"
                            Caption ="Select the species:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =2234
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextFontCharSet =0
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5160
                    Top =120
                    Width =300
                    Height =315
                    TabIndex =4
                    ForeColor =2366701
                    Name ="txtSpeciesReqd"
                    ControlSource ="=IIf([cboSpecies] Is Null And [txtMultiSp] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5160
                    LayoutCachedTop =120
                    LayoutCachedWidth =5460
                    LayoutCachedHeight =435
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2340
                    Top =480
                    Width =2760
                    TabIndex =5
                    Name ="cmdMultiSp"
                    Caption ="Select Multiple Species"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =2340
                    LayoutCachedTop =480
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =840
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =7440
                    Top =540
                    Width =360
                    Height =270
                    TabIndex =7
                    Name ="chk2Obs"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="-1"
                    RowGroup =1
                    GroupTable =3

                    LayoutCachedLeft =7440
                    LayoutCachedTop =540
                    LayoutCachedWidth =7800
                    LayoutCachedHeight =810
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =5520
                            Top =540
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chk2Obs_Label"
                            Caption ="Require 2 Observers"
                            FontName ="Franklin Gothic Book"
                            RowGroup =1
                            GroupTable =3
                            LayoutCachedLeft =5520
                            LayoutCachedTop =540
                            LayoutCachedWidth =7380
                            LayoutCachedHeight =810
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2340
                    Top =900
                    Width =1379
                    Height =285
                    TabIndex =8
                    BorderColor =7169897
                    Name ="txtQuietPeriod"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2340
                    LayoutCachedTop =900
                    LayoutCachedWidth =3719
                    LayoutCachedHeight =1185
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =34
                            Left =120
                            Top =900
                            Width =2115
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtQuietPeriod_Label"
                            Caption ="Quiet Period (minutes):"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =120
                            LayoutCachedTop =900
                            LayoutCachedWidth =2235
                            LayoutCachedHeight =1185
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =87
                    TextFontCharSet =0
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3720
                    Top =900
                    Width =180
                    Height =285
                    TabIndex =9
                    ForeColor =2366701
                    Name ="txtQPReqd"
                    ControlSource ="=IIf([txtQuietPeriod] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3720
                    LayoutCachedTop =900
                    LayoutCachedWidth =3900
                    LayoutCachedHeight =1185
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2340
                    Top =120
                    Width =2490
                    Height =315
                    TabIndex =3
                    BorderColor =7169897
                    Name ="txtMultiSp"

                    LayoutCachedLeft =2340
                    LayoutCachedTop =120
                    LayoutCachedWidth =4830
                    LayoutCachedHeight =435
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =1380
                    Width =7502
                    Height =958
                    TabIndex =10
                    Name ="optZone"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =1380
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =2338
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =1260
                            Width =1260
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label59"
                            Caption ="Zone Options:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =1260
                            LayoutCachedWidth =1500
                            LayoutCachedHeight =1545
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =1648
                            OptionValue =1
                            Name ="Option61"
                            Tag ="3: 2.8736/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =1648
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1888
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =1620
                                    Width =1634
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label62"
                                    Caption ="Use Study Areas"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =1620
                                    LayoutCachedWidth =2464
                                    LayoutCachedHeight =1905
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =1978
                            OptionValue =2
                            Name ="Option63"
                            Tag ="3: 3.1028/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =1978
                            LayoutCachedWidth =860
                            LayoutCachedHeight =2218
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =1950
                                    Width =1635
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label64"
                                    Caption ="Use Custom Zones"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =1950
                                    LayoutCachedWidth =2465
                                    LayoutCachedHeight =2235
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =2520
                    Top =1920
                    Width =2580
                    TabIndex =11
                    Name ="cmdEditZones"
                    Caption ="Edit Custom Zones"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =2520
                    LayoutCachedTop =1920
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =2280
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =87
                    TextFontFamily =34
                    Left =3960
                    Top =900
                    Width =2460
                    Height =480
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="lblUpdating"
                    Caption ="Updating temporary tables.  Please wait..."
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =3960
                    LayoutCachedTop =900
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =1380
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    TabIndex =1
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =3660
                    Width =7502
                    Height =1917
                    TabIndex =13
                    Name ="Frame100"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =3660
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =5577
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =3540
                            Width =1440
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label101"
                            Caption ="Location Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =3540
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =3825
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4230
                    Width =2519
                    Height =285
                    TabIndex =15
                    BorderColor =7169897
                    Name ="txtNorthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4230
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4515
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4230
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtNorthOfUTM_Label1"
                            Caption ="North of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4230
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4515
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4559
                    Width =2519
                    Height =285
                    TabIndex =16
                    BorderColor =7169897
                    Name ="txtSouthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4559
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4844
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4559
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtSouthOfUTM_Label1"
                            Caption ="South of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4559
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4844
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =3900
                    Width =2519
                    Height =285
                    TabIndex =14
                    BorderColor =7169897
                    Name ="cboStudyArea"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT StudyAreas.StudyAreaID, StudyAreas.StudyAreaName FROM StudyAreas;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"
                    AllowValueListEdits =0

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3900
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4185
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =3900
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboStudyArea_Label"
                            Caption ="Study Area:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =3900
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4185
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4889
                    Width =2519
                    Height =285
                    TabIndex =17
                    BorderColor =7169897
                    Name ="txtEastOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4889
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5174
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4889
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtEastOfUTM_Label1"
                            Caption ="East of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4889
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5174
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =5219
                    Width =2519
                    Height =285
                    TabIndex =18
                    BorderColor =7169897
                    Name ="txtWestOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =5219
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5504
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =5219
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtWestOfUTM_Label1"
                            Caption ="West of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =5219
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5504
                        End
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4230
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtNorthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4230
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =4515
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4559
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtSouthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4559
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =4844
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4889
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtEastOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4889
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5174
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =5219
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtWestOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =5219
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5504
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =85
                    Left =120
                    Top =2520
                    Width =7502
                    Height =958
                    TabIndex =12
                    Name ="optOutput"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =2520
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =3478
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =2400
                            Width =2775
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label16"
                            Caption ="Time Field Calculation Options:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =2400
                            LayoutCachedWidth =3015
                            LayoutCachedHeight =2685
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =2788
                            OptionValue =1
                            Name ="Option17"
                            Tag ="3: 2.8736/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =2788
                            LayoutCachedWidth =860
                            LayoutCachedHeight =3028
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =2760
                                    Width =1634
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label18"
                                    Caption ="Decimal"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =2760
                                    LayoutCachedWidth =2464
                                    LayoutCachedHeight =3045
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =3118
                            OptionValue =2
                            Name ="Option19"
                            Tag ="3: 3.1028/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =3118
                            LayoutCachedWidth =860
                            LayoutCachedHeight =3358
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =830
                                    Top =3090
                                    Width =1635
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label20"
                                    Caption ="Radians"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =830
                                    LayoutCachedTop =3090
                                    LayoutCachedWidth =2465
                                    LayoutCachedHeight =3375
                                End
                            End
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =5760
                    Width =7502
                    Height =2277
                    TabIndex =19
                    Name ="Frame22"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =5760
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =8037
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =5640
                            Width =1140
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label23"
                            Caption ="Date Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =5640
                            LayoutCachedWidth =1380
                            LayoutCachedHeight =5925
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =6330
                    Width =2519
                    Height =285
                    TabIndex =20
                    BorderColor =7169897
                    Name ="txtStartDate"
                    Format ="Short Date"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =6330
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6615
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =6330
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtStartDate_Label"
                            Caption ="Images between:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =6330
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6615
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =6659
                    Width =2519
                    Height =285
                    TabIndex =21
                    BorderColor =7169897
                    Name ="txtEndDate"
                    Format ="Short Date"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =6659
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6944
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =6659
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtEndDate_Label"
                            Caption ="And:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =6659
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6944
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =7380
                    Width =599
                    Height =285
                    TabIndex =22
                    BorderColor =7169897
                    Name ="txtRelStart"
                    AfterUpdate ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =7380
                    LayoutCachedWidth =3479
                    LayoutCachedHeight =7665
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =7380
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtRelStart_Label"
                            Caption ="Starting:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =7380
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =7665
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =7710
                    Width =599
                    Height =285
                    TabIndex =25
                    BorderColor =7169897
                    Name ="txtRelEnd"
                    AfterUpdate ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =7710
                    LayoutCachedWidth =3479
                    LayoutCachedHeight =7995
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =7710
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtRelEnd_Label"
                            Caption ="Ending:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =7710
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =7995
                        End
                    End
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =1740
                    Top =6000
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="Label38"
                    Caption ="Absolute Date Filters"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =1740
                    LayoutCachedTop =6000
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =6285
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =1740
                    Top =7020
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="Label39"
                    Caption ="Relative Date Filters"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =1740
                    LayoutCachedTop =7020
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =7305
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =3540
                    Top =7380
                    Width =1560
                    Height =285
                    TabIndex =23
                    BorderColor =7169897
                    Name ="cboRelStartUnits"
                    RowSourceType ="Value List"
                    RowSource ="\"Day(s)\";\"Week(s)\";\"Month(s)\""
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="\"Day(s)\""
                    AllowValueListEdits =0

                    LayoutCachedLeft =3540
                    LayoutCachedTop =7380
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =7665
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextFontCharSet =0
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5106
                    Top =7380
                    Width =300
                    Height =285
                    TabIndex =24
                    ForeColor =2366701
                    Name ="txtRSUnitsReqd"
                    ControlSource ="=IIf([cboRelStartUnits] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5106
                    LayoutCachedTop =7380
                    LayoutCachedWidth =5406
                    LayoutCachedHeight =7665
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =3540
                    Top =7710
                    Width =1560
                    Height =285
                    TabIndex =26
                    BorderColor =7169897
                    Name ="cboRelEndUnits"
                    RowSourceType ="Value List"
                    RowSource ="\"Day(s)\";\"Week(s)\";\"Month(s)\""
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="\"Week(s)\""
                    AllowValueListEdits =0

                    LayoutCachedLeft =3540
                    LayoutCachedTop =7710
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =7995
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    TextFontCharSet =0
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5106
                    Top =7710
                    Width =300
                    Height =285
                    TabIndex =27
                    ForeColor =2366701
                    Name ="txtREUnitsReqd"
                    ControlSource ="=IIf([cboRelEndUnits] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5106
                    LayoutCachedTop =7710
                    LayoutCachedWidth =5406
                    LayoutCachedHeight =7995
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =7380
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtRelStart_Label2"
                    Caption ="after set date"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =7380
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =7665
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =7710
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtRelEnd_Label2"
                    Caption ="after start"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =7710
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =7995
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    TextFontFamily =34
                    Left =5460
                    Top =6330
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtStartDate_Label2"
                    Caption ="(Enter start date)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =6330
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =6615
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    TextFontFamily =34
                    Left =5460
                    Top =6659
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtEndDate_Label2"
                    Caption ="(Enter end date)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =6659
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =6944
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =8277
                    Width =7502
                    Height =1557
                    TabIndex =28
                    Name ="Frame46"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =8277
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =9834
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =8160
                            Width =1575
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label47"
                            Caption ="Additional Fields:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =8160
                            LayoutCachedWidth =1815
                            LayoutCachedHeight =8445
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =8520
                    Width =360
                    Height =270
                    TabIndex =29
                    Name ="chkInclDate"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =2
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =8520
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =8790
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =8520
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclDate_Label"
                            Caption ="Image Date"
                            FontName ="Franklin Gothic Book"
                            RowGroup =2
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =8520
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =8790
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =8850
                    Width =360
                    Height =270
                    TabIndex =30
                    Name ="chkInclLoc"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =3
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =8850
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =9120
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =8850
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclLoc_Label"
                            Caption ="Location Name"
                            FontName ="Franklin Gothic Book"
                            RowGroup =3
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =8850
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =9120
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =9180
                    Width =360
                    Height =270
                    TabIndex =31
                    Name ="chkInclUTM"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =4
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =9180
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =9450
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =9180
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclUTM_Label"
                            Caption ="UTM Fields"
                            FontName ="Franklin Gothic Book"
                            RowGroup =4
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =9180
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =9450
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =9510
                    Width =360
                    Height =270
                    TabIndex =32
                    Name ="chkInclSetDate"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =5
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =9510
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =9780
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =9510
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclSetDate_Label"
                            Caption ="Camera Set Date"
                            FontName ="Franklin Gothic Book"
                            RowGroup =5
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =9510
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =9780
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5040
                    Top =9960
                    Width =1920
                    Height =420
                    TabIndex =33
                    Name ="cmdExport"
                    Caption ="Export"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5040
                    LayoutCachedTop =9960
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =10380
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =960
                    Top =9960
                    Width =1920
                    Height =420
                    TabIndex =34
                    Name ="cmdQuery"
                    Caption ="Open Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =960
                    LayoutCachedTop =9960
                    LayoutCachedWidth =2880
                    LayoutCachedHeight =10380
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =10500
                    Width =1920
                    Height =420
                    TabIndex =35
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =10500
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =10920
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =9960
                    Width =1920
                    Height =420
                    TabIndex =36
                    Name ="cmdChart"
                    Caption ="View Chart"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =9960
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =10380
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5520
                    Top =120
                    Width =2100
                    TabIndex =6
                    Name ="cmdUpdate"
                    Caption ="Update Results"
                    OnClick ="=RefreshResults()"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5520
                    LayoutCachedTop =120
                    LayoutCachedWidth =7620
                    LayoutCachedHeight =480
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The ActivityQueryBuilder form encountered an error."
Private strTempDBName As String

Private Sub cmdChart_Click()

BuildChartRecordSource
DoCmd.OpenForm "APChart"

End Sub

Private Sub cmdClose_Click()
'Close the form

On Error GoTo ErrHandler

Me.ResultsSubform.SourceObject = ""
DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdEditZones_Click()
'Open the form for editing activity zones

DisableButtons
DoCmd.OpenForm "APZones", , , , , acDialog

End Sub

Private Sub cmdExport_Click()
'Open the form for exporting quieries

On Error GoTo ErrHandler
If TestForm() = True Then
    RefreshResults
    DoCmd.OpenForm "ExportQuery", , , _
        "QueryName='ActivityPatternQuery'", , acDialog, GetSettings()
Else
    MsgBox "Cannot export - required fields are blank."
End If
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the export form.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "Activity Query Help"

End Sub

Private Sub cmdMultiSp_Click()
'Allows user to select multiple species

If Me.cmdMultiSp.Caption = "Remove Multi-Species Filter" Then
    Me.cboSpecies.Tag = ""
    Me.cboSpecies.Enabled = True
    Me.cboSpecies.SetFocus
    Me.txtMultiSp = Null
    Me.txtMultiSp.Visible = False
    Me.cmdMultiSp.Caption = "Select Multiple Species"
Else
    'Create temporary table
    SpSelectTable
    'Go to selection form
    DoCmd.OpenForm "SpeciesTemp", , , , , acDialog, "Activity"
    If Len(Me.cboSpecies.Tag) > 0 Then
        Me.cmdMultiSp.Caption = "Remove Multi-Species Filter"
        Me.cmdMultiSp.SetFocus
        Me.cboSpecies = Null
        Me.cboSpecies.Enabled = False
        Me.txtMultiSp = "(Multiple)"
        Me.txtMultiSp.Visible = True
    End If
End If

DisableButtons
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdQuery_Click()
'Open the query results in a separate tab

On Error GoTo ErrHandler

If TestForm() = True Then
    RefreshResults
    DoCmd.OpenQuery "ActivityPatternQuery"
Else
    MsgBox "Cannot open query - required fields are blank."
End If
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the query.", _
        Err.Number, Err.Description

End Sub

Private Sub Form_Close()
'Restore switchboard

If IsLoaded("Switchboard") Then
    DoCmd.SelectObject acForm, "Switchboard", False
    DoCmd.Restore
End If

End Sub

Private Sub Form_Open(Cancel As Integer)
'Create temporary database and link to activity data

Dim db As Database

On Error GoTo ErrHandler

Set db = CurrentDb
strTempDBName = db.Name
strTempDBName = Replace(strTempDBName, ".accdb", "AP.accdb")

LockForm True
Me.lblUpdating.Visible = True
DoEvents
AddAPData strTempDBName
DoEvents
If IsLoaded("Switchboard") Then
    DoCmd.Close acForm, "Switchboard"
    DoCmd.OpenForm "Switchboard"
    DoCmd.SelectObject acForm, "Switchboard", False
    DoCmd.Minimize
    DoCmd.SelectObject acForm, "ActivityQueryBuilder"
    DoCmd.Restore
End If
Me.lblUpdating.Visible = False
LockForm False

FOExit:
    Set db = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "Unable to create temporary database for activity " & _
        "pattern analysis.", Err.Number, Err.Description
    Cancel = True
    Resume FOExit

End Sub

Private Sub Form_Unload(Cancel As Integer)
'Delete temporary activity pattern data

'Close query if it's been opened
On Error Resume Next
DoCmd.Close acQuery, "ActivityPatternQuery", acSaveNo

On Error GoTo ErrHandler

'Delete linked table
DoCmd.DeleteObject acTable, "Activity"
Me.ResultsSubform.SourceObject = ""
DoEvents
'Delete temporary database
Kill strTempDBName

Exit Sub

ErrHandler:
    If Err.Number = 70 And WaitForLocks = True Then
        'Permission denied, wait for lock file to clear
        Resume
    Else
        ErrorMsg "An error occurred when deleting temporary data.", _
            Err.Number, Err.Description
    End If

End Sub

Private Sub optZone_AfterUpdate()
'Show/hide button for editing custom zones

If Me.optZone = 1 Then
    Me.cmdEditZones.Visible = False
Else
    Me.cmdEditZones.Visible = True
End If
DisableButtons

End Sub

Private Sub txtEastOfUTM_Enter()
'Show label with guidance text

Me.txtEastOfUTM_Label2.Visible = True

End Sub

Private Sub txtEastOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtEastOfUTM_Label2.Visible = False

End Sub

Private Sub txtEndDate_Enter()
'Show label with guidance text

Me.txtEndDate_Label2.Visible = True

End Sub

Private Sub txtEndDate_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtEndDate_Label2.Visible = False

End Sub

Private Sub txtNorthOfUTM_Enter()
'Show label with guidance text

Me.txtNorthOfUTM_Label2.Visible = True

End Sub

Private Sub txtNorthOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtNorthOfUTM_Label2.Visible = False

End Sub

Private Sub txtQuietPeriod_AfterUpdate()
'Updates the activity table

If IsNumeric(Me.txtQuietPeriod) And Me.txtQuietPeriod > -1 Then
    LockForm True
    Me.lblUpdating.Visible = True
    DoEvents
    UpdateAPData Me.txtQuietPeriod
    DoEvents
    Me.lblUpdating.Visible = False
    LockForm False
End If

End Sub

Private Sub txtRelEnd_AfterUpdate()
'Enable/disable units dropdown

If Not IsNull(Me.txtRelEnd) Then
    Me.cboRelEndUnits.Enabled = True
Else
    Me.cboRelEndUnits.Enabled = False
End If
DisableButtons

End Sub

Private Sub txtRelStart_AfterUpdate()
'Enable/disable units dropdown

If Not IsNull(Me.txtRelStart) Then
    Me.cboRelStartUnits.Enabled = True
Else
    Me.cboRelStartUnits.Enabled = False
End If
DisableButtons

End Sub

Private Sub txtSouthOfUTM_Enter()
'Show label with guidance text

Me.txtSouthOfUTM_Label2.Visible = True

End Sub

Private Sub txtSouthOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtSouthOfUTM_Label2.Visible = False

End Sub

Private Sub txtStartDate_Enter()
'Show label with guidance text

Me.txtStartDate_Label2.Visible = True

End Sub

Private Sub txtStartDate_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtStartDate_Label2.Visible = False

End Sub

Private Sub txtWestOfUTM_Enter()
'Show label with guidance text

Me.txtWestOfUTM_Label2.Visible = True

End Sub

Private Sub txtWestOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtWestOfUTM_Label2.Visible = False

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub AddAPData(strDBName As String)
'Adds activity pattern data to the temporary database

Dim db As Database
Dim qdf As QueryDef
Dim strSQL As String

On Error GoTo ErrHandler

'Create temporary database
CreateTempDatabase strDBName

'Make sure there is no activity table
strSQL = "DROP TABLE [" & strDBName & "].Activity"
On Error Resume Next
DoCmd.RunSQL strSQL
On Error GoTo ErrHandler

'Rewrite query for temp database
Set db = CurrentDb
Set qdf = db.QueryDefs("qryMakeAPTable")
strSQL = Left(qdf.SQL, 241)
strSQL = strSQL & strDBName & chr(39) & " "
strSQL = strSQL & Mid(qdf.SQL, InStr(1, qdf.SQL, "FROM "))
qdf.SQL = strSQL

'Execute query and link resulting table
DoCmd.SetWarnings False
qdf.Execute
On Error Resume Next
DoCmd.DeleteObject acTable, "Activity"
On Error GoTo ErrHandler
DoCmd.TransferDatabase acLink, "Microsoft Access", strDBName, _
    acTable, "Activity", "Activity"

AAPExit:
    DoCmd.SetWarnings True
    Set qdf = Nothing
    Set db = Nothing
    Exit Sub

ErrHandler:
    Dim iError As Integer
    iError = Err
    Err.Clear
    Err.Raise iError
    Resume AAPExit

End Sub

Private Sub BuildChartRecordSource()

Dim db As DAO.Database
Dim rs As DAO.Recordset
Dim strRS As String

BuildQuery
Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT Species, Zone " & _
    "FROM ActivityPatternQuery GROUP BY Species, Zone")
If (rs.EOF And rs.BOF) Then
    strRS = ""
Else
    rs.MoveFirst
    Do Until rs.EOF
        strRS = strRS & "'" & rs!Species & _
            " - Zone " & rs!Zone & "',"
        rs.MoveNext
    Loop
    strRS = Left(strRS, Len(strRS) - 1)
    strRS = "TRANSFORM Count([ActivityPatternQuery]." & _
        "[Zone]) AS [CountOfZone] SELECT [ChartHours]." & _
        "[ChartHour] FROM [ChartHours] LEFT JOIN " & _
        "[ActivityPatternQuery] ON [ChartHours].[ChartHour] " & _
        "= Int([ActivityPatternQuery].[Time]*24) " & _
        "GROUP BY [ChartHours].[ChartHour] PIVOT " & _
        "[ActivityPatternQuery].[Species] & ' - Zone ' & " & _
        "[ActivityPatternQuery].[Zone] IN(" & strRS & ");"
End If

DoCmd.OpenForm "APChart", acDesign, , , , acHidden
Forms("APChart").Controls("APGraph").RowSource = strRS
DoCmd.Close acForm, "APChart", acSaveYes
DoEvents

BCExit:
    If Not rs Is Nothing Then
        rs.Close
        Set rs = Nothing
    End If
    Set db = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred updating the chart", _
    Err.Number, Err.Description
    Resume BCExit

End Sub

Private Sub BuildQuery()
'Updates the SQL for the activity pattern query

Dim strSelect As String
Dim strFrom As String
Dim strWhere As String
Dim strOrder As String
Dim strSQL As String
Dim qdf As QueryDef

'Start where clause
strWhere = "WHERE (((Activity.Include)=True) AND ((Species.SpeciesID)"
'Add species
If Len(Me.cboSpecies.Tag) > 0 Then
    strWhere = strWhere & " In(" & Me.cboSpecies.Tag & ")"
Else
    strWhere = strWhere & "=" & Me.cboSpecies
End If
strWhere = strWhere & ") AND "

'Add observer requirement
If Me.chk2Obs.Value = True Then
    strWhere = strWhere & "((Activity.Obs)>1) AND "
End If

'Add location filters
If Not IsNull(Me.cboStudyArea) Then
    strWhere = strWhere & "((CameraLocations.StudyAreaID)=" & _
        Me.cboStudyArea & ") AND "
End If
If Not IsNull(Me.txtNorthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N)>=" & _
        Me.txtNorthOfUTM & ") AND "
End If
If Not IsNull(Me.txtSouthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N)<=" & _
        Me.txtSouthOfUTM & ") AND "
End If
If Not IsNull(Me.txtEastOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E)>=" & _
        Me.txtEastOfUTM & ") AND "
End If
If Not IsNull(Me.txtWestOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E)>=" & _
        Me.txtWestOfUTM & ") AND "
End If

'Add date filters
If Not IsNull(Me.txtStartDate) Then
    strWhere = strWhere & "((Activity.ImageDate)>=#" & _
        USDate(Me.txtStartDate) & "#) AND "
End If
If Not IsNull(Me.txtEndDate) Then
    strWhere = strWhere & "((Activity.ImageDate)<=#" & _
        USDate(DateAdd("d", 1, Me.txtEndDate)) & "#) AND "
End If
If Not IsNull(Me.txtRelStart) Then
    strWhere = strWhere & "((Activity.ImageDate)>=DateAdd('" & _
        LCase(Left(Me.cboRelStartUnits, 1)) & "', " & _
        Me.txtRelStart & ", Activity.SetVisitDate)) AND "
End If
If Not IsNull(Me.txtRelEnd) Then
    strWhere = strWhere & "((Activity.ImageDate)<=DateAdd('" & _
        LCase(Left(Me.cboRelStartUnits, 1)) & "', " & _
        Nz(Me.txtRelStart, 0) & ", DateAdd('" & _
        LCase(Left(Me.cboRelEndUnits, 1)) & "', " & _
        Me.txtRelEnd & ", Activity.SetVisitDate))) AND "
End If
'Fix weekday vs week in dateadd function
strWhere = Replace(strWhere, "'w'", "'ww'")

'Start select clause
strSelect = "SELECT CameraLocations."
If Me.optZone = 1 Then
    strSelect = strSelect & "StudyAreaID"
Else
    strSelect = strSelect & "APZone"
    strWhere = strWhere & "((CameraLocations.APZone) Is Not Null) AND "
End If
strOrder = Replace(strSelect, "SELECT", "ORDER BY")
strSelect = strSelect & " AS [Zone], Species.CommonName As Species, "

'Add time field
If Me.optOutput = 1 Then
    strSelect = strSelect & "Format((DatePart('n',[ImageDate])+" & _
        "DatePart('h',[ImageDate])*60)/1440,'0.000') AS [Time], "
Else
    strSelect = strSelect & "Format(((DatePart('n',[ImageDate])+" & _
        "DatePart('h',[ImageDate])*60)/180) * Atn(1),'0.000') AS [Time], "
End If

'Add additional fields
If Me.chkInclDate.Value = True Then
    strSelect = strSelect & "Activity.ImageDate, "
End If
If Me.chkInclLoc.Value = True Then
    strSelect = strSelect & "CameraLocations.LocationName, "
End If
If Me.chkInclUTM.Value = True Then
    strSelect = strSelect & "CameraLocations.UTM_E, " & _
        "CameraLocations.UTM_N, "
End If
If Me.chkInclSetDate.Value = True Then
    strSelect = strSelect & "Activity.SetVisitDate, "
End If

'Finish select clause
strSelect = Left(strSelect, Len(strSelect) - 2) & " "

'Finish order clause
strOrder = strOrder & ", Species.CommonName, Activity.ImageDate - " & _
    "Int(Activity.ImageDate);"

'Generate from clause
strFrom = "FROM (Activity INNER JOIN Species ON Activity.SpeciesID " & _
    "= Species.SpeciesID) INNER JOIN CameraLocations ON " & _
    "Activity.LocationID = CameraLocations.LocationID "

'Finish where clause
strWhere = Left(strWhere, Len(strWhere) - 5) & ") "

'Assemble SQL statement
strSQL = strSelect & strFrom & strWhere & strOrder

'Replace query SQL
Set qdf = CurrentDb.QueryDefs("ActivityPatternQuery")
qdf.SQL = strSQL
Set qdf = Nothing

End Sub

Private Function DisableButtons() As Integer
'Disable output when data is not up to date

Dim strAC As String

strAC = Me.ActiveControl.Name

If strAC = "cmdChart" Or strAC = "cmdExport" Or _
    strAC = "cmdQuery" Then
    Me.txtFocus.SetFocus
End If

Me.cmdChart.Enabled = False
Me.cmdExport.Enabled = False
Me.cmdQuery.Enabled = False
If TestForm() Then
    Me.cmdUpdate.Visible = True
Else
    If strAC = "cmdUpdate" Then
        Me.txtFocus.SetFocus
        Me.cmdUpdate.Visible = False
    End If
End If

End Function

Private Function GetSettings() As String
'Returns settings string for export

Dim strSpecies As String
Dim strSettings As String

strSettings = ""

'Get species settings
If IsNull(Me.cboSpecies) Then
    'Multiple species, get IDs from tag property
    strSpecies = Me.cboSpecies.Tag
    'Loop through IDS to get common name
    Do Until InStr(1, strSpecies, ",") = 0
        strSettings = strSettings & DLookup("CommonName", "Species", _
            "SpeciesID=" & Left(strSpecies, InStr(1, strSpecies, _
            ",") - 1)) & ", "
        strSpecies = Mid(strSpecies, InStr(1, strSpecies, ",") + 1)
    Loop
    'Remove final comma
    strSettings = Left(strSettings, Len(strSettings) - 2)
    'Add final species
    strSettings = strSettings & " and " & DLookup("CommonName", _
        "Species", "SpeciesID=" & strSpecies) & "; "
Else
    'Single species, get common name from dropdown
    strSettings = strSettings & Me.cboSpecies.Column(1) & "; "
End If

'Add quiet period
strSettings = strSettings & Me.txtQuietPeriod & " minute quiet period; "

'Add observer requirement
If Me.chk2Obs.Value = True Then
    strSettings = strSettings & "2 observers required; "
End If

'Add zone type
If Me.optZone = 1 Then
    strSettings = strSettings & "study areas as zones; "
Else
    strSettings = strSettings & "custom zones; "
End If

'Add time calculation type
If Me.optOutput = 1 Then
    strSettings = strSettings & "time in decimal days; "
Else
    strSettings = strSettings & "time in radians; "
End If

'Add location filters
If Not IsNull(Me.cboStudyArea) Then
    strSettings = strSettings & "study area = " & _
        Me.cboStudyArea.Column(1) & "; "
End If
If Not IsNull(Me.txtNorthOfUTM) Then
    strSettings = strSettings & "north of " & _
        Me.txtNorthOfUTM & "; "
End If
If Not IsNull(Me.txtSouthOfUTM) Then
    strSettings = strSettings & "south of " & _
        Me.txtSouthOfUTM & "; "
End If
If Not IsNull(Me.txtEastOfUTM) Then
    strSettings = strSettings & "east of " & _
        Me.txtEastOfUTM & "; "
End If
If Not IsNull(Me.txtWestOfUTM) Then
    strSettings = strSettings & "west of " & _
        Me.txtWestOfUTM & "; "
End If

'Add date filters
If Not IsNull(Me.txtStartDate) Then
    strSettings = strSettings & "on or after " & _
        Me.txtStartDate & "; "
End If
If Not IsNull(Me.txtEndDate) Then
    strSettings = strSettings & "on or before " & _
        Me.txtEndDate & "; "
End If
If Not IsNull(Me.txtRelStart) Then
    strSettings = strSettings & "at least " & _
        Me.txtRelStart & " " & LCase(Me.cboRelStartUnits) & _
        " after camera set; "
End If
If Not IsNull(Me.txtRelEnd) Then
    strSettings = strSettings & "at most " & _
        Me.txtRelEnd & " " & LCase(Me.cboRelEndUnits) & _
        " after relative start; "
End If

'Remove final semicolon and space
strSettings = Left(strSettings, Len(strSettings) - 2)
GetSettings = strSettings

End Function

Private Sub LockForm(bLocked As Boolean)
'Enables/disables all controls

Me.txtFocus.SetFocus
Me.cboSpecies.Enabled = Not bLocked
Me.txtQuietPeriod.Enabled = Not bLocked
Me.optZone.Enabled = Not bLocked
Me.optOutput.Enabled = Not bLocked
Me.cmdEditZones.Enabled = Not bLocked
Me.cmdMultiSp.Enabled = Not bLocked
Me.txtMultiSp.Enabled = Not bLocked
Me.cboStudyArea.Enabled = Not bLocked
Me.txtEastOfUTM.Enabled = Not bLocked
Me.txtNorthOfUTM.Enabled = Not bLocked
Me.txtSouthOfUTM.Enabled = Not bLocked
Me.txtWestOfUTM.Enabled = Not bLocked
Me.chk2Obs.Enabled = Not bLocked
Me.cmdUpdate.Visible = TestForm() And Not bLocked
Me.txtStartDate.Enabled = Not bLocked
Me.txtEndDate.Enabled = Not bLocked
Me.txtRelStart.Enabled = Not bLocked
Me.txtRelEnd.Enabled = Not bLocked
Me.cboRelStartUnits.Enabled = Not (bLocked Or _
    IsNull(Me.txtRelStart))
Me.cboRelEndUnits.Enabled = Not (bLocked Or _
    IsNull(Me.txtRelStart))
Me.chkInclDate.Enabled = Not bLocked
Me.chkInclLoc.Enabled = Not bLocked
Me.chkInclUTM.Enabled = Not bLocked
Me.chkInclSetDate.Enabled = Not bLocked
Me.cmdQuery.Enabled = Not (bLocked Or _
    Me.ResultsSubform.SourceObject = "")
Me.cmdChart.Enabled = Not (bLocked Or _
    Me.ResultsSubform.SourceObject = "")
Me.cmdExport.Enabled = Not (bLocked Or _
    Me.ResultsSubform.SourceObject = "")

End Sub

Private Function RefreshResults() As Integer
'Edit query definition and display new results in preview pane

Dim strAC As String

strAC = Me.ActiveControl.Name

'Update query results and enable output buttons
Me.ResultsSubform.SourceObject = ""
If TestForm() = True Then
    BuildQuery
    Me.ResultsSubform.SourceObject = "query.ActivityPatternQuery"
    Me.cmdQuery.Enabled = True
    Me.cmdExport.Enabled = True
    If Me.optOutput = 1 Then
        Me.cmdChart.Enabled = True
    Else
        If strAC = "cmdChart" Then
            Me.cmdExport.SetFocus
        End If
        Me.cmdChart.Enabled = False
    End If
End If

'Disable update button
If strAC = "cmdUpdate" Then
    Me.txtFocus.SetFocus
End If
Me.cmdUpdate.Visible = False

End Function

Private Function TestForm() As Boolean
'Ensure controls are populated correctly before
'refreshing query results

TestForm = False

If IsNull(Me.cboSpecies) And Len(Me.cboSpecies.Tag) = 0 Then
    Exit Function
End If
If IsNumeric(Me.txtQuietPeriod) And Me.txtQuietPeriod > -1 Then
    TestForm = True
End If

End Function

Private Sub UpdateAll(bInclude As Boolean)

Dim strSQL As String

strSQL = "UPDATE Activity SET Include = " & CStr(bInclude)
DoCmd.SetWarnings False
DoCmd.RunSQL strSQL
DoCmd.SetWarnings True

End Sub

Private Sub UpdateAPData(lngMinutes As Long)
'Update the include field in the activity table

Dim db As Database
Dim rs As DAO.Recordset
Dim lngSpeciesID As Long
Dim lngLocationID As Long
Dim dIncludeDate As Date

On Error GoTo ErrHandler

UpdateAll (lngMinutes = 0)
If lngMinutes = 0 Then
    Exit Sub
End If

'Open activity table
Set db = CurrentDb
Set rs = db.OpenRecordset("Activity")
rs.MoveFirst
If (rs.BOF And rs.EOF) Then
    GoTo UAPExit
End If

Do Until rs.EOF
    'Mark first record for inclusion
    rs.Edit
    rs!Include = True
    rs.Update
    'Get data from first record
    lngSpeciesID = rs!SpeciesID
    lngLocationID = rs!LocationID
    dIncludeDate = rs!ImageDate
    rs.MoveNext
    'Loop through subsequent records until species or location changes,
    'or the specified number of minutes have elapsed
    Do Until rs.EOF
        If rs!SpeciesID = lngSpeciesID And rs!LocationID = lngLocationID _
            And rs!ImageDate < DateAdd("n", lngMinutes, dIncludeDate) Then
            rs.Edit
            rs!Include = False
            rs.Update
            rs.MoveNext
        Else
            Exit Do
        End If
    Loop
Loop
rs.Close

UAPExit:
    Set rs = Nothing
    Set db = Nothing
    Exit Sub

ErrHandler:
    Dim lngError As Long
    If Err.Number = 3052 Then
        'Max locks per file exceeded
        'Close and reopen recordset
        lngError = rs.AbsolutePosition
        rs.Close
        Set rs = db.OpenRecordset("Activity")
        rs.MoveFirst
        rs.Move lngError
        Resume
    Else
        lngError = Err
        Err.Clear
        Err.Raise lngError
        Resume UAPExit
    End If

End Sub

Private Function WaitForLocks() As Boolean
'Wait for .laccdb file to disappear before
'deleting temporary database

Dim i As Integer
Dim dblTimer As Double

WaitForLocks = False
dblTimer = Timer

Do Until Dir(Replace(strTempDBName, ".accdb", ".laccdb")) = ""
    If Timer - dblTimer > 1 Then
        i = i + 1
        dblTimer = Timer
    End If
    'Quit after 30 seconds if file is still there
    If i > 30 Then
        Exit Function
    End If
Loop

WaitForLocks = True

End Function
