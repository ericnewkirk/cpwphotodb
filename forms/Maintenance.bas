Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =7920
    DatasheetFontHeight =11
    ItemSuffix =117
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0x889c6f9a77e9e340
    End
    Caption ="Maintenance"
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =4725
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Database Maintenance Tasks"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =5025
                    LayoutCachedHeight =585
                End
            End
        End
        Begin Section
            Height =3000
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =7920
                    Width =0
                    Height =0
                    BorderColor =7169897
                    Name ="txtFocus"

                    LayoutCachedLeft =7920
                    LayoutCachedWidth =7920
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2220
                    Top =60
                    Width =5340
                    Height =285
                    TabIndex =1
                    BorderColor =7169897
                    ConditionalFormat = Begin
                        0x0100000092000000010000000100000000000000000000001800000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b00630062006f005200650070006f007200740054007900700065005d002000 ,
                        0x4900730020004e0075006c006c0000000000
                    End
                    Name ="TaskID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lkupMaintenanceTasks.TaskID, lkupMaintenanceTasks.TaskName FROM lkupMaint"
                        "enanceTasks;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    RowGroup =1
                    GroupTable =2

                    LayoutCachedLeft =2220
                    LayoutCachedTop =60
                    LayoutCachedWidth =7560
                    LayoutCachedHeight =345
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =60
                            Width =1800
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="TaskID_Label"
                            Caption ="Choose a task:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =1
                            GroupTable =2
                            LayoutCachedLeft =360
                            LayoutCachedTop =60
                            LayoutCachedWidth =2160
                            LayoutCachedHeight =345
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =87
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7560
                    Top =60
                    Width =240
                    Height =285
                    TabIndex =4
                    ForeColor =2366701
                    Name ="txtTaskReqd"
                    ControlSource ="=IIf([TaskID] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =7560
                    LayoutCachedTop =60
                    LayoutCachedWidth =7800
                    LayoutCachedHeight =345
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =360
                    Top =1200
                    Width =7200
                    Height =1680
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="lblDescription"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =360
                    LayoutCachedTop =1200
                    LayoutCachedWidth =7560
                    LayoutCachedHeight =2880
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2220
                    Top =810
                    Height =315
                    TabIndex =3
                    BorderColor =7169897
                    ConditionalFormat = Begin
                        0x0100000092000000010000000100000000000000000000001800000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b00630062006f005200650070006f007200740054007900700065005d002000 ,
                        0x4900730020004e0075006c006c0000000000
                    End
                    Name ="UTMZone"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT [ChartHours].[ChartHour]+1 AS [Zone] FROM ChartHours UNION  SELECT [Chart"
                        "Hours].[ChartHour]+25 FROM ChartHours UNION SELECT [ChartHours].[ChartHour]+49 F"
                        "ROM ChartHours WHERE ((([ChartHours].[ChartHour])<12));"
                    ColumnWidths ="1440"
                    AfterUpdate ="[Event Procedure]"
                    RowGroup =2
                    GroupTable =5

                    LayoutCachedLeft =2220
                    LayoutCachedTop =810
                    LayoutCachedWidth =3660
                    LayoutCachedHeight =1125
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =810
                            Width =1800
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="UTMZone_Label"
                            Caption ="UTM Zone:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =2
                            GroupTable =5
                            LayoutCachedLeft =360
                            LayoutCachedTop =810
                            LayoutCachedWidth =2160
                            LayoutCachedHeight =1125
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Visible = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =93
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2220
                    Top =420
                    Height =315
                    TabIndex =2
                    BorderColor =7169897
                    ConditionalFormat = Begin
                        0x0100000092000000010000000100000000000000000000001800000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b00630062006f005200650070006f007200740054007900700065005d002000 ,
                        0x4900730020004e0075006c006c0000000000
                    End
                    Name ="UTMDatum"
                    RowSourceType ="Value List"
                    RowSource ="2;\"NAD83\";7;\"NAD27\""
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="2"
                    RowGroup =3
                    GroupTable =5

                    LayoutCachedLeft =2220
                    LayoutCachedTop =420
                    LayoutCachedWidth =3660
                    LayoutCachedHeight =735
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =420
                            Width =1800
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="UTMDatum_Label"
                            Caption ="UTM Datum:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =3
                            GroupTable =5
                            LayoutCachedLeft =360
                            LayoutCachedTop =420
                            LayoutCachedWidth =2160
                            LayoutCachedHeight =735
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =95
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3660
                    Top =810
                    Width =240
                    Height =285
                    TabIndex =5
                    ForeColor =2366701
                    Name ="txtZoneReqd"
                    ControlSource ="=IIf([UTMZone] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3660
                    LayoutCachedTop =810
                    LayoutCachedWidth =3900
                    LayoutCachedHeight =1095
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =95
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3660
                    Top =420
                    Width =240
                    Height =285
                    TabIndex =6
                    ForeColor =2366701
                    Name ="txtDatumReqd"
                    ControlSource ="=IIf([UTMDatum] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3660
                    LayoutCachedTop =420
                    LayoutCachedWidth =3900
                    LayoutCachedHeight =705
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =481
                    Top =810
                    Width =5219
                    Height =315
                    TabIndex =7
                    BorderColor =7169897
                    Name ="txtSourceDB"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =481
                    LayoutCachedTop =810
                    LayoutCachedWidth =5700
                    LayoutCachedHeight =1125
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =300
                            Top =420
                            Width =5325
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtSourceDB_Label"
                            Caption ="Select the source database:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =300
                            LayoutCachedTop =420
                            LayoutCachedWidth =5625
                            LayoutCachedHeight =690
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =5940
                    Top =810
                    Width =900
                    Height =314
                    TabIndex =8
                    Name ="cmdBrowseSourceDB"
                    Caption ="Command12"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000708890ff608090ff607880ff507080ff506070ff405860ff ,
                        0x404850ff303840ff203030ff202030ff101820ff101010ff101020ff00000000 ,
                        0x0000000000000000708890ff90a0b0ff70b0d0ff0090d0ff0090d0ff0090d0ff ,
                        0x0090c0ff1088c0ff1080b0ff1080b0ff2078a0ff207090ff204860ff20303050 ,
                        0x0000000000000000808890ff80c0d0ff90a8b0ff80e0ffff60d0ffff50c8ffff ,
                        0x50c8ffff40c0f0ff30b0f0ff30a8f0ff20a0e0ff1090d0ff206880ff202830b0 ,
                        0x00000000000000008090a0ff80d0f0ff90a8b0ff90c0d0ff70d8ffff60d0ffff ,
                        0x60d0ffff50c8ffff50c0ffff40b8f0ff30b0f0ff30a8f0ff1088d0ff204860ff ,
                        0x10283020000000008090a0ff80d8f0ff80c8e0ff90a8b0ff80e0ffff70d0ffff ,
                        0x60d8ffff60d0ffff60d0ffff50c8ffff40c0f0ff40b8f0ff30b0f0ff206880ff ,
                        0x10486090000000008098a0ff90e0f0ff90e0ffff90a8b0ff90b8c0ff70d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d0ffff50d0ffff50c8ffff40b8f0ff30a0e0ff ,
                        0x406070f0506070308098a0ff90e0f0ffa0e8ffff80c8e0ff90a8b0ff80e0ffff ,
                        0x80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff70d8ffff70d8ffff ,
                        0x50a8d0ff506070a090a0a0ffa0e8f0ffa0e8ffffa0e8ffff90b0c0ff90b0c0ff ,
                        0x90a8b0ff90a8b0ff80a0b0ff80a0b0ff8098a0ff8098a0ff8090a0ff8090a0ff ,
                        0x808890ff708890ff90a0b0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff708890ff00000000 ,
                        0x000000000000000090a0b0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0x70d8ffff90a0a0ff8098a0ff8098a0ff8090a0ff809090ff708890ff00000000 ,
                        0x000000000000000090a8b0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0x90a0b0ff80a8b0800000000000000000000000000000000000000000906850ff ,
                        0x906850ff906850ff90a8b05090a8b0ff90a8b0ff90a8b0ff90a8b0ff90a8b0ff ,
                        0x90a8b090000000000000000000000000000000000000000000000000a0787050 ,
                        0x906850ff906850ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000907860ff9068506000000000a0787010a09080ff ,
                        0xa0887050907860ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000a0988040a09080ffa08880ffb09880ffa0908080 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =5940
                    LayoutCachedTop =810
                    LayoutCachedWidth =6840
                    LayoutCachedHeight =1124
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =119
                    BackStyle =0
                    IMESentenceMode =3
                    Left =5700
                    Top =810
                    Width =240
                    Height =285
                    TabIndex =9
                    ForeColor =2366701
                    Name ="txtSourceDBReqd"
                    ControlSource ="=IIf([txtSourceDB] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =5700
                    LayoutCachedTop =810
                    LayoutCachedWidth =5940
                    LayoutCachedHeight =1095
                End
            End
        End
        Begin FormFooter
            Height =660
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =5880
                    Top =120
                    Width =1920
                    Height =420
                    Name ="cmdGo"
                    Caption ="Run"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5880
                    LayoutCachedTop =120
                    LayoutCachedWidth =7800
                    LayoutCachedHeight =540
                End
                Begin CommandButton
                    Cancel = NotDefault
                    Visible = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =5880
                    Top =120
                    Width =1920
                    Height =420
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Stop"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5880
                    LayoutCachedTop =120
                    LayoutCachedWidth =7800
                    LayoutCachedHeight =540
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    TextFontFamily =34
                    Width =5760
                    Height =660
                    FontSize =11
                    TopMargin =115
                    BackColor =6108695
                    BorderColor =0
                    ForeColor =-2147483608
                    Name ="lblStatus"
                    Caption ="Initializing..."
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =660
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The maintenance form encountered an error."
Private bContinue As Boolean

Private Sub cmdBrowseSourceDB_Click()
'Browse dialog for selecting photo ID database

Dim dlg As Object
Dim strFilePath As String

On Error GoTo ErrHandler

Set dlg = Application.FileDialog(msoFileDialogFilePicker)
strFilePath = ""
dlg.Filters.Add "Access databases", "*.accdb"
dlg.AllowMultiSelect = False

    If dlg.Show = -1 Then
        strFilePath = dlg.SelectedItems(1)
    End If

Me.txtSourceDB = strFilePath
Call txtSourceDB_AfterUpdate

BrowseExit:
    Set dlg = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "The browse dialog triggered an error.", _
        Err.Number, Err.Description
    Resume BrowseExit

End Sub

Private Sub cmdCancel_Click()
'Close form

On Error GoTo ErrHandler

bContinue = False
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdGo_Click()
'Run selected task

Dim db As DAO.Database
Dim strSQL As String
Dim strMsg As String

Dim rs As DAO.Recordset
Dim lngTotal As Long
Dim i As Long

On Error GoTo ErrHandler

'Disable controls
LockForm True

'Run the selected procedure
Set db = CurrentDb
Select Case Me.TaskID

    Case 1
        UpdateVisitDependencies
        strMsg = "Visits table updated."

    Case 2, 3
        Me.cmdGo.Visible = False
        Me.lblStatus.Visible = True
        bContinue = True
        If Me.TaskID = 2 Then
            strSQL = "UPDATE Photos INNER JOIN Detections ON " & _
                "Photos.ImageID = Detections.ImageID " & _
                "SET Photos.NeedsUpdate = True"
            db.Execute strSQL
        End If
        Set rs = db.OpenRecordset("SELECT * " & _
            "FROM Photos WHERE NeedsUpdate=True")
        If Not (rs.BOF And rs.EOF) Then
            rs.MoveLast
            lngTotal = rs.RecordCount
        Else
            lngTotal = 0
        End If
        Me.lblStatus.Caption = "Combining detections..."
        CombineDetections
        Me.cmdCancel.Enabled = True
        Me.cmdCancel.Visible = True
        With rs
            If Not (.BOF And .EOF) Then
                .MoveFirst
                Do Until .EOF
                    If Not bContinue Then
                        lngTotal = i
                        Exit Do
                    End If
                    If i Mod 10 = 0 Then
                        Me.lblStatus.Caption = "Processing photo " & _
                            i & " of " & lngTotal
                        Me.Repaint
                    End If
                    UpdateSinglePhoto !ImageID
                    i = i + 1
                    DoEvents
                    .MoveNext
                Loop
            End If
            .Close
        End With
        strMsg = lngTotal & " photo records updated."
        If Not bContinue Then
            strMsg = strMsg & vbNewLine & vbNewLine & _
                "Use the 'Resume Updating...' task to " & _
                "continue processing photos." & vbNewLine & _
                vbNewLine & "Do not use the Photo ID form " & _
                "or import modules until all photos are updated."
        End If

    Case 4
        strSQL = "UPDATE Photos INNER JOIN Detections ON " & _
            "Photos.ImageID = Detections.ImageID " & _
            "SET Photos.NeedsUpdate = True " & _
            "WHERE (((Detections.StatusID)=3))"
        db.Execute strSQL
        strSQL = "UPDATE Detections SET StatusID=1 " & _
            "WHERE StatusID=3"
        db.Execute strSQL
        strMsg = db.RecordsAffected & " deleted IDs restored."
        UpdateFlags

    Case 5
        strSQL = "DELETE * FROM IndependentDetections"
        db.Execute strSQL
        strMsg = db.RecordsAffected & " independent detections deleted."

    Case 6
        strSQL = "UPDATE CameraLocations " & _
            "SET [LatitudeDD] = UTMToLatDec([UTM_E], [UTM_N], [UTMDatum], " & _
            "[UTMZone], Nz([UTMHemisphere],'N')), [LongitudeDD] = UTMToLonDec(" & _
            "[UTM_E], [UTM_N], [UTMDatum], [UTMZone], Nz([UTMHemisphere],'N')) " & _
            "WHERE ((([UTM_E]) Is Not Null) And " & _
            "(([UTM_N]) Is Not Null) And " & _
            "(([UTMDatum]) Is Not Null) And " & _
            "(([UTMZone]) Is Not Null))"
        db.Execute strSQL
        strMsg = "Coordinates for " & db.RecordsAffected & _
            " locations updated."

    Case 7
        strSQL = "UPDATE CameraLocations " & _
            "SET [UTM_E] = LLDecToUTME([LatitudeDD], [LongitudeDD], " & _
            Me.UTMDatum & ", 0), [UTM_N] = LLDecToUTMN([LatitudeDD], " & _
            "[LongitudeDD], " & Me.UTMDatum & ", 0), [UTMZone] = " & _
            "GetDefaultZone([LongitudeDD]), [UTMDatum] = " & Me.UTMDatum & _
            " WHERE ((([LatitudeDD]) Is Not Null) And " & _
            "(([LongitudeDD]) Is Not Null))"
        db.Execute strSQL
        strMsg = "Coordinates for " & db.RecordsAffected & _
            " locations updated."

    Case 8
        strSQL = "UPDATE CameraLocations " & _
            "SET [UTM_E] = UTMToUTME([UTM_E], [UTM_N], [UTMDatum], " & _
            Me.UTMDatum & ", [UTMZone], " & Me.UTMZone & _
            ", Nz([UTMHemisphere], 'N')), [UTM_N] = UTMToUTMN(" & _
            "[UTM_E], [UTM_N], [UTMDatum], " & _
            Me.UTMDatum & ", [UTMZone], " & Me.UTMZone & _
            ", Nz([UTMHemisphere], 'N')), [UTMZone] = " & Me.UTMZone & _
            ", [UTMDatum] = " & Me.UTMDatum & _
            " WHERE ((([UTM_E]) Is Not Null) And " & _
            "(([UTM_N]) Is Not Null) And " & _
            "(([UTMDatum]) Is Not Null) And " & _
            "(([UTMZone]) <> " & Me.UTMZone & "))"
        db.Execute strSQL
        strMsg = "Coordinates for " & db.RecordsAffected & _
            " locations updated."

    Case 9
        Me.cmdGo.Visible = False
        Me.lblStatus.Width = Me.InsideWidth
        Me.lblStatus.Visible = True
        DoCmd.OpenForm "ImportData", , , , , acHidden, Me.txtSourceDB
        Do Until Me.lblStatus.Caption = "Data import complete."
            DoEvents
        Loop
        DoCmd.Close acForm, "ImportData"
        strSQL = "DELETE * FROM lkupMaintenanceTasks WHERE TaskID = 9"
        db.Execute strSQL
        strMsg = "Welcome to the latest version of CPW Photo Warehouse." & _
            vbNewLine & vbNewLine & "Before you begin using the new " & _
            "database you should compact and repair it, then return to " & _
            "the maintenance form and run the tasks to update the visits " & _
            "table and update photo flags."

End Select

'Confirm procedure
MsgBox strMsg

'Enable controls
LockForm False

CGExit:
    On Error Resume Next
    Me.txtFocus.SetFocus
    Me.lblStatus.Visible = False
    Me.lblStatus.Caption = "Initializing..."
    Me.lblStatus.Width = 5760
    Me.cmdGo.Visible = True
    Me.cmdCancel.Enabled = False
    Me.cmdCancel.Visible = False
    Set rs = Nothing
    Set db = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description
    Resume CGExit

End Sub

Private Sub Form_Load()
'Show task description if one is selected

ShowDescription

End Sub

Private Sub TaskID_AfterUpdate()
'Show task description and enable button

ShowDescription
ShowControls
EnableGo

End Sub

Private Sub txtSourceDB_AfterUpdate()

EnableGo

End Sub

Private Sub UTMDatum_AfterUpdate()

EnableGo

End Sub

Private Sub UTMZone_AfterUpdate()

EnableGo

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub EnableGo()

On Error GoTo ErrHandler

Select Case Nz(Me.TaskID, 0)

    Case 0
        Me.cmdGo.Enabled = False

    Case 1 To 6
        Me.cmdGo.Enabled = True

    Case 7
        Me.cmdGo.Enabled = Not IsNull(Me.UTMDatum)

    Case 8
        Me.cmdGo.Enabled = Not (IsNull(Me.UTMDatum) Or _
            IsNull(Me.UTMZone))

    Case 9
        Me.cmdGo.Enabled = Not IsNull(Me.txtSourceDB)

End Select

Exit Sub

ErrHandler:
    If Err.Number = 2164 Then
        Me.txtFocus.SetFocus
        Resume
    Else
        Exit Sub
    End If

End Sub

Private Sub LockForm(bLocked As Boolean)
'Lock or unlock the maintenance form

On Error GoTo ErrHandler

'Set up form controls
Me.txtFocus.SetFocus
Me.cmdGo.Enabled = False
Me.UTMZone.Enabled = Not bLocked
Me.UTMDatum.Enabled = Not bLocked
Me.txtSourceDB.Enabled = Not bLocked
Me.cmdBrowseSourceDB.Enabled = Not bLocked
Me.cmdCancel.Enabled = bLocked And (Nz(Me.TaskID, 0) = 2)
Me.TaskID.Enabled = Not bLocked
If Not bLocked Then
    Me.TaskID = Null
    Me.UTMZone.Visible = False
    Me.UTMDatum.Visible = False
    Me.txtSourceDB.Visible = False
    Me.txtSourceDBReqd.Visible = False
    Me.cmdBrowseSourceDB.Visible = False
End If

'Set other indicators
AccessCloseButtonEnabled Not bLocked
'DoCmd.Hourglass bLocked
DoCmd.SetWarnings Not bLocked
DoEvents

Exit Sub

ErrHandler:
    On Error Resume Next
    DoCmd.SetWarnings True
    AccessCloseButtonEnabled True
    DoCmd.Hourglass False

End Sub

Private Sub ShowControls()

On Error GoTo ErrHandler

Me.UTMDatum.Visible = (Me.TaskID = 7) Or (Me.TaskID = 8)
Me.txtDatumReqd.Visible = (Me.TaskID = 7) Or (Me.TaskID = 8)
Me.UTMZone.Visible = (Me.TaskID = 8)
Me.txtZoneReqd.Visible = (Me.TaskID = 8)
Me.txtSourceDB.Visible = (Me.TaskID = 9)
Me.txtSourceDBReqd.Visible = (Me.TaskID = 9)
Me.cmdBrowseSourceDB.Visible = (Me.TaskID = 9)

Exit Sub

ErrHandler:
    If Err.Number = 2164 Then
        Me.TaskID.SetFocus
        Resume
    Else
        Exit Sub
    End If

End Sub

Private Sub ShowDescription()
'Show guidance text

Select Case Me.TaskID

    Case 1
        Me.lblDescription.Caption = _
            "Select this option to recalculate which " & _
            "check and pull visits are associated with " & _
            "each set visit.  " & _
            "Normally this happens automatically when you " & _
            "enter or edit visits through the visits form, " & _
            "but you may need to run this task if you've " & _
            "experienced problems with the form or have " & _
            "added data directly to the Visits table."

    Case 2
        Me.lblDescription.Caption = _
            "Running this task will analyze the IDs for all " & _
            "the photos in your database to update which ones " & _
            "need to be compared, which have multiple species, " & _
            "how many observers have looked at each, etc.  " & _
            "Usually these flags are updated for affected photos " & _
            "whenever you use the PhotoID form or import a module.  " & _
            "Updating all the flags at once through this form will " & _
            "take a LONG time (several hours)."

    Case 3
        Me.lblDescription.Caption = _
            "Select this option to continue where you left off " & _
            "if you started the Update Flags task but cancelled " & _
            "partway through."

    Case 4
        Me.lblDescription.Caption = _
            "If you've run into massive problems when comparing IDs " & _
            "and want to start from scratch use this task.  The IDs " & _
            "that were verified during comparison will remain that way, " & _
            "but all IDs that were deleted will be restored.  If you just " & _
            "need to reset a few photos you would be better off using the " & _
            "Edit Species ID button on the PhotoViewer form."

    Case 5
        Me.lblDescription.Caption = _
            "Select this option to clear all independent detection " & _
            "(sequence) data and start the Individual ID process from " & _
            "scratch.  Any Individual ID or summary information you've " & _
            "entered so far will be permanently deleted as well."

    Case 6
        Me.lblDescription.Caption = _
            "Run this task to populate the latitude and longitude " & _
            "fields in the CameraLocations table based on the data " & _
            "in the UTM fields.  Only locations with valid UTM data " & _
            "(including datum and zone) will be affected.  " & _
            "Existing Lat/Long data will be overwritten."

    Case 7
        Me.lblDescription.Caption = _
            "Run this task to populate the UTM fields in the " & _
            "CameraLocations table based on the data in the " & _
            "latitude and longitude fields.  Only locations with " & _
            "valid Lat/Long data will be affected.  " & _
            "Existing UTM data will be overwritten."

    Case 8
        Me.lblDescription.Caption = _
            "Run this task to convert all UTM coordinates to a specific " & _
            "Zone.  This makes it easier to view your data in mapping " & _
            "software such as ArcMap.  Only locations with valid UTM data " & _
            "(including datum and zone) will be affected.  " & _
            "You should only use this to combine data from adjacent zones.  " & _
            "Existing UTM data will be overwritten."
    Case 9
        Me.lblDescription.Caption = _
            "Use this option to import data from an older version of CPW " & _
            "Photo Warehouse.  This may take a long time depending on the " & _
            "number of photos in the older database."

    Case Else
        Me.lblDescription.Caption = ""

End Select

End Sub
