Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    ViewsAllowed =1
    TabularCharSet =204
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    DatasheetFontHeight =11
    ItemSuffix =19
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    OnUnload ="[Event Procedure]"
    BeforeDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0x87e397552c55e440
    End
    OnDirty ="[Event Procedure]"
    RecordSource ="DetailsRecSource"
    Caption ="DetectionDetails"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =204
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =1027
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    TextFontFamily =34
                    Left =360
                    Top =720
                    Width =2820
                    Height =285
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =16252927
                    Name ="SpeciesID_Label"
                    Caption ="Species"
                    FontName ="Franklin Gothic Book"
                    Tag ="DetachedLabel"
                    ColumnGroup =1
                    GroupTable =1
                    GridlineColor =0
                    LayoutCachedLeft =360
                    LayoutCachedTop =720
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =1005
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =3255
                    Top =720
                    Width =2265
                    Height =285
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =16252927
                    Name ="DetailText_Label"
                    Caption ="Detail"
                    FontName ="Franklin Gothic Book"
                    Tag ="DetachedLabel"
                    ColumnGroup =2
                    GroupTable =1
                    GridlineColor =0
                    LayoutCachedLeft =3255
                    LayoutCachedTop =720
                    LayoutCachedWidth =5520
                    LayoutCachedHeight =1005
                End
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =3945
                    Height =600
                    FontSize =20
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Label8"
                    Caption ="Detection Details List"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =4005
                    LayoutCachedHeight =660
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =5595
                    Top =720
                    Width =825
                    Height =285
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =16252927
                    Name ="Shortcut_Label"
                    Caption ="Shortcut"
                    FontName ="Franklin Gothic Book"
                    ColumnGroup =3
                    GroupTable =1
                    GridlineColor =0
                    LayoutCachedLeft =5595
                    LayoutCachedTop =720
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =1005
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =6720
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =6720
                    LayoutCachedTop =120
                    LayoutCachedWidth =7086
                    LayoutCachedHeight =486
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =1080
                    Top =720
                    Width =180
                    Height =285
                    BackColor =6108695
                    ForeColor =2366701
                    Name ="lblSpeciesReqd"
                    Caption ="*"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =1080
                    LayoutCachedTop =720
                    LayoutCachedWidth =1260
                    LayoutCachedHeight =1005
                End
            End
        End
        Begin Section
            Height =420
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3255
                    Top =60
                    Width =2265
                    Height =315
                    ColumnWidth =3000
                    TabIndex =1
                    BorderColor =7169897
                    Name ="DetailText"
                    ControlSource ="DetailText"
                    ColumnGroup =2
                    GroupTable =1

                    LayoutCachedLeft =3255
                    LayoutCachedTop =60
                    LayoutCachedWidth =5520
                    LayoutCachedHeight =375
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =5595
                    Top =60
                    Width =825
                    Height =315
                    TabIndex =2
                    BorderColor =7169897
                    Name ="Shortcut"
                    ControlSource ="Shortcut"
                    ColumnGroup =3
                    GroupTable =1

                    LayoutCachedLeft =5595
                    LayoutCachedTop =60
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =375
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =6480
                    Top =60
                    Width =660
                    Height =313
                    TabIndex =3
                    Name ="cmdDelete"
                    Caption ="Command17"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000020202030000800900000004000080010 ,
                        0x0000000000000000000000000000000000000000000000000000000000000010 ,
                        0x0000000000000000000000001010100010181080101010ff202020c010081020 ,
                        0x1010100000000000000000000000000000000000101010004038309010101030 ,
                        0x3030200000000000000000000000000020202050201810ff302820ff30282080 ,
                        0x100810100000000000000000000000000008000030282020202820e010101020 ,
                        0x3030200000000000000000000000000040303010202020a0201820f0303030e0 ,
                        0x3030303000000000000000001010101010081010303030d02020209020202000 ,
                        0x000000000000000000000000000000000000000030283020202020d0202020ff ,
                        0x303030c020182010101010101010101020202090303030f03028202000000000 ,
                        0x00000000000000000000000000000000000000000000000030303020302820d0 ,
                        0x302820ff302830b020181030202020b0303030ff302820700000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000030383020 ,
                        0x302820d0303030ff303030ff403830ff302830e0000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x30303040303030ff403840ff303030e030202010000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000004040400040404030 ,
                        0x404040d0403830ff303030f0303030f0302820b0302820100000000000000000 ,
                        0x00000000000000000000000000000000000000004040400040404070404040ff ,
                        0x404040ff505050a04038403040384090404040ff303030903028201000000000 ,
                        0x0000000000000000000000004040402040404040404040b0404040ff404040ff ,
                        0x505050b0505050100000000040383010504840b0404040ff3038309030303010 ,
                        0x00000000000000004040400040404060404040b0403830ff404040ff50485080 ,
                        0x504850000000000000000000000000003028201040404040504850f0404040a0 ,
                        0x00000000000000004040400040484060404040ff404040f05048505050505000 ,
                        0x0000000000000000000000000000000000000000404040005050502040484070 ,
                        0x00000000000000000000000050485030504850c0504850405048500000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =6480
                    LayoutCachedTop =60
                    LayoutCachedWidth =7140
                    LayoutCachedHeight =373
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =360
                    Top =60
                    Width =2820
                    Height =315
                    ColumnWidth =3000
                    BorderColor =7169897
                    Name ="SpeciesID"
                    ControlSource ="SpeciesID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, Species.CommonName FROM Species ORDER BY Species.Commo"
                        "nName;"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    ColumnGroup =1
                    GroupTable =1

                    LayoutCachedLeft =360
                    LayoutCachedTop =60
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =375
                End
            End
        End
        Begin FormFooter
            Height =1020
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2220
                    Top =60
                    Width =2760
                    Height =480
                    Name ="cmdDone"
                    Caption ="Done"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =2220
                    LayoutCachedTop =60
                    LayoutCachedWidth =4980
                    LayoutCachedHeight =540
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2520
                    Top =600
                    Width =2160
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =2520
                    LayoutCachedTop =600
                    LayoutCachedWidth =4680
                    LayoutCachedHeight =960
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The Details form encountered an error."

Private Sub cmdCancel_Click()
'Quit out of adding new detail

On Error GoTo ErrHandler

Me.Undo
DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdDelete_Click()
'Prompts to make sure the user wants to delete,
'and enables merging two details

Dim lngDeleteID As Long
Dim lngNextID As Long

On Error GoTo ErrHandler

If Me.Dirty = True Then
    Me.Undo
    Exit Sub
End If

'Prompt to confirm
If MsgBox("Are you sure you want to delete this record?", _
    vbOKCancel) = vbOK Then
    'Suppress warnings
    DoCmd.SetWarnings False
    'Get current record's ID
    lngDeleteID = Me.DetailID
    'Check for IDs
    If DCount("*", "Detections", "DetailID=" & lngDeleteID) > 0 Then
        'Prompt to merge
        If MsgBox("Do you want to switch IDs with this detail to a " & _
            "remaining detail in the list?", vbYesNo) = vbYes Then
            'Open merge form
            DoCmd.OpenForm "MergeDetails", , , "DetailID=" & _
                lngDeleteID, , acDialog
            'Suppress warnings again - MergeSpecies restored them
            DoCmd.SetWarnings False
            'Check for IDs again
            If DCount("*", "Detections", "DetailID=" & lngDeleteID) > 0 Then
                'Prompt again if there are still IDs for this species
                If MsgBox("You canceled the merge operation." & vbNewLine & _
                    vbNewLine & "Do you still want to delete this detail " & _
                    "from the list?", vbOKCancel) = vbCancel Then
                    GoTo DeleteExit
                End If
            End If
        Else
            'Clear detail from IDs
            DoCmd.RunSQL "UPDATE Detections SET Detections.DetailID " & _
                "= Null WHERE (((DetailID)=" & lngDeleteID & "))"
        End If
    End If
    'Delete shortcut for this species
    DoCmd.RunSQL "DELETE * FROM DetailShortcuts WHERE DetailID=" & lngDeleteID
    'Find appropriate record to move to after delete
    Me.RecordsetClone.FindFirst "DetailID=" & lngDeleteID
    Me.RecordsetClone.MoveNext
    If Me.RecordsetClone.EOF Then
        Me.RecordsetClone.MovePrevious
        Me.RecordsetClone.MovePrevious
    End If
    If Not Me.RecordsetClone.BOF Then
        lngNextID = Me.RecordsetClone!DetailID
    Else
        lngNextID = 0
    End If
    'Delete species
    DoCmd.RunSQL "DELETE * FROM DetectionDetails WHERE DetailID=" & lngDeleteID
    'Scroll to appropriate record
    Me.Requery
    On Error Resume Next
    Me.RecordsetClone.FindFirst "DetailID=" & lngNextID
    Me.Bookmark = Me.RecordsetClone.Bookmark
End If

DeleteExit:
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg "There was an error deleting the record.", Err.Number, _
        Err.Description
    Resume DeleteExit

End Sub

Private Sub cmdDone_Click()
'Close the form

On Error GoTo ErrHandler

DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "Species List"

End Sub

Private Sub Form_BeforeDelConfirm(Cancel As Integer, Response As Integer)
'Suppress system delete message

On Error GoTo ErrHandler

Cancel = False

Response = acDataErrContinue
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Current()
'Disable cancel button unless coming from
'PhotoID form

On Error GoTo ErrHandler

If Not Me.DetailText = Me.OpenArgs Then
    Me.cmdCancel.Enabled = False
End If

Me.lblSpeciesReqd.Visible = IsNull(Me.SpeciesID)
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Dirty(Cancel As Integer)
'Enable cancel button to undo edit/add

On Error GoTo ErrHandler

Me.cmdCancel.Enabled = True
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Open(Cancel As Integer)
'Populates new record based on OpenArgs property
'and sets window size

Dim strTest As String

On Error GoTo ErrHandler

'Add species from PhotoID form and display message
If Len(Me.OpenArgs) > 0 Then
    DoCmd.GoToRecord , , acNewRec
    Me.SpeciesID = Left(Me.OpenArgs, InStr(1, Me.OpenArgs, ";") - 1)
    Me.DetailText = Mid(Me.OpenArgs, InStr(1, Me.OpenArgs, ";") + 1)
    Me.cmdCancel.Enabled = True
    Me.cmdDelete.Enabled = False
    MsgBox "The detail you added appears at the bottom of the form." & vbNewLine & _
        "Please look over the list to make sure it isn't" & vbNewLine & _
        "already represented." & vbNewLine & vbNewLine & _
        "If you don't want to add this detail, press cancel."
End If

'Set form size
Me.InsideHeight = Me.Section(acHeader).Height + Me.Section(acFooter).Height + _
    18 * Me.Detail.Height

'Check if MergeDetails form is present, hide delete button if not
'No merge detail form in Photo ID modules
On Error Resume Next
strTest = Application.CurrentProject.AllForms("MergeDetails").Name
Me.cmdDelete.Visible = (strTest = "MergeDetails")

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub Form_Unload(Cancel As Integer)
'Prevent closing the form if there are duplicate shortcuts

Dim strSQL As String
Dim db As Database
Dim rs As DAO.Recordset

On Error GoTo ErrHandler

'Delete empty shortcuts
DoCmd.SetWarnings False
strSQL = "DELETE * FROM DetailShortcuts WHERE (((Shortcut) Is Null));"
DoCmd.RunSQL strSQL

'Check for duplicates
Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT Count(DetailID) As Num, " & _
    "Shortcut, SpeciesID FROM DetailsRecSource WHERE (((Shortcut) " & _
    "Is Not Null)) GROUP BY Shortcut, SpeciesID ORDER BY Count(DetailID);")
If rs.RecordCount > 0 Then
    rs.MoveLast
    If rs!Num > 1 Then
        'Duplicates found, cancel closing the form
        MsgBox "Duplicate detail shortcut keys found." & vbNewLine & _
            "Please correct them before exiting.", , "Duplicates"
        Cancel = True
    End If
End If

UnloadExit:
    DoCmd.SetWarnings True
    If Not rs Is Nothing Then
        rs.Close
        Set rs = Nothing
    End If
    Set db = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred checking for duplicate shortcuts.", _
        Err.Number, Err.Description
    Resume UnloadExit

End Sub

Private Sub SpeciesID_AfterUpdate()
'Show star if species is blank

On Error GoTo ErrHandler

Me.lblSpeciesReqd.Visible = IsNull(Me.SpeciesID)
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub
