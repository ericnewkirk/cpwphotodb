Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =9360
    DatasheetFontHeight =11
    ItemSuffix =55
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0x889c6f9a77e9e340
    End
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            AutoHeight =1
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =2775
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Delete Visit"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =3075
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8880
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =8880
                    LayoutCachedTop =120
                    LayoutCachedWidth =9246
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            Height =2580
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin OptionGroup
                    BackStyle =0
                    OldBorderStyle =0
                    OverlapFlags =93
                    Left =300
                    Top =840
                    Width =8102
                    Height =1618
                    Name ="optDelete"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"

                    LayoutCachedLeft =300
                    LayoutCachedTop =840
                    LayoutCachedWidth =8402
                    LayoutCachedHeight =2458
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =420
                            Top =720
                            Width =1755
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="optDelete_Label"
                            Caption ="Select an option:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.125/.1979"
                            LayoutCachedLeft =420
                            LayoutCachedTop =720
                            LayoutCachedWidth =2175
                            LayoutCachedHeight =1005
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =486
                            Top =1078
                            OptionValue =1
                            Name ="Option39"
                            Tag ="2: 1.3736/.1667"
                            LayoutCachedLeft =486
                            LayoutCachedTop =1078
                            LayoutCachedWidth =746
                            LayoutCachedHeight =1318
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =720
                                    Top =1050
                                    Width =4695
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label40"
                                    Caption ="Delete the records for the photos, but keep the jpg files"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="2: 1.3542/.1979"
                                    LayoutCachedLeft =720
                                    LayoutCachedTop =1050
                                    LayoutCachedWidth =5415
                                    LayoutCachedHeight =1335
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =486
                            Top =1408
                            OptionValue =2
                            Name ="Option41"
                            Tag ="2: 1.6028/.1667"
                            LayoutCachedLeft =486
                            LayoutCachedTop =1408
                            LayoutCachedWidth =746
                            LayoutCachedHeight =1648
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =720
                                    Top =1380
                                    Width =2595
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label42"
                                    Caption ="Delete records and jpg files"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="2: 1.5833/.1979"
                                    LayoutCachedLeft =720
                                    LayoutCachedTop =1380
                                    LayoutCachedWidth =3315
                                    LayoutCachedHeight =1665
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =486
                            Top =1738
                            OptionValue =3
                            Name ="Option43"
                            Tag ="2: 1.8319/.1667"
                            LayoutCachedLeft =486
                            LayoutCachedTop =1738
                            LayoutCachedWidth =746
                            LayoutCachedHeight =1978
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =720
                                    Top =1710
                                    Width =3195
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label44"
                                    Caption ="Assign the photos to a different visit:"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="2: 1.8125/.1979"
                                    LayoutCachedLeft =720
                                    LayoutCachedTop =1710
                                    LayoutCachedWidth =3915
                                    LayoutCachedHeight =1995
                                End
                            End
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =7860
                    Width =0
                    Height =0
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtFocus"

                    LayoutCachedLeft =7860
                    LayoutCachedWidth =7860
                End
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =300
                    Top =120
                    Width =5520
                    Height =480
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="Label54"
                    Caption ="There are photos associated with the visit you chose to delete.  What do you wan"
                        "t to do with the photos?"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =300
                    LayoutCachedTop =120
                    LayoutCachedWidth =5820
                    LayoutCachedHeight =600
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =223
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =4
                    Left =840
                    Top =2040
                    Width =7200
                    Height =315
                    TabIndex =1
                    BorderColor =7169897
                    Name ="cboVisit"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Visits.VisitID, [StudyAreas].[StudyAreaAbbr] & \" - \" & [CameraLocations"
                        "].[LocationName] AS Location, Visits.VisitDate AS [Visit Date], lkupVisitTypes.V"
                        "isitType AS [Visit Type] FROM lkupVisitTypes INNER JOIN ((StudyAreas INNER JOIN "
                        "CameraLocations ON StudyAreas.StudyAreaID = CameraLocations.StudyAreaID) INNER J"
                        "OIN Visits ON CameraLocations.LocationID = Visits.LocationID) ON lkupVisitTypes."
                        "ID = Visits.VisitTypeID WHERE (((Visits.VisitID)<>[Forms]![Visits]![VisitsSubfor"
                        "m]![VisitID]) AND ((Visits.VisitTypeID)<3)) ORDER BY [StudyAreas].[StudyAreaAbbr"
                        "] & \" - \" & [CameraLocations].[LocationName], Visits.VisitDate;"
                    ColumnWidths ="0;2880;1440;1080"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =840
                    LayoutCachedTop =2040
                    LayoutCachedWidth =8040
                    LayoutCachedHeight =2355
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =853
                    Top =2054
                    Width =6480
                    Height =288
                    TabIndex =3
                    BorderColor =7169897
                    Name ="txtVisitInfo"
                    ControlSource ="=[cboVisit].[Column](1) & \"     \" & [cboVisit].[Column](2) & \"     (\" & [cbo"
                        "Visit].[Column](3) & \")\""
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =853
                    LayoutCachedTop =2054
                    LayoutCachedWidth =7333
                    LayoutCachedHeight =2342
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    BackStyle =0
                    IMESentenceMode =3
                    Left =8099
                    Top =2040
                    Width =180
                    Height =315
                    TabIndex =4
                    ForeColor =2366701
                    Name ="txtVisitReqd"
                    ControlSource ="=IIf([cboVisit] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =8099
                    LayoutCachedTop =2040
                    LayoutCachedWidth =8279
                    LayoutCachedHeight =2355
                End
            End
        End
        Begin FormFooter
            Height =660
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =3840
                    Top =120
                    Width =1920
                    Height =420
                    Name ="cmdDelete"
                    Caption ="Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3840
                    LayoutCachedTop =120
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =540
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =6720
                    Top =120
                    Width =1920
                    Height =420
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6720
                    LayoutCachedTop =120
                    LayoutCachedWidth =8640
                    LayoutCachedHeight =540
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =215
                    TextAlign =2
                    TextFontFamily =34
                    Width =9360
                    Height =660
                    FontSize =14
                    TopMargin =115
                    BackColor =6108695
                    BorderColor =0
                    ForeColor =-2147483608
                    Name ="lblStatus"
                    Caption ="Initializing..."
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedWidth =9360
                    LayoutCachedHeight =660
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The DeletePhotos form encountered an error."

Private Sub cboVisit_AfterUpdate()
'Show info box and enable button

Me.cmdDelete.Enabled = Not IsNull(Me.cboVisit)
Me.txtVisitInfo.Visible = Not IsNull(Me.cboVisit)
Me.optDelete.SetFocus

End Sub

Private Sub cmdCancel_Click()
'Just close the form when cancel button is clicked

On Error GoTo ErrHandler

DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdDelete_Click()
'Delete files, records, or both

Dim lngTotal As Long
Dim strMsg As String

On Error GoTo ErrHandler

lngTotal = DCount("*", "Photos", "VisitID=" & Me.OpenArgs)

'Prompt for confirmation
Select Case Me.optDelete
    Case 1
        strMsg = " photo records"
    Case 2
        strMsg = "records and jpg files"
    Case 3
        strMsg = "photos"
End Select
strMsg = lngTotal & " " & strMsg & " associated with " & _
    vbNewLine & "this visit will be deleted." & _
    vbNewLine & vbNewLine & "Are you sure you want to " & _
    "continue?"
If Me.optDelete = 3 Then
    strMsg = Replace(strMsg, "deleted", "transferred")
End If
If MsgBox(strMsg, vbOKCancel + vbExclamation, "Ready to Delete") = vbCancel Then
    MsgBox "Delete operation canceled."
    GoTo DeleteExit
End If

'Prevent changes while code is running and show status
Me.txtFocus.SetFocus
AccessCloseButtonEnabled False
Me.cmdDelete.Enabled = False
Me.cmdCancel.Enabled = False
Me.optDelete.Enabled = False
Me.cboVisit.Enabled = False
Me.txtVisitInfo.Enabled = False
Me.Repaint
DoEvents

'Delete/transfer files and/or records
DoCmd.SetWarnings False
If Me.optDelete = 2 Then
    DeleteFiles lngTotal
End If
If Me.optDelete = 3 Then
    TransferPhotos
End If
DeleteRecords

DeleteExit:
    AccessCloseButtonEnabled True
    DoCmd.SetWarnings True
    DoCmd.Close acForm, "DeleteVisitPhotos", acSaveNo
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred while deleting the photos." & _
        vbNewLine & "Please double check your settings and try again." & _
        vbNewLine & vbNewLine & _
        "If the error occurred partway through the procedure," & _
        vbNewLine & "it may be necessary to clean up some files or data.", _
        Err.Number, Err.Description
    Resume DeleteExit

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, Me.Name & " Form Help"

End Sub

Private Sub Form_Open(Cancel As Integer)
'Cancels opening the form if not called from photoviewer

On Error GoTo ErrHandler

If Not IsLoaded("Visits") Then
    Cancel = True
    MsgBox "This form can only be opened using the delete " & _
        "button on the Visits form", vbExclamation, "Canceled"
Else
    Cancel = False
End If
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub optDelete_AfterUpdate()
'Show visit selection box

Me.cboVisit.Enabled = (Me.optDelete = 3)
Me.txtVisitReqd.Visible = (Me.optDelete = 3)
Me.txtVisitInfo.Enabled = (Me.optDelete = 3)
Me.cmdDelete.Enabled = Me.optDelete < 3 Or Not IsNull(Me.cboVisit)

End Sub

Private Sub txtVisitInfo_GotFocus()

On Error Resume Next

Me.cboVisit.SetFocus
Me.cboVisit.Dropdown

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub DeleteFiles(lngCount As Long)
'Delete jpg files for this visit

Dim db As Database
Dim rs As DAO.Recordset
Dim fso As Object
Dim lngCurrent As Long

Me.lblStatus.Visible = True

'Get records
Set db = CurrentDb
Set rs = db.OpenRecordset("SELECT * FROM Photos WHERE VisitID=" & _
    Me.OpenArgs)
Set fso = CreateObject("scripting.FileSystemObject")

rs.MoveFirst
lngCurrent = 0
'Delete files
Do Until rs.EOF
    lngCurrent = lngCurrent + 1
    Me.lblStatus.Caption = "Deleting file " & lngCurrent & _
        " of " & lngCount
    DoEvents
    fso.DeleteFile rs!FilePath & rs!FileName
    rs.MoveNext
Loop
rs.Close

MsgBox lngCount & " jpg files successfully deleted."

'Clean up
Set fso = Nothing
Set rs = Nothing
Set db = Nothing

End Sub

Private Sub DeleteRecords()
'Delete records for the visit

Dim strSQL As String

strSQL = "DELETE * FROM Visits WHERE VisitID=" & Me.OpenArgs
DoCmd.RunSQL strSQL

End Sub

Private Sub TransferPhotos()
'Change photos to a different visit

Dim strSQL As String

strSQL = "UPDATE Photos SET Photos.VisitID = " & Me.cboVisit & _
    " WHERE (((Photos.VisitID)=" & Me.OpenArgs & "));"
DoCmd.RunSQL strSQL

strSQL = "UPDATE Visits SET Visits.ActiveStart = " & _
    "DMin('ImageDate','Photos','VisitID=" & Me.cboVisit & _
    "'), Visits.ActiveEnd = DMax('ImageDate','Photos'," & _
    "'VisitID=" & Me.cboVisit & "') WHERE (((Visits.VisitID)=" & _
    Me.cboVisit & "));"
DoCmd.RunSQL strSQL

End Sub
