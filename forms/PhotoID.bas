Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    KeyPreview = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    AllowUpdating =2
    ScrollBars =2
    ViewsAllowed =1
    TabularCharSet =186
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =12600
    DatasheetFontHeight =11
    ItemSuffix =94
    Right =21015
    Bottom =12525
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0xe5eb941bcecbe440
    End
    RecordSource ="PhotoIDRecSource"
    Caption ="PhotoID"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    OnKeyDown ="[Event Procedure]"
    OnTimer ="[Event Procedure]"
    OnResize ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =186
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =480
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =1980
                    Width =1035
                    Height =435
                    FontSize =16
                    BackColor =6108695
                    ForeColor =-2147483608
                    Name ="Filters_Label"
                    Caption ="Filters:"
                    FontName ="Trebuchet MS"
                    LayoutCachedLeft =1980
                    LayoutCachedWidth =3015
                    LayoutCachedHeight =435
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =4080
                    Top =60
                    Width =3360
                    Height =315
                    BorderColor =7169897
                    Name ="cboLocationFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT CameraLocations.LocationID, First(StudyAreas.StudyAreaAbbr & \" - \" & Ca"
                        "meraLocations.LocationName) AS LocName FROM ((StudyAreas INNER JOIN CameraLocati"
                        "ons ON StudyAreas.StudyAreaID = CameraLocations.StudyAreaID) INNER JOIN (Visits "
                        "INNER JOIN Visits AS SetVisits ON Visits.SetVisitID = SetVisits.VisitID) ON Came"
                        "raLocations.LocationID = Visits.LocationID) INNER JOIN Photos ON Visits.VisitID "
                        "= Photos.VisitID GROUP BY CameraLocations.LocationID ORDER BY First(StudyAreas.S"
                        "tudyAreaAbbr & \" - \" & CameraLocations.LocationName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    ControlTipText ="Use to show only photos from a particular location"

                    LayoutCachedLeft =4080
                    LayoutCachedTop =60
                    LayoutCachedWidth =7440
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            TextFontFamily =34
                            Left =3165
                            Top =60
                            Width =885
                            Height =315
                            BackColor =6108695
                            ForeColor =16252927
                            Name ="cboLocationFilter_Label"
                            Caption ="Location:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =3165
                            LayoutCachedTop =60
                            LayoutCachedWidth =4050
                            LayoutCachedHeight =375
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =8415
                    Top =60
                    Height =315
                    TabIndex =1
                    BorderColor =7169897
                    Name ="cboSeasonFilter"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Year([SetVisits].[VisitDate]) AS FieldSeason FROM (Visits INNER JOIN Visi"
                        "ts AS SetVisits ON Visits.SetVisitID = SetVisits.VisitID) INNER JOIN Photos ON V"
                        "isits.VisitID = Photos.VisitID GROUP BY Year([SetVisits].[VisitDate])"
                    AfterUpdate ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"

                    LayoutCachedLeft =8415
                    LayoutCachedTop =60
                    LayoutCachedWidth =9855
                    LayoutCachedHeight =375
                    DatasheetCaption ="Use to show only photos from a certain year"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            TextFontFamily =34
                            Left =7500
                            Top =60
                            Width =885
                            Height =315
                            BackColor =6108695
                            ForeColor =16252927
                            Name ="cboSeasonFilter_Label"
                            Caption ="Season:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =7500
                            LayoutCachedTop =60
                            LayoutCachedWidth =8385
                            LayoutCachedHeight =375
                        End
                    End
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =12255
                    Top =60
                    Width =210
                    Height =315
                    TabIndex =2
                    Name ="chkNeedID"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Check to hide all photos that have a species assigned"

                    LayoutCachedLeft =12255
                    LayoutCachedTop =60
                    LayoutCachedWidth =12465
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            TextFontFamily =34
                            Left =9915
                            Top =60
                            Width =2310
                            Height =315
                            BackColor =6108695
                            ForeColor =16252927
                            Name ="chkNeedID_Label"
                            Caption ="Only images that need ID"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =9915
                            LayoutCachedTop =60
                            LayoutCachedWidth =12225
                            LayoutCachedHeight =375
                        End
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =11220
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin Subform
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =540
                    Top =9240
                    Width =8580
                    Height =1860
                    TabIndex =3
                    Name ="CamDetections Subform"
                    SourceObject ="Form.PhotoIDDetectionsSubform"
                    LinkChildFields ="ImageID"
                    LinkMasterFields ="ImageID"
                    OnEnter ="[Event Procedure]"
                    EventProcPrefix ="CamDetections_Subform"

                    LayoutCachedLeft =540
                    LayoutCachedTop =9240
                    LayoutCachedWidth =9120
                    LayoutCachedHeight =11100
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =11310
                    Top =9555
                    Width =720
                    Height =285
                    ColumnOrder =4
                    TabIndex =5
                    Name ="chkAdvance"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Check to advance the form on a timer like a slideshow"

                    LayoutCachedLeft =11310
                    LayoutCachedTop =9555
                    LayoutCachedWidth =12030
                    LayoutCachedHeight =9840
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =9180
                            Top =9555
                            Width =2100
                            Height =285
                            FontSize =9
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkAdvance_Label"
                            Caption ="Advance Automatically"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =9180
                            LayoutCachedTop =9555
                            LayoutCachedWidth =11280
                            LayoutCachedHeight =9840
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =11310
                    Top =9870
                    Width =720
                    Height =285
                    ColumnOrder =2
                    FontSize =9
                    TabIndex =6
                    BorderColor =7169897
                    Name ="txtSeconds"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Specify how long to display each photo before moving to the next"

                    LayoutCachedLeft =11310
                    LayoutCachedTop =9870
                    LayoutCachedWidth =12030
                    LayoutCachedHeight =10155
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =9180
                            Top =9870
                            Width =2100
                            Height =285
                            FontSize =9
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtSeconds_Label"
                            Caption ="Seconds per photo:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =9180
                            LayoutCachedTop =9870
                            LayoutCachedWidth =11280
                            LayoutCachedHeight =10155
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =11160
                    Top =10185
                    Width =900
                    Height =480
                    FontSize =9
                    TabIndex =9
                    Name ="cmdNext"
                    Caption ="Next"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Move to the next photo"

                    LayoutCachedLeft =11160
                    LayoutCachedTop =10185
                    LayoutCachedWidth =12060
                    LayoutCachedHeight =10665
                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =9180
                    Top =10185
                    Width =900
                    Height =480
                    FontSize =9
                    TabIndex =7
                    Name ="cmdPrev"
                    Caption ="Previous"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Move to the previous photo"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =9180
                    LayoutCachedTop =10185
                    LayoutCachedWidth =10080
                    LayoutCachedHeight =10665
                End
                Begin CommandButton
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =9180
                    Top =10695
                    Width =2880
                    Height =285
                    FontSize =9
                    TabIndex =10
                    Name ="cmdShortcuts"
                    Caption ="Keyboard Shortcuts"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Display a list of the available keyboard shortcuts"
                    BackStyle =0

                    LayoutCachedLeft =9180
                    LayoutCachedTop =10695
                    LayoutCachedWidth =12060
                    LayoutCachedHeight =10980
                End
                Begin TextBox
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    IMESentenceMode =3
                    Left =540
                    Top =60
                    Width =11516
                    Height =330
                    ColumnOrder =1
                    TabIndex =1
                    BorderColor =7169897
                    Name ="txtFileName"
                    ControlSource ="FileName"

                    LayoutCachedLeft =540
                    LayoutCachedTop =60
                    LayoutCachedWidth =12056
                    LayoutCachedHeight =390
                End
                Begin TextBox
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    ColumnOrder =0
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =12180
                    Top =60
                    Width =366
                    Height =366
                    TabIndex =2
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =12180
                    LayoutCachedTop =60
                    LayoutCachedWidth =12546
                    LayoutCachedHeight =426
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10170
                    Top =10185
                    Width =900
                    Height =480
                    FontSize =9
                    TabIndex =8
                    Name ="cmdBatch"
                    Caption ="Batch ID"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =10170
                    LayoutCachedTop =10185
                    LayoutCachedWidth =11070
                    LayoutCachedHeight =10665
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =11310
                    Top =9240
                    Width =720
                    Height =285
                    TabIndex =4
                    Name ="chkHighlightUnbound"
                    StatusBarText ="Used to mark high quality or interesting photos"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Used to mark high quality or interesting photos"

                    LayoutCachedLeft =11310
                    LayoutCachedTop =9240
                    LayoutCachedWidth =12030
                    LayoutCachedHeight =9525
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            TextFontFamily =34
                            Left =9180
                            Top =9240
                            Width =2100
                            Height =285
                            FontSize =9
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkHighlightUnbound_Label"
                            Caption ="Highlight"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =9180
                            LayoutCachedTop =9240
                            LayoutCachedWidth =11280
                            LayoutCachedHeight =9525
                        End
                    End
                End
                Begin Image
                    PictureType =1
                    Left =540
                    Top =480
                    Width =11516
                    Height =8636
                    Name ="CurrImage"
                    OnClick ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    OnMouseDown ="[Event Procedure]"
                    OnMouseUp ="[Event Procedure]"
                    ControlTipText ="Double-click to open jpeg file in Windows"
                    ControlSource ="ImgPath"

                    LayoutCachedLeft =540
                    LayoutCachedTop =480
                    LayoutCachedWidth =12056
                    LayoutCachedHeight =9116
                    TabIndex =11
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =2
                    TextFontFamily =34
                    Width =0
                    Height =0
                    FontSize =16
                    FontWeight =700
                    BorderColor =7169897
                    ForeColor =-2147483608
                    Name ="lblNotFound"
                    Caption ="Image not found"
                    FontName ="Franklin Gothic Book"
                End
                Begin Rectangle
                    Visible = NotDefault
                    BorderWidth =2
                    OverlapFlags =95
                    Width =0
                    Height =0
                    BorderColor =-2147483608
                    Name ="PhotoTag1"
                End
                Begin Rectangle
                    Visible = NotDefault
                    BorderWidth =2
                    OverlapFlags =95
                    Width =0
                    Height =0
                    BorderColor =-2147483608
                    Name ="PhotoTag2"
                End
                Begin Rectangle
                    Visible = NotDefault
                    BorderWidth =2
                    OverlapFlags =95
                    Width =0
                    Height =0
                    BorderColor =-2147483608
                    Name ="PhotoTag3"
                End
                Begin Rectangle
                    Visible = NotDefault
                    BorderWidth =2
                    OverlapFlags =95
                    Width =0
                    Height =0
                    BorderColor =-2147483608
                    Name ="PhotoTag4"
                End
                Begin Rectangle
                    Visible = NotDefault
                    BorderWidth =2
                    OverlapFlags =87
                    Width =0
                    Height =0
                    BorderColor =-2147483608
                    Name ="PhotoTag5"
                End
            End
        End
        Begin FormFooter
            CanGrow = NotDefault
            Height =318
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin Rectangle
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Width =12600
                    Height =300
                    BackColor =-2147483607
                    BorderColor =-2147483611
                    Name ="Box0"
                    GridlineColor =0
                    LayoutCachedWidth =12600
                    LayoutCachedHeight =300
                End
                Begin Rectangle
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =223
                    Top =144
                    Width =12600
                    Height =150
                    BackColor =-2147483606
                    BorderColor =-2147483611
                    Name ="Box1"
                    GridlineColor =0
                    LayoutCachedTop =144
                    LayoutCachedWidth =12600
                    LayoutCachedHeight =294
                End
                Begin Rectangle
                    OverlapFlags =223
                    Width =12600
                    Height =300
                    BackColor =-2147483607
                    BorderColor =-2147483611
                    Name ="Box2"
                    GridlineColor =0
                    LayoutCachedWidth =12600
                    LayoutCachedHeight =300
                End
                Begin Label
                    OverlapFlags =215
                    TextFontFamily =34
                    Width =780
                    Height =299
                    FontSize =11
                    BackColor =6108695
                    BorderColor =0
                    Name ="Label4"
                    Caption ="Record:"
                    FontName ="Franklin Gothic Book"
                    GridlineColor =0
                    LayoutCachedWidth =780
                    LayoutCachedHeight =299
                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =900
                    Top =30
                    Width =288
                    Height =288
                    FontSize =11
                    ForeColor =-2147483630
                    Name ="cmdNavBarFirst"
                    Caption ="Command5"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="First Record"
                    GridlineColor =0
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000d06840ff904820ff904820ff00000000 ,
                        0x000000000000000000000000b0482000b0482050000000000000000000000000 ,
                        0x00000000000000000000000000000000e06830ffe07850ff905030ff00000000 ,
                        0x000000000000000000000000b0502050904820ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e06830fff08850ffa05030ff00000000 ,
                        0x0000000000000000a0482040d06830ff905030ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e07040fff09060ffa05830ff00000000 ,
                        0x00000000b0502040d06030fff06820ffa05030ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e07840fff09070ffb06040ff00000000 ,
                        0xb0502050d06830fff07030fff06820ffa05830ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e07850fff09870ffb06840ffb0502050 ,
                        0xe07040ffffa060fff08850fff07030ffb06040ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e08050fff0a080ffc07040ffe08850ff ,
                        0xffc0a0ffffb090ffffa070ffff8040ffb06840ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e08860fff0a890ffd07850ffe0906040 ,
                        0xe08850ffffc0a0ffffb080ffff8850ffc07040ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e09060fff0b890ffd07850ffe0906000 ,
                        0xe0906040e08860ffffc0a0ffff9870ffd07850ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e09870fff0c0a0ffd08050ff00000000 ,
                        0xe0906000e0906040e08860ffffc0a0ffd07850ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e09870fff0c8b0ffe08850ff00000000 ,
                        0x00000000e0906000f0906030e08860ffd08050ff000000000000000000000000 ,
                        0x00000000000000000000000000000000e09870ffe0a080ffe08860f000000000 ,
                        0x0000000000000000e0906000f0906020e08850ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000e0906000e0906020000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000e0906000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =900
                    LayoutCachedTop =30
                    LayoutCachedWidth =1188
                    LayoutCachedHeight =318
                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =1200
                    Top =30
                    Width =288
                    Height =288
                    FontSize =11
                    TabIndex =1
                    ForeColor =-2147483630
                    Name ="cmdNavBarPrevious"
                    Caption ="Command5"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Previous Record"
                    GridlineColor =0
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000b0482000b0482050000000000000000000000000 ,
                        0x0000000000000000000000004068ff0000000000000000000000000000000000 ,
                        0x000000000000000000000000b0502050904820ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000a0482040d06830ff905030ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b0502040d06030fff06820ffa05030ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xb0502050d06830fff07030fff06820ffa05830ff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000b0502050 ,
                        0xe07040ffffa060fff08850fff07030ffb06040ff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000d0704040e08850ff ,
                        0xffc0a0ffffb090ffffa070ffff8040ffb06840ff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0906000e0906040 ,
                        0xe08850ffffc0a0ffffb080ffff8850ffc07040ff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e0906000 ,
                        0xe0906040e08860ffffc0a0ffff9870ffd07850ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xe0906000e0906040e08860ffffc0a0ffd07850ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000e0906000f0906030e08860ffd08050ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000e0906000f0906020e08850ff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000e0906000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =1200
                    LayoutCachedTop =30
                    LayoutCachedWidth =1488
                    LayoutCachedHeight =318
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =3000
                    Top =30
                    Width =288
                    Height =288
                    FontSize =11
                    TabIndex =2
                    ForeColor =-2147483630
                    Name ="cmdNavBarNext"
                    Caption ="Command5"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Next Record"
                    GridlineColor =0
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000b0482050 ,
                        0xb048200000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e06830ff ,
                        0xb050205000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e06830ff ,
                        0x904820ffa0482040000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e07040ff ,
                        0xd07040ff904820ffb05020400000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e07840ff ,
                        0xe08850ffd05820ff904820ffb050205000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e07850ff ,
                        0xf0a070fff07830ffd05820ff904820ffb0502050000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e08050ff ,
                        0xf0b080ffff9860fff07830ffd05820ffa05830ffd0704060e090600000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e08860ff ,
                        0xffb890ffffa870ffff9860ffd07040ffe0906040e09060000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e09060ff ,
                        0xffc0a0ffffb890ffd07840ffe0906040e0906000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xffc0a0ffe08050f0e0906040e090600000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xe08860fff0906030e09060000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xf0906020e0906000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e0906020 ,
                        0xe090600000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e0906000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =3000
                    LayoutCachedTop =30
                    LayoutCachedWidth =3288
                    LayoutCachedHeight =318
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =3300
                    Top =30
                    Width =288
                    Height =288
                    FontSize =11
                    TabIndex =3
                    ForeColor =-2147483630
                    Name ="cmdNavBarLast"
                    Caption ="Command5"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Last Record"
                    GridlineColor =0
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000b0482080 ,
                        0xb048200000000000000000000000000000000000d06840ff904820ff904820ff ,
                        0x00000000000000000000000000000000000000000000000000000000e06830ff ,
                        0xb050208000000000000000000000000000000000e06830ffe07850ff905030ff ,
                        0x00000000000000000000000000000000000000000000000000000000e06830ff ,
                        0x904820ffa0482070000000000000000000000000e06830fff08850ffa05030ff ,
                        0x00000000000000000000000000000000000000000000000000000000e07040ff ,
                        0xd07040ff904820ffb05020700000000000000000e07040fff09060ffa05830ff ,
                        0x00000000000000000000000000000000000000000000000000000000e07840ff ,
                        0xe08850ffd05820ff904820ffb050208000000000e07840fff09070ffb06040ff ,
                        0x00000000000000000000000000000000000000000000000000000000e07850ff ,
                        0xf0a070fff07830ffd05820ff904820ffb0502090e07850fff09870ffb06840ff ,
                        0x00000000000000000000000000000000000000000000000000000000e08050ff ,
                        0xf0b080ffff9860fff07830ffd05820ffa05830ffe08050fff0a080ffc07040ff ,
                        0x00000000000000000000000000000000000000000000000000000000e08860ff ,
                        0xffb890ffffa870ffff9860ffd07040ffe0906070e08860fff0a890ffd07850ff ,
                        0x00000000000000000000000000000000000000000000000000000000e09060ff ,
                        0xffc0a0ffffb890ffd07840ffe0906070e0906000e09060fff0b890ffd07850ff ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xffc0a0ffe08050ffe0906070e090600000000000e09870fff0c0a0ffd08050ff ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xe08860fff0906050e09060000000000000000000e09870fff0c8b0ffe08850ff ,
                        0x00000000000000000000000000000000000000000000000000000000e09870ff ,
                        0xf0906040e0906000000000000000000000000000e09870ffe0a080ffe08860f0 ,
                        0x00000000000000000000000000000000000000000000000000000000e0906030 ,
                        0xe090600000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000e0906000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =3300
                    LayoutCachedTop =30
                    LayoutCachedWidth =3588
                    LayoutCachedHeight =318
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =1500
                    Top =30
                    Width =1469
                    Height =245
                    ColumnOrder =1
                    FontSize =8
                    TabIndex =4
                    BorderColor =7169897
                    Name ="txtRecordNumber"
                    AfterUpdate ="[Event Procedure]"
                    OnEnter ="[Event Procedure]"
                    ControlTipText ="Enter a number to jump to a specific photo"
                    GridlineColor =0

                    LayoutCachedLeft =1500
                    LayoutCachedTop =30
                    LayoutCachedWidth =2969
                    LayoutCachedHeight =275
                End
                Begin Subform
                    CanGrow = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    OldBorderStyle =0
                    Left =9900
                    Width =2580
                    Height =299
                    TabIndex =5
                    Name ="CurrentObserverSubform"
                    SourceObject ="Form.CurrentObserverSubform"

                    LayoutCachedLeft =9900
                    LayoutCachedWidth =12480
                    LayoutCachedHeight =299
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =8700
                            Width =1170
                            Height =299
                            BackColor =6108695
                            Name ="CurrentObserverSubform_Label"
                            Caption ="Logged in as:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =8700
                            LayoutCachedWidth =9870
                            LayoutCachedHeight =299
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The PhotoID form encountered an error."
Private lngScreenHeight As Long
Private lngCount As Long
Private lngX As Long
Private lngY As Long
Private lngX2 As Long
Private lngY2 As Long
Private bTag As Boolean
Private lngTimer As Long

Private Sub CamDetections_Subform_Enter()
'Prevent highlighting the species every time form
'moves to a new record

On Error Resume Next

Me.CamDetections_Subform.Form.txtFocus.SetFocus

End Sub

Private Sub cboLocationFilter_AfterUpdate()
'Filter season dropdown list based on the location selected

On Error GoTo ErrHandler

Dim strNewRS As String

strNewRS = "SELECT Year([SetVisits].[VisitDate]) AS FieldSeason " & _
    "FROM (Visits INNER JOIN Visits AS SetVisits ON " & _
    "Visits.SetVisitID = SetVisits.VisitID) INNER JOIN " & _
    "Photos ON Visits.VisitID = Photos.VisitID " & _
    "GROUP BY Year([SetVisits].[VisitDate]);"

If Not IsNull(Me.cboLocationFilter) Then
    'Limit season row source to location selected
    strNewRS = Replace(strNewRS, "GROUP BY", _
        "WHERE (((Visits.LocationID) = " & Me.cboLocationFilter & _
        ")) GROUP BY")
End If

'Apply new row source
Me.cboSeasonFilter.RowSource = strNewRS

'Apply new filter
Call FilterUpdate

Exit Sub

ErrHandler:
    ErrorMsg "Filter failed.  Select a valid location and try again.", _
        Err.Number, Err.Description

End Sub

Private Sub cboLocationFilter_NotInList(NewData As String, Response As Integer)
'Prevent error message and reset the combobox to null

On Error Resume Next

Me.cboLocationFilter = Null

Response = acDataErrContinue

End Sub

Private Sub cboSeasonFilter_AfterUpdate()
'Filter location dropdown list based on the season selected

Dim strNewRS As String

On Error GoTo ErrHandler

'Set row source to unfiltered SQL statement
strNewRS = "SELECT CameraLocations.LocationID, " & _
    "First(StudyAreas.StudyAreaAbbr & ' - ' & " & _
    "CameraLocations.LocationName) AS LocName " & _
    "FROM (((StudyAreas INNER JOIN CameraLocations ON " & _
    "StudyAreas.StudyAreaID = CameraLocations.StudyAreaID) " & _
    "INNER JOIN Visits ON CameraLocations.LocationID = " & _
    "Visits.LocationID) INNER JOIN Photos ON Visits.VisitID = " & _
    "Photos.VisitID) INNER JOIN Visits AS SetVisits ON " & _
    "Visits.SetVisitID = SetVisits.VisitID " & _
    "GROUP BY CameraLocations.LocationID " & _
    "ORDER BY First(StudyAreas.StudyAreaAbbr & ' - ' & " & _
    "CameraLocations.LocationName);"

If Not IsNull(Me.cboSeasonFilter) Then
    'Limit location row source to reflect season selected
    strNewRS = Replace(strNewRS, "GROUP BY", "WHERE " & _
        "(((Year(SetVisits.VisitDate)) = " & Me.cboSeasonFilter & _
        ")) GROUP BY")
End If

'Apply new row source
Me.cboLocationFilter.RowSource = strNewRS

'Apply new filter
Call FilterUpdate

Exit Sub

ErrHandler:
    ErrorMsg "Filter failed.  Select a valid season and try again.", _
        Err.Number, Err.Description

End Sub

Private Sub cboSeasonFilter_NotInList(NewData As String, Response As Integer)
'Prevent error message and reset the combobox to null

On Error Resume Next

Me.cboSeasonFilter = Null

Response = acDataErrContinue

End Sub

Private Sub chkAdvance_AfterUpdate()
'Set timer interval to trigger ontimer event when box is checked

On Error GoTo ErrHandler

If Me.chkAdvance = True Then
    If IsNull(Me.txtSeconds) Then
        Me.txtSeconds = 2
    End If
    If IsNumeric(Me.txtSeconds) Then
        Me.TimerInterval = 1000 * Me.txtSeconds
    End If
    Me.txtSeconds.SetFocus
Else
    Me.TimerInterval = 0
    Me.txtFocus.SetFocus
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub chkHighlightUnbound_AfterUpdate()
'Update highlight field in photos table
'Has to be done in code from unbound control because
'underlying recordset is not updatable in compare mode
'or when filtered to images that need ID

Dim strSQL As String

On Error GoTo ErrHandler

'Run query to update highlight field
strSQL = "UPDATE Photos SET Highlight = " & _
    Me.chkHighlightUnbound & " WHERE ImageID=" & Me.ImageID
DoCmd.SetWarnings False
DoCmd.RunSQL strSQL
Me.txtFocus.SetFocus

HUExit:
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description
    Resume HUExit

End Sub

Private Sub chkNeedID_AfterUpdate()
'Call filterupdate to apply 'needs ID' filter
'Errors handled within FilterUpdate

'Apply new filter
Call FilterUpdate

End Sub

Private Sub cmdBatch_Click()
'Open batch ID form

Dim strSQL As String

'Save subform records
If Me.CamDetections_Subform.Form.Dirty Then
    Me.CamDetections_Subform.Form.Dirty = False
End If

'Build SQL string
strSQL = "SELECT PhotoIDRecSource.ImageID, " & _
    "PhotoIDRecSource.FileName, IIf(PhotoIDRecSource.ImageID=" & _
    "[Forms]![PhotoID]![ImageID],'Current Photo', '') As Current, " & _
    "PhotoIDRecSource.ImgPath FROM PhotoIDRecSource "
If Len(Me.Filter) > 0 Then
    strSQL = strSQL & "WHERE " & Me.Filter & " "
End If
strSQL = strSQL & "ORDER BY PhotoIDRecSource.ImageID;"

'Overwrite existing record source query
SaveQuery "qryBatchIDRecSource", strSQL

'Open form
DoCmd.OpenForm "BatchPhotoID", , , , , acDialog, Me.ImageID
Me.CamDetections_Subform.Requery

End Sub

Private Sub cmdHelp_Click()
'Display help message

On Error Resume Next

HelpMsg Me.Name, "PhotoID Form Help"

End Sub

Private Sub cmdNavBarFirst_Click()
'First record

On Error Resume Next

DoCmd.GoToRecord , , acFirst

End Sub

Private Sub cmdNavBarLast_Click()
'Last record

On Error Resume Next

DoCmd.GoToRecord , , acLast

End Sub

Private Sub cmdNavBarNext_Click()
'Next record

On Error Resume Next

DoCmd.GoToRecord

End Sub

Private Sub cmdNavBarPrevious_Click()
'Previous record

On Error Resume Next

DoCmd.GoToRecord , , acPrevious

End Sub

Private Sub cmdNext_Click()
'Next record

On Error Resume Next

DoCmd.GoToRecord

End Sub

Private Sub cmdPrev_Click()
'Previous record

On Error Resume Next

DoCmd.GoToRecord , , acPrevious

End Sub

Private Sub cmdShortcuts_Click()
'Open the 'shortcuts' report

On Error GoTo ErrHandler

DoCmd.OpenReport "Shortcuts", acViewReport, , , acWindowNormal

Exit Sub

ErrHandler:
    ErrorMsg "Cannot open the shortcut list.", Err.Number, _
        Err.Description

End Sub

Private Sub CurrImage_Click()

If bTag Then
    CurrImage_DblClick False
Else
    bTag = True
    lngTimer = Me.TimerInterval
    Me.TimerInterval = 250
End If

End Sub

Private Sub CurrImage_DblClick(Cancel As Integer)
'Open the file in the default program for jpgs

Dim lngImageID As Long

On Error GoTo ErrHandler

Me.txtFocus.SetFocus
bTag = False
Me.TimerInterval = lngTimer
If OpenPhotoWithDialog(Me.ImgPath, Me.ImageID) Then
    lngImageID = Me.ImageID
    Me.Requery
    With Me.RecordsetClone
        .FindFirst "ImageID=" & lngImageID
        If Not .NoMatch Then
            Me.Bookmark = .Bookmark
        End If
    End With
End If

Exit Sub

ErrHandler:
    ErrorMsg "Unable to open the photo.", Err.Number, Err.Description

End Sub

Private Sub CurrImage_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)

lngX = CLng(X)
lngY = CLng(Y)

End Sub

Private Sub CurrImage_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)

lngX2 = CLng(X)
lngY2 = CLng(Y)

End Sub

Private Sub Form_Close()

On Error GoTo ErrHandler

AccessCloseButtonEnabled False
DoCmd.Hourglass True
DoCmd.OpenForm "PhotoIDClose"
DoEvents
CombineDetections
UpdateFlags

FCExit:
    On Error Resume Next
    DoCmd.SetWarnings True
    AccessCloseButtonEnabled True
    DoCmd.Hourglass False
    DoCmd.Close acForm, "PhotoIDClose"
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred processing IDs.", _
        Err.Number, Err.Description
    Resume FCExit

End Sub

Private Sub Form_Current()
'Format controls and labels based on whether the
'photo can be displayed and which record is current

On Error GoTo ErrHandler

Me.txtFocus.SetFocus

ShowPhoto
ShowTags
FormatNavButtons

'Populate highlight checkbox
Me.chkHighlightUnbound = Me.Highlight

'Mark current photo for flag update/ID comparison
SetUpdateFlag

Exit Sub

ErrHandler:
    'Ignore error from paging through records too quickly
    If Err.Number = 2105 Or Err.Number = 2455 Then
        Err.Clear
        Exit Sub
    Else
        ErrorMsg strGenericError, Err.Number, Err.Description
    End If

End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
'Implement keyboard shortcuts

On Error GoTo ErrHandler

'Check that focus is on the default control - if user is typing into
'nav bar focus is there, so shortcuts shouldn't be implemented
If Me.ActiveControl.Name = "txtFocus" Then
    ApplyShortcut (KeyCode)
End If

Exit Sub

ErrHandler:
    'Ignore errors from paging through records too quickly
    If Err.Number = 2105 Or Err.Number = 2455 Then
        Err.Clear
        Exit Sub
    Else
        ErrorMsg "The key you pressed triggered an error.", _
            Err.Number, Err.Description, "Invalid shortcut"
    End If

End Sub

Private Sub Form_Open(Cancel As Integer)
'Ensure there is an observer logged in and
'adjust form for compare mode

On Error GoTo ErrHandler

'Check for photos
If Me.RecordsetClone.RecordCount = 0 Then
    MsgBox "No Photos to ID"
    Cancel = True
    Exit Sub
End If

'Check if observer is logged in already
If DCount("*", "CurrentObserver") = 0 Then
    DoCmd.OpenForm "PhotoIDLogin", , , , , acDialog
End If

'Check again after PhotoIDLogin is closed
If DCount("*", "CurrentObserver") = 0 Then
    'Still no observer - don't open form
    Cancel = True
    Exit Sub
End If

'Observer is logged in now - open form and make sure
'automatic advance is deactivated, pass login to subform
Me.TimerInterval = 0
Me.chkAdvance = False
Me.CurrentObserverSubform.Requery
Me.CamDetections_Subform.SourceObject = "PhotoIDDetectionsSubform"
SetObserver

'Check for compare mode
FormatCompareMode

'Adjust control size based on resolution
lngScreenHeight = ScreenHeight
ShrinkControls (lngScreenHeight)

'Adjust form to fit window
ResizeForm

'Update record count
UpdateCount

'Minimize Switchboard
HideSwitchboard acForm, Me.Name

Exit Sub

ErrHandler:
    '2501 is the error if the open event was canceled (user canceled login)
    'suppress the error message if that's the case
    If Err.Number <> 2501 Then
        ErrorMsg "Access encountered an error attempting " & _
            "to open the form.", Err.Number, Err.Description
    End If

End Sub

Private Sub Form_Resize()
'Recheck resolution and resize form when window is resized

If IsLoaded("PhotoID") Then
    'Compare res stored as lngScreenHeight to current res
    If lngScreenHeight <> ScreenHeight Then
        'Resolution has changed, update control size
        lngScreenHeight = ScreenHeight
        ShrinkControls lngScreenHeight
    End If
    'Fit form to screen
    ResizeForm
    'Resize tags
    ShowTags
End If

End Sub

Private Sub Form_Timer()
'Move to next record automatically when timer interval is set

On Error GoTo ErrHandler

If bTag Then
    If Not DeleteTag() Then
        SetTag
    End If
    Me.TimerInterval = lngTimer
    bTag = False
    ShowTags
    Exit Sub
End If

If Me.CurrentRecord < Me.RecordsetClone.RecordCount Then
    'Next record
    DoCmd.GoToRecord
Else
    ' Display message if current record is the last one
    Me.TimerInterval = 0
    Me.chkAdvance = False
    MsgBox "No more images.", , "The End"
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description
    Me.TimerInterval = 0

End Sub

Private Sub Form_Unload(Cancel As Integer)
'Combine matching detections

On Error GoTo ErrHandler

'Restore PhotoViewer or switchboard if open
If IsLoaded("PhotoViewer") Then
    DoCmd.SelectObject acForm, "PhotoViewer", False
    DoCmd.Restore
Else
    'Bring back switchboard
    RestoreSwitchboard
End If

ErrHandler:
    Me.TimerInterval = 0
    DoCmd.SetWarnings True

End Sub

Private Sub txtRecordNumber_AfterUpdate()
'Go to the record typed in by the user

Dim iPos As Integer

'Remove " of ..."
iPos = InStr(1, Me.txtRecordNumber, " of")
If iPos > 0 Then
    Me.txtRecordNumber = Left(Me.txtRecordNumber, iPos - 1)
End If

'Test for invalid entry
If Not IsNumeric(Me.txtRecordNumber) Then
    'Reset the box and stay put
    Me.txtRecordNumber = Me.CurrentRecord & " of " & _
        Me.Recordset.RecordCount
    Exit Sub
End If

'Use clone recordset to find the right record
Me.RecordsetClone.MoveFirst
If Me.txtRecordNumber > 1 Then
    Me.RecordsetClone.Move Nz(Me.txtRecordNumber, 1) - 1
    If Me.RecordsetClone.EOF Then
        Me.RecordsetClone.MoveLast
    End If
End If
'Navigate form to the record in the clone
Me.Bookmark = Me.RecordsetClone.Bookmark

End Sub

Private Sub txtRecordNumber_Enter()
'Clear # of # text

On Error Resume Next

Me.txtRecordNumber = Null

End Sub

Private Sub txtSeconds_AfterUpdate()
'Apply new timer interval for automatically moving through records

On Error GoTo ErrHandler

'Check for valid entry
If IsNumeric(Me.txtSeconds) And Me.chkAdvance.Value = True Then
    'Set timer
    Me.TimerInterval = 1000 * Me.txtSeconds
Else
    Me.TimerInterval = 0
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub ApplyShortcut(iKey As Integer)

Dim vSpeciesID As Variant
Dim vDetailID As Variant

Select Case iKey

    'For digits put the number in the individuals field
    Case 49 To 57
        If Not (Nz(Me.OpenArgs, "") = "Compare") Then
            Me.CamDetections_Subform!Individuals = chr(iKey)
        End If

    'For Z use data from previous record
    Case 90
        If Me.RecordSource <> "PhotoIDCompare" Then
            If Me.CamDetections_Subform.Form.NewRecord Then
                GetPreviousDetections Me.ImageID
                Me.CamDetections_Subform.Requery
            End If
        End If

    'Space bar - next line (Thanks Joe)
    Case 32
        With Me.CamDetections_Subform.Form
            .Dirty = False
            .Recordset.AddNew
        End With
        Me.txtFocus.SetFocus

    'Arrows - do nothing
    Case 37, 100, 38, 104, 39, 102, 40, 98

    Case Else
        If Not (Nz(Me.OpenArgs, "") = "Compare") Then
            vSpeciesID = Me.CamDetections_Subform!SpeciesID
            vDetailID = Null
            If Not IsNull(vSpeciesID) Then
                'Look for a detail shortcut
                vDetailID = DLookup("DetailID", "DetailsRecSource", _
                    "Shortcut='" & chr(iKey) & "' AND SpeciesID=" & _
                    vSpeciesID)
                If Not IsNull(vDetailID) Then
                    'Add/change detail in subform
                    Me.CamDetections_Subform!DetailID = vDetailID
                End If
            End If
            If IsNull(vDetailID) Then
                'No detail found, look for species
                vSpeciesID = DLookup("SpeciesID", "SpeciesShortcuts", _
                    "Shortcut='" & chr(iKey) & "'")
                If Not IsNull(vSpeciesID) Then
                    If Me.CamDetections_Subform!SpeciesID <> vSpeciesID Or _
                        IsNull(Me.CamDetections_Subform!SpeciesID) Then
                        'Change/add species in subform
                        Me.CamDetections_Subform!DetailID = Null
                        Me.CamDetections_Subform!SpeciesID = vSpeciesID
                        Me.CamDetections_Subform.Form.DetailID.Requery
                    End If
                End If
            End If
        End If

End Select

Me.txtFocus = Null

End Sub

Private Function DeleteTag() As Boolean

Dim db As DAO.Database
Dim strSQL As String

Set db = CurrentDb

strSQL = "DELETE * FROM PhotoTags WHERE ImageID=" & _
    Me.ImageID

If (Me.RecordSource = "PhotoIDRecSource") And _
    InStr(1, Me.Filter, "ImageID") = 0 Then
    strSQL = strSQL & " AND ObsID=" & GetObserver()
End If

strSQL = strSQL & " AND (TagX - XLen/2)<" & lngX / Me.CurrImage.Width & _
    " AND (TagX + XLen/2)>" & lngX / Me.CurrImage.Width & _
    " AND (TagY - YLen/2)<" & lngY / Me.CurrImage.Height & _
    " AND (TagY + YLen/2)>" & lngY / Me.CurrImage.Height

db.Execute strSQL

DeleteTag = (db.RecordsAffected > 0)

Set db = Nothing

End Function

Public Sub FilterUpdate()
'Build a filter string based on values in filter controls
'and apply the new filter to the form

Dim strFilter As String

On Error GoTo ErrHandler

strFilter = ""

If Left(Me.Filter, 9) = "ImageID =" Then
    'Opened from PhotoViewer, no filtering
    Exit Sub
End If

'Set record source based on 'Need ID' checkbox
If Me.chkNeedID = True Then
    If Me.RecordSource = "PhotoIDRecSource" Then
        Me.RecordSource = "PhotoIDNeedID"
    End If
Else
    If Me.RecordSource = "PhotoIDNeedID" Then
        Me.RecordSource = "PhotoIDRecSource"
    End If
End If

'Build a filter string for each criterion
If Not IsNull(Me.cboLocationFilter) Then
    'Location clause
    strFilter = strFilter & "((LocationID)=" & Me.cboLocationFilter & ")"
End If

If Not IsNull(cboSeasonFilter) Then
    'Year clause
    strFilter = strFilter & "((FieldSeason)=" & Me.cboSeasonFilter & ")"
End If

If Len(strFilter) > 0 Then
    'Add 'AND' between clauses
    strFilter = Replace(strFilter, ")(", ") AND (")
    'Add parentheses
    strFilter = "(" & strFilter & ")"
End If

'Apply filter
Me.Filter = strFilter
Me.FilterOn = (Len(strFilter) > 0)

'Test if filter didn't return any records (form current event won't fire)
If IsNull(Me.ImageID) Then
    Me.txtRecordNumber = "0 of 0"
    Me.cmdNavBarFirst.Enabled = False
    Me.cmdNavBarPrevious.Enabled = False
    Me.cmdNavBarNext.Enabled = False
    Me.cmdNavBarLast.Enabled = False
    Me.cmdPrev.Enabled = False
    Me.cmdNext.Enabled = False
    Me.txtRecordNumber.Enabled = False
    With Me.lblNotFound
        .Caption = "No images to display"
        .Height = 0.3021 * 1440
        .Width = 2.5 * 1440
        .Top = Me.CurrImage.Top + _
            (Me.CurrImage.Height - .Height) / 2
        .Left = Me.CurrImage.Left + _
            (Me.CurrImage.Width - .Width) / 2
        .Visible = True
    End With
Else
    SetObserver
    UpdateCount
    FormatNavButtons
    Me.lblNotFound.Caption = "Image not found"
End If

Exit Sub

ErrHandler:
    ErrorMsg "Filter failed.  Please try again.  " & _
        "If you continue to receive this message you may " & _
        "need to close and reopen the form.", Err.Number, Err.Description

End Sub

Private Sub FormatCompareMode()

Dim bNormal As Boolean
Dim bSingle As Boolean

bNormal = Me.RecordSource = "PhotoIDRecSource"
bSingle = (InStr(1, Me.Filter, "ImageID") > 0)

'Disable filters for single photo
Me.cboLocationFilter.Enabled = Not bSingle
Me.cboSeasonFilter.Enabled = Not bSingle

'Disable controls in compare mode
Me.chkNeedID.Enabled = bNormal And Not bSingle
Me.cmdShortcuts.Visible = bNormal And Not bSingle
Me.cmdBatch.Enabled = bNormal And Not bSingle

'Apply filter for single photo
Me.FilterOn = bNormal And bSingle

End Sub

Private Sub FormatNavButtons()

Dim bFirst As Boolean
Dim bLast As Boolean

On Error GoTo ErrHandler

'Disable previous button on first record, next button on last
bFirst = (Me.Recordset.AbsolutePosition < 1)
bLast = (Me.CurrentRecord = lngCount)
Me.cmdPrev.Enabled = Not bFirst
Me.cmdNavBarPrevious.Enabled = Not bFirst
Me.cmdNavBarFirst.Enabled = Not bFirst
Me.cmdNext.Enabled = Not bLast
Me.cmdNavBarNext.Enabled = Not bLast
Me.cmdNavBarLast.Enabled = Not bLast

'Populate navigation bar text box
Me.txtRecordNumber = Me.CurrentRecord & " of " & _
    lngCount
Me.txtRecordNumber.Enabled = True

Exit Sub

ErrHandler:
    If Err.Number = 2164 Then
        'Clicked on button before it got disabled
        Me.txtRecordNumber.SetFocus
        Resume
    Else
        ErrorMsg strGenericError, Err.Number, Err.Description
    End If

End Sub

Private Sub GetPreviousDetections(lngCurrentID As Long)
'Retrieve data from previous record when Z shortcut is used

Dim strSQL As String
Dim lngPreviousID As Long

On Error GoTo ErrHandler

'Get ID from previous record
With Me.RecordsetClone
    'Get ID for first record
    .MoveFirst
    lngPreviousID = !ImageID
    'Find current record
    .FindFirst "ImageID=" & lngCurrentID
    If Not .NoMatch Then
        'Test for first record
        If !ImageID = lngPreviousID Then
            lngPreviousID = 0
        Else
            'Move back one and store ID
            .MovePrevious
            lngPreviousID = !ImageID
        End If
    End If
End With

If lngPreviousID > 0 Then
    'Copy records to current photo
    strSQL = "INSERT INTO Detections ( SpeciesID, DetailID, " & _
        "Individuals, Comments, ObsID, ImageID, StatusID ) " & _
        "SELECT SpeciesID, DetailID, Individuals, Comments, ObsID, " & _
        lngCurrentID & " As Image, 1 As Status " & _
        "FROM Detections " & _
        "WHERE (((ImageID)=" & lngPreviousID & ") AND ((ObsID)=" & _
        GetObserver & "))"
    DoCmd.SetWarnings False
    DoCmd.RunSQL strSQL
End If

GPDExit:
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred retrieving the data from the last record.", _
        Err.Number, Err.Description, "Shortcut failed"
    Resume GPDExit

End Sub

Private Sub ResizeForm()
'Move controls based on window size and stretch photo to fill space

Dim lngCenter As Long
Dim lngDetailHt As Long
Dim lngFrmWidth As Long
Dim lngImageHt As Long
Dim lngCtlTop As Long
Dim lngCtlLeft As Long
Dim lngSpace As Long

'Get window size parameters
lngDetailHt = Me.InsideHeight - Me.FormFooter.Height - Me.FormHeader.Height
If Me.InsideWidth > lngMaxFormWidth Then
    lngFrmWidth = lngMaxFormWidth
Else
    lngFrmWidth = Me.InsideWidth
End If
If lngFrmWidth < 8 * 1440 Then
    lngFrmWidth = 8 * 1440
End If
lngCenter = CLng(lngFrmWidth / 2)

'Set detail size
Me.Width = lngFrmWidth
If lngDetailHt > 4 * 1440 Then
    'Window is taller than original height, expand detail section
    Me.Detail.Height = lngDetailHt
Else
    'Window is shorter, use original height
    lngDetailHt = 4 * 1440
End If

'Set spacing
If lngScreenHeight > 999 Then
    lngSpace = 30
Else
    lngSpace = 15
End If

'Resize image and center
'Calculate available height
lngImageHt = lngDetailHt - Me.CurrImage.Top
lngImageHt = lngImageHt - (lngSpace * 2)
lngImageHt = lngImageHt - Me.CamDetections_Subform.Height
'Apply height and set width relative to that
Me.CurrImage.Height = lngImageHt
Me.CurrImage.Width = lngImageHt * (4 / 3)
'Avoid 'not enough space for control' error by making form wider if needed
If Me.CurrImage.Width > lngFrmWidth Then
    lngFrmWidth = Me.CurrImage.Width
    Me.Width = lngFrmWidth
    lngCenter = lngFrmWidth / 2
End If
'Calculate left edge to center image
lngCtlLeft = lngCenter - (Me.CurrImage.Width / 2)
'Avoid negative left (triggers error)
If lngCtlLeft < 0 Then
    lngCtlLeft = 0
End If
Me.CurrImage.Left = lngCtlLeft
Me.txtFileName.Left = Me.CurrImage.Left
Me.txtFileName.Width = Me.CurrImage.Width

'Move controls below image down to bottom of form
'Subform and highlight box below image
lngCtlTop = Me.CurrImage.Top + Me.CurrImage.Height + lngSpace
Me.CamDetections_Subform.Top = lngCtlTop
Me.chkHighlightUnbound.Top = lngCtlTop
Me.chkHighlightUnbound_Label.Top = lngCtlTop
'Advance box below highlight box
lngCtlTop = lngCtlTop + Me.chkHighlightUnbound.Height + _
    lngSpace
Me.chkAdvance.Top = lngCtlTop
Me.chkAdvance_Label.Top = lngCtlTop
'Seconds/photo below advance box
lngCtlTop = lngCtlTop + Me.chkAdvance.Height + lngSpace
Me.txtSeconds.Top = lngCtlTop
Me.txtSeconds_Label.Top = lngCtlTop
'Prev/batch/next buttons below seconds/photo
lngCtlTop = lngCtlTop + Me.txtSeconds.Height + lngSpace
Me.cmdPrev.Top = lngCtlTop
Me.cmdBatch.Top = lngCtlTop
Me.cmdNext.Top = lngCtlTop
'Keyboard shortcuts below buttons
lngCtlTop = lngCtlTop + Me.cmdPrev.Height + lngSpace
Me.cmdShortcuts.Top = lngCtlTop

'Center controls
'Calculate subform left edge
lngCtlLeft = Me.CamDetections_Subform.Width
lngCtlLeft = lngCtlLeft + (lngSpace * 2)
lngCtlLeft = lngCtlLeft + Me.cmdShortcuts.Width
lngCtlLeft = lngCenter - (lngCtlLeft / 2)
'Avoid negative left (triggers error)
If lngCtlLeft < 0 Then
    lngCtlLeft = 0
End If
Me.CamDetections_Subform.Left = lngCtlLeft
'Calculate left edge for labels right of subform
lngCtlLeft = lngCtlLeft + Me.CamDetections_Subform.Width + (lngSpace * 2)
Me.chkHighlightUnbound_Label.Left = lngCtlLeft
Me.chkAdvance_Label.Left = lngCtlLeft
Me.txtSeconds_Label.Left = lngCtlLeft
Me.cmdShortcuts.Left = lngCtlLeft
Me.cmdPrev.Left = lngCtlLeft
'Calculate left edge for check boxes and seconds input
lngCtlLeft = lngCtlLeft + Me.chkHighlightUnbound_Label.Width + _
    lngSpace
Me.chkHighlightUnbound.Left = lngCtlLeft
Me.chkAdvance.Left = lngCtlLeft
Me.txtSeconds.Left = lngCtlLeft
'Calculate left edges for batch and next buttons
lngCtlLeft = Me.cmdShortcuts.Left + (Me.cmdShortcuts.Width / 2)
lngCtlLeft = lngCtlLeft - (Me.cmdBatch.Width / 2)
Me.cmdBatch.Left = lngCtlLeft
lngCtlLeft = Me.cmdShortcuts.Left + Me.cmdShortcuts.Width
lngCtlLeft = lngCtlLeft - Me.cmdNext.Width
Me.cmdNext.Left = lngCtlLeft

'Right align controls
'Calculate left edge for login and label
lngCtlLeft = lngFrmWidth - (lngSpace * 2) - Me.CurrentObserverSubform.Width
Me.CurrentObserverSubform.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - lngSpace - Me.CurrentObserverSubform_Label.Width
Me.CurrentObserverSubform_Label.Left = lngCtlLeft
'Calculate left edge for filters in header
lngCtlLeft = lngFrmWidth - (lngSpace * 2) - Me.chkNeedID.Width
Me.chkNeedID.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - lngSpace - Me.chkNeedID_Label.Width
Me.chkNeedID_Label.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - (lngSpace * 2) - Me.cboSeasonFilter.Width
Me.cboSeasonFilter.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - lngSpace - Me.cboSeasonFilter_Label.Width
Me.cboSeasonFilter_Label.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - (lngSpace * 2) - Me.cboLocationFilter.Width
Me.cboLocationFilter.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - lngSpace - Me.cboLocationFilter_Label.Width
Me.cboLocationFilter_Label.Left = lngCtlLeft
lngCtlLeft = lngCtlLeft - (lngSpace * 5) - Me.Filters_Label.Width
Me.Filters_Label.Left = lngCtlLeft
'Calculate help button left edge
lngCtlLeft = lngFrmWidth - (lngSpace * 2) - Me.cmdHelp.Width
Me.cmdHelp.Left = lngCtlLeft

'Stretch footer
Me.Box0.Width = lngFrmWidth
Me.Box1.Width = lngFrmWidth
Me.Box2.Width = lngFrmWidth

'Reset detail height
Me.Detail.Height = lngDetailHt

End Sub

Public Sub SetObserver()
'Set the current observer ID to the ID stored in table CurrentObserver

Dim lngObserver As Long

On Error GoTo ErrHandler

lngObserver = Me.CurrentObserverSubform.Form.ObserverID

With Me.CamDetections_Subform.Form
    .ObsID.DefaultValue = lngObserver
    If Me.RecordSource = "PhotoIDRecSource" And _
        InStr(1, Me.Filter, "ImageID") = 0 Then
        .Filter = "[ObsID]=" & lngObserver
        .FilterOn = True
    End If
End With

SOExit:
    Exit Sub

ErrHandler:
    ErrorMsg "Unable to complete log in.", Err.Number, Err.Description
    Resume SOExit

End Sub

Private Sub SetTag()

Dim strSQL As String

strSQL = "INSERT INTO PhotoTags ( TagX, XLen, TagY, YLen, ImageID, ObsID ) " & _
    "VALUES ( "

If Abs(lngX2 - lngX) > 720 Then
    strSQL = strSQL & (Abs(lngX2 + lngX) / 2) / Me.CurrImage.Width & _
        ", " & Abs(lngX2 - lngX) / Me.CurrImage.Width & ", "
Else
    strSQL = strSQL & lngX / Me.CurrImage.Width & ", " & _
        1440 / Me.CurrImage.Width & ", "
End If

If Abs(lngY2 - lngY) > 720 Then
    strSQL = strSQL & (Abs(lngY2 + lngY) / 2) / Me.CurrImage.Height & _
        ", " & Abs(lngY2 - lngY) / Me.CurrImage.Height & ", "
Else
    strSQL = strSQL & lngY / Me.CurrImage.Height & ", " & _
        1440 / Me.CurrImage.Width & ", "
End If

strSQL = strSQL & Me.ImageID & ", " & GetObserver() & " )"

CurrentDb.Execute strSQL

End Sub

Private Sub SetUpdateFlag()

Dim strSQL As String

strSQL = "UPDATE Photos SET NeedsUpdate = True " & _
    "WHERE (((ImageID) = " & Me.ImageID & "))"

CurrentDb.Execute strSQL

End Sub

Private Sub ShowPhoto()

Dim bShow As Boolean
Dim lngHeight As Long
Dim lngWidth As Long
Dim lngTop As Long
Dim lngLeft As Long

bShow = FileExists(Me.ImgPath)

If bShow Then
    lngHeight = 0
    lngWidth = 0
    lngTop = 0
    lngLeft = 0
Else
    lngHeight = 0.3021 * 1440
    lngWidth = 2.5 * 1440
    lngTop = Me.CurrImage.Top + _
        (Me.CurrImage.Height - lngHeight) / 2
    lngLeft = Me.CurrImage.Left + _
        (Me.CurrImage.Width - lngWidth) / 2
End If

With Me.lblNotFound
    .Height = lngHeight
    .Width = lngWidth
    .Top = lngTop
    .Left = lngLeft
    .Visible = Not bShow
End With

End Sub

Private Sub ShowTags()
'Draws boxes on the photo for highlighted sections

Dim rs As DAO.Recordset
Dim i As Integer
Dim ctl As Control
Dim lngImageX As Long
Dim lngImageY As Long
Dim lngImageW As Long
Dim lngImageH As Long
Dim lngLeft As Long

On Error GoTo ErrHandler

If FileExists(Me.ImgPath) And Not IsNull(GetObserver()) Then
    If Me.RecordSource = "PhotoIDRecSource" And _
        InStr(1, Me.Filter, "ImageID") = 0 Then
        'Normal mode - only current observers tags
        Set rs = CurrentDb.OpenRecordset("SELECT * FROM PhotoTags " & _
            "WHERE ImageID=" & Me.ImageID & " AND ObsID=" & GetObserver())
    Else
        'Compare mode - all tags
        Set rs = CurrentDb.OpenRecordset("SELECT * FROM PhotoTags " & _
            "WHERE ImageID=" & Me.ImageID)
    End If
    With rs
        If Not (.BOF And .EOF) Then
            .MoveFirst
            'Get image control properties
            lngImageX = Me.CurrImage.Left
            lngImageY = Me.CurrImage.Top
            lngImageW = Me.CurrImage.Width
            lngImageH = Me.CurrImage.Height
            'Loop through tags
            Do Until .EOF
                i = i + 1
                Set ctl = Me.Controls("PhotoTag" & i)
                ctl.Width = !XLen * lngImageW
                ctl.Height = !YLen * lngImageH
                lngLeft = !TagX * lngImageW + lngImageX - _
                    !XLen * lngImageW / 2
                If lngLeft < 0 Then
                    If ctl.Width > Abs(lngLeft) Then
                        ctl.Width = ctl.Width + lngLeft
                    End If
                    ctl.Left = 0
                Else
                    ctl.Left = lngLeft
                End If
                ctl.Top = !TagY * lngImageH + lngImageY - _
                    !YLen * lngImageH / 2
                ctl.Visible = True
                .MoveNext
            Loop
        End If
    End With
End If

'Hide unused tag controls
If i < 5 Then
    For i = i + 1 To 5
        Set ctl = Me.Controls("PhotoTag" & i)
        ctl.Visible = False
        ctl.Top = 0
        ctl.Left = 0
        ctl.Width = 0
        ctl.Height = 0
    Next
End If

STExit:
    If Not rs Is Nothing Then
        rs.Close
        Set rs = Nothing
    End If
    Set ctl = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred displaying tags for this photo.", _
        Err.Number, Err.Description
    Resume STExit

End Sub

Private Sub ShrinkControls(lngScreenHeight As Long)
'Set control size and font size based on resolution

Dim iFontSize As Integer
Dim iSpace As Integer
Dim lngSubformHeight As Long
Dim lngSubformWidth As Long
Dim lngLabelHeight As Long
Dim lngLabelWidth As Long
Dim lngInputHeight As Long
Dim lngInputWidth As Long
Dim lngButtonHeight As Long
Dim lngButtonWidth As Long
Dim lngShortcutWidth As Long
Dim lngSpeciesWidth As Long
Dim lngIndividualsWidth As Long
Dim lngCommentsWidth As Long
Dim lngVerifyWidth As Long
Dim lngSFButtonWidth As Long

Select Case lngScreenHeight
    Case Is > 1199
        'High resolution, use controls at normal size
        iFontSize = 10
        iSpace = 60
        lngLabelHeight = 300
        lngLabelWidth = 2235
        lngInputHeight = 315
        lngInputWidth = 825
        lngButtonHeight = 555
        lngButtonWidth = 960
        lngSpeciesWidth = 1440
        lngIndividualsWidth = 1050
        lngCommentsWidth = 3660
        lngVerifyWidth = 1740
        lngSFButtonWidth = 600
    Case 1000 To 1199
        'Medium-high res, shrink controls a little
        iFontSize = 9
        iSpace = 60
        lngLabelHeight = 285
        lngLabelWidth = 2100
        lngInputHeight = 300
        lngInputWidth = 720
        lngButtonHeight = 480
        lngButtonWidth = 900
        lngSpeciesWidth = 1440
        lngIndividualsWidth = 960
        lngCommentsWidth = 3330
        lngVerifyWidth = 1620
        lngSFButtonWidth = 600
    Case 800 To 999
        'Medium-low res, shrink controls and decrease spacing
        iFontSize = 8
        iSpace = 30
        lngLabelHeight = 270
        lngLabelWidth = 1920
        lngInputHeight = 285
        lngInputWidth = 600
        lngButtonHeight = 420
        lngButtonWidth = 840
        lngSpeciesWidth = 1200
        lngIndividualsWidth = 825
        lngCommentsWidth = 2325
        lngVerifyWidth = 1440
        lngSFButtonWidth = 540
    Case 600 To 799
        'Low resolution, shrink controls even more and decrease spacing
        iFontSize = 7
        iSpace = 30
        lngLabelHeight = 255
        lngLabelWidth = 1620
        lngInputHeight = 270
        lngInputWidth = 480
        lngButtonHeight = 390
        lngButtonWidth = 780
        lngSpeciesWidth = 1140
        lngIndividualsWidth = 765
        lngCommentsWidth = 1905
        lngVerifyWidth = 1320
        lngSFButtonWidth = 480
    Case Else
        MsgBox "Your screen resolution is ridiculously low - " & _
            "unable to fit the photo ID form to your screen."
        Exit Sub
End Select

'Apply new font size
Me.chkHighlightUnbound_Label.FontSize = iFontSize
Me.chkAdvance_Label.FontSize = iFontSize
Me.txtSeconds_Label.FontSize = iFontSize
Me.txtSeconds.FontSize = iFontSize
Me.cmdPrev.FontSize = iFontSize
Me.cmdBatch.FontSize = iFontSize
Me.cmdNext.FontSize = iFontSize
Me.cmdShortcuts.FontSize = iFontSize

'Change width and height
Me.chkHighlightUnbound_Label.Width = lngLabelWidth
Me.chkHighlightUnbound_Label.Height = lngLabelHeight
Me.chkHighlightUnbound.Width = lngInputWidth
Me.chkHighlightUnbound.Height = lngLabelHeight
Me.chkAdvance_Label.Width = lngLabelWidth
Me.chkAdvance_Label.Height = lngLabelHeight
Me.chkAdvance.Width = lngInputWidth
Me.chkAdvance.Height = lngLabelHeight
Me.txtSeconds_Label.Width = lngLabelWidth
Me.txtSeconds_Label.Height = lngLabelHeight
Me.txtSeconds.Width = lngInputWidth
Me.txtSeconds.Height = lngLabelHeight
Me.cmdPrev.Width = lngButtonWidth
Me.cmdPrev.Height = lngButtonHeight
Me.cmdBatch.Width = lngButtonWidth
Me.cmdBatch.Height = lngButtonHeight
Me.cmdNext.Width = lngButtonWidth
Me.cmdNext.Height = lngButtonHeight
lngShortcutWidth = lngLabelWidth + lngInputWidth + iSpace
Me.cmdShortcuts.Width = lngShortcutWidth
Me.cmdShortcuts.Height = lngLabelHeight

'Resize subform controls
If Me.CamDetections_Subform.SourceObject = _
    "PhotoIDDetectionsSubform" Then
    With Me.CamDetections_Subform.Form
        'Apply font size
        .SpeciesID_Label.FontSize = iFontSize
        .DetailID_Label.FontSize = iFontSize
        .Individuals_Label.FontSize = iFontSize
        .Comments_Label.FontSize = iFontSize
        .cmdVerify.FontSize = iFontSize
        .cmdUndo.FontSize = iFontSize
        iFontSize = iFontSize + 1
        .SpeciesID.FontSize = iFontSize
        .DetailID.FontSize = iFontSize
        .Individuals.FontSize = iFontSize
        .Comments.FontSize = iFontSize

        'Set Width
        .SpeciesID.Width = lngSpeciesWidth
        .SpeciesID_Label.Width = lngSpeciesWidth
        .DetailID.Width = lngSpeciesWidth
        .DetailID_Label.Width = lngSpeciesWidth
        .Individuals.Width = lngIndividualsWidth
        .Individuals_Label.Width = lngIndividualsWidth
        .Comments.Width = lngCommentsWidth
        .Comments_Label.Width = lngCommentsWidth
        .cmdVerify.Width = lngVerifyWidth
        .cmdUndo.Width = lngSFButtonWidth
        .cmdDelete.Width = lngSFButtonWidth

        'Set height
        .SpeciesID.Height = lngInputHeight
        .DetailID.Height = lngInputHeight
        .Individuals.Height = lngInputHeight
        .Comments.Height = lngInputHeight
        .cmdDelete.Height = lngInputHeight
        .SpeciesID_Label.Height = lngLabelHeight
        .Individuals_Label.Height = lngLabelHeight
        .Comments_Label.Height = lngLabelHeight
        .cmdVerify.Height = lngLabelHeight
        .cmdUndo.Height = lngLabelHeight

        'Move controls
        .SpeciesID.Left = iSpace * 2
        .SpeciesID.Top = iSpace
        .SpeciesID_Label.Left = .SpeciesID.Left
        .SpeciesID_Label.Top = iSpace
        .DetailID.Left = .SpeciesID.Left + .SpeciesID.Width + iSpace
        .DetailID.Top = iSpace
        .DetailID_Label.Left = .DetailID.Left
        .DetailID_Label.Top = iSpace
        .Individuals.Left = .DetailID.Left + .SpeciesID.Width + iSpace
        .Individuals.Top = iSpace
        .Individuals_Label.Left = .Individuals.Left
        .Individuals_Label.Top = iSpace
        .Comments.Left = .Individuals.Left + .Individuals.Width + iSpace
        .Comments.Top = iSpace
        .Comments_Label.Left = .Comments.Left
        .Comments_Label.Top = iSpace
        .cmdDelete.Left = .Comments.Left + .Comments.Width + (iSpace * 2)
        .cmdDelete.Top = iSpace
        .cmdVerify.Left = .cmdDelete.Left + .cmdDelete.Width - .cmdVerify.Width
        .cmdVerify.Top = iSpace
        .cmdUndo.Left = .cmdVerify.Left - .cmdUndo.Width - iSpace
        .cmdUndo.Top = iSpace

        'Shrink form sections to fit
        .Width = .cmdDelete.Left + .cmdDelete.Width + (iSpace * 2)
        .FormHeader.Height = lngLabelHeight + (iSpace * 2)
        .Detail.Height = lngInputHeight + (iSpace * 2)

        'Return the subform width so the container can be resized in the parent form
        lngSubformWidth = .Width

    End With

    'Resize subform container
    Me.CamDetections_Subform.Width = lngSubformWidth + 270
    lngSubformHeight = (lngLabelHeight * 4) + (iSpace * 4) + lngButtonHeight
    Me.CamDetections_Subform.Height = lngSubformHeight
End If

End Sub

Private Sub UpdateCount()

Me.RecordsetClone.MoveLast
lngCount = Me.Recordset.RecordCount

End Sub
