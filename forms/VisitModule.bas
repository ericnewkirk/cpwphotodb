Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =9360
    DatasheetFontHeight =11
    ItemSuffix =74
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0x08477b7fecbce440
    End
    RecordSource ="qryVisitsRecSource"
    Caption ="VisitModule"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    PictureSizeMode =4
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            AutoHeight =1
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    TextFontFamily =34
                    Left =300
                    Top =60
                    Width =5400
                    Height =525
                    FontSize =18
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Auto_Title0"
                    Caption ="Create Module by Visit"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =300
                    LayoutCachedTop =60
                    LayoutCachedWidth =5700
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8880
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =8880
                    LayoutCachedTop =120
                    LayoutCachedWidth =9246
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            Height =4320
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =163
                    IMESentenceMode =3
                    Left =481
                    Top =2565
                    Width =5339
                    Height =315
                    BorderColor =7169897
                    Name ="txtPath"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =481
                    LayoutCachedTop =2565
                    LayoutCachedWidth =5820
                    LayoutCachedHeight =2880
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextFontFamily =34
                            Left =360
                            Top =2220
                            Width =5325
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="lblPath"
                            Caption ="Select the folder where you want to create the module:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =360
                            LayoutCachedTop =2220
                            LayoutCachedWidth =5685
                            LayoutCachedHeight =2490
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5940
                    Top =2565
                    Width =900
                    Height =314
                    TabIndex =1
                    Name ="cmdBrowsePath"
                    Caption ="Command12"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000708890ff608090ff607880ff507080ff506070ff405860ff ,
                        0x404850ff303840ff203030ff202030ff101820ff101010ff101020ff00000000 ,
                        0x0000000000000000708890ff90a0b0ff70b0d0ff0090d0ff0090d0ff0090d0ff ,
                        0x0090c0ff1088c0ff1080b0ff1080b0ff2078a0ff207090ff204860ff20303050 ,
                        0x0000000000000000808890ff80c0d0ff90a8b0ff80e0ffff60d0ffff50c8ffff ,
                        0x50c8ffff40c0f0ff30b0f0ff30a8f0ff20a0e0ff1090d0ff206880ff202830b0 ,
                        0x00000000000000008090a0ff80d0f0ff90a8b0ff90c0d0ff70d8ffff60d0ffff ,
                        0x60d0ffff50c8ffff50c0ffff40b8f0ff30b0f0ff30a8f0ff1088d0ff204860ff ,
                        0x10283020000000008090a0ff80d8f0ff80c8e0ff90a8b0ff80e0ffff70d0ffff ,
                        0x60d8ffff60d0ffff60d0ffff50c8ffff40c0f0ff40b8f0ff30b0f0ff206880ff ,
                        0x10486090000000008098a0ff90e0f0ff90e0ffff90a8b0ff90b8c0ff70d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d0ffff50d0ffff50c8ffff40b8f0ff30a0e0ff ,
                        0x406070f0506070308098a0ff90e0f0ffa0e8ffff80c8e0ff90a8b0ff80e0ffff ,
                        0x80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff70d8ffff70d8ffff ,
                        0x50a8d0ff506070a090a0a0ffa0e8f0ffa0e8ffffa0e8ffff90b0c0ff90b0c0ff ,
                        0x90a8b0ff90a8b0ff80a0b0ff80a0b0ff8098a0ff8098a0ff8090a0ff8090a0ff ,
                        0x808890ff708890ff90a0b0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff708890ff00000000 ,
                        0x000000000000000090a0b0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0x70d8ffff90a0a0ff8098a0ff8098a0ff8090a0ff809090ff708890ff00000000 ,
                        0x000000000000000090a8b0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0x90a0b0ff80a8b0800000000000000000000000000000000000000000906850ff ,
                        0x906850ff906850ff90a8b05090a8b0ff90a8b0ff90a8b0ff90a8b0ff90a8b0ff ,
                        0x90a8b090000000000000000000000000000000000000000000000000a0787050 ,
                        0x906850ff906850ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000907860ff9068506000000000a0787010a09080ff ,
                        0xa0887050907860ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000a0988040a09080ffa08880ffb09880ffa0908080 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =5940
                    LayoutCachedTop =2565
                    LayoutCachedWidth =6840
                    LayoutCachedHeight =2879
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =163
                    IMESentenceMode =3
                    Left =7860
                    Width =0
                    Height =0
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtFocus"

                    LayoutCachedLeft =7860
                    LayoutCachedWidth =7860
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =163
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1770
                    Top =930
                    Width =2730
                    Height =315
                    TabIndex =3
                    BorderColor =7169897
                    Name ="VisitDate"
                    ControlSource ="VisitDate"
                    RowGroup =2
                    GroupTable =1

                    LayoutCachedLeft =1770
                    LayoutCachedTop =930
                    LayoutCachedWidth =4500
                    LayoutCachedHeight =1245
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =540
                            Top =930
                            Width =1170
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label57"
                            Caption ="Date:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =2
                            GroupTable =1
                            LayoutCachedLeft =540
                            LayoutCachedTop =930
                            LayoutCachedWidth =1710
                            LayoutCachedHeight =1245
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =163
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1770
                    Top =1710
                    Width =2730
                    Height =315
                    TabIndex =6
                    BorderColor =7169897
                    Name ="PhotoCount"
                    ControlSource ="PhotoCount"
                    RowGroup =4
                    GroupTable =1

                    LayoutCachedLeft =1770
                    LayoutCachedTop =1710
                    LayoutCachedWidth =4500
                    LayoutCachedHeight =2025
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =540
                            Top =1710
                            Width =1170
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label59"
                            Caption ="Photos:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =4
                            GroupTable =1
                            LayoutCachedLeft =540
                            LayoutCachedTop =1710
                            LayoutCachedWidth =1710
                            LayoutCachedHeight =2025
                        End
                    End
                End
                Begin ComboBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =163
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =1770
                    Top =540
                    Width =2730
                    Height =315
                    TabIndex =5
                    BorderColor =7169897
                    Name ="VisitTypeID"
                    ControlSource ="VisitTypeID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lkupVisitTypes.VisitTypeID, lkupVisitTypes.VisitTypeText FROM lkupVisitTy"
                        "pes;"
                    ColumnWidths ="0;1440"
                    RowGroup =1
                    GroupTable =1

                    LayoutCachedLeft =1770
                    LayoutCachedTop =540
                    LayoutCachedWidth =4500
                    LayoutCachedHeight =855
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =540
                            Top =540
                            Width =1170
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label56"
                            Caption ="Visit Type:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =1
                            GroupTable =1
                            LayoutCachedLeft =540
                            LayoutCachedTop =540
                            LayoutCachedWidth =1710
                            LayoutCachedHeight =855
                        End
                    End
                End
                Begin ComboBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =163
                    TextAlign =1
                    BackStyle =0
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =1770
                    Top =1320
                    Width =2730
                    Height =315
                    TabIndex =4
                    BorderColor =7169897
                    Name ="LocationID"
                    ControlSource ="LocationID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT CameraLocations.LocationID, [StudyAreas].[StudyAreaAbbr] & \" - \" & [Cam"
                        "eraLocations].[LocationName] AS LocName FROM StudyAreas INNER JOIN CameraLocatio"
                        "ns ON StudyAreas.StudyAreaID = CameraLocations.StudyAreaID ORDER BY [StudyAreas]"
                        ".[StudyAreaAbbr] & \" - \" & [CameraLocations].[LocationName];"
                    ColumnWidths ="0;1440"
                    RowGroup =3
                    GroupTable =1

                    LayoutCachedLeft =1770
                    LayoutCachedTop =1320
                    LayoutCachedWidth =4500
                    LayoutCachedHeight =1635
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =540
                            Top =1320
                            Width =1170
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label58"
                            Caption ="Location:"
                            FontName ="Franklin Gothic Book"
                            RowGroup =3
                            GroupTable =1
                            LayoutCachedLeft =540
                            LayoutCachedTop =1320
                            LayoutCachedWidth =1710
                            LayoutCachedHeight =1635
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =204
                    TextAlign =1
                    TextFontFamily =34
                    Left =360
                    Top =120
                    Width =1170
                    Height =315
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="lblVisitInfo"
                    Caption ="Visit Info:"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =360
                    LayoutCachedTop =120
                    LayoutCachedWidth =1530
                    LayoutCachedHeight =435
                End
                Begin OptionGroup
                    SpecialEffect =3
                    BackStyle =0
                    OverlapFlags =93
                    Left =540
                    Top =3360
                    Width =5276
                    Height =838
                    TabIndex =7
                    Name ="optImages"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"

                    LayoutCachedLeft =540
                    LayoutCachedTop =3360
                    LayoutCachedWidth =5816
                    LayoutCachedHeight =4198
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextFontFamily =34
                            Left =360
                            Top =3000
                            Width =5325
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="lblImages"
                            Caption ="Select which images to include:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =360
                            LayoutCachedTop =3000
                            LayoutCachedWidth =5685
                            LayoutCachedHeight =3285
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =660
                            Top =3448
                            OptionValue =1
                            Name ="optAllImages"
                            LayoutCachedLeft =660
                            LayoutCachedTop =3448
                            LayoutCachedWidth =920
                            LayoutCachedHeight =3688
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontCharSet =204
                                    TextFontFamily =34
                                    Left =890
                                    Top =3420
                                    Width =1650
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="lblAllImages"
                                    Caption ="Include all images"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =890
                                    LayoutCachedTop =3420
                                    LayoutCachedWidth =2540
                                    LayoutCachedHeight =3705
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =660
                            Top =3868
                            OptionValue =2
                            Name ="optImageRange"
                            LayoutCachedLeft =660
                            LayoutCachedTop =3868
                            LayoutCachedWidth =920
                            LayoutCachedHeight =4108
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontCharSet =204
                                    TextFontFamily =34
                                    Left =890
                                    Top =3840
                                    Width =1170
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="lblImageRange"
                                    Caption ="Images from"
                                    FontName ="Franklin Gothic Book"
                                    LayoutCachedLeft =890
                                    LayoutCachedTop =3840
                                    LayoutCachedWidth =2060
                                    LayoutCachedHeight =4125
                                End
                            End
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =163
                    TextAlign =1
                    IMESentenceMode =3
                    Left =3780
                    Top =3840
                    Width =1139
                    Height =285
                    TabIndex =8
                    BorderColor =7169897
                    Name ="txtImageTo"
                    DefaultValue ="=[PhotoCount]"
                    RowGroup =5
                    GroupTable =2

                    LayoutCachedLeft =3780
                    LayoutCachedTop =3840
                    LayoutCachedWidth =4919
                    LayoutCachedHeight =4125
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =3420
                            Top =3840
                            Width =300
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="lblImageTo"
                            Caption ="to"
                            FontName ="Franklin Gothic Book"
                            RowGroup =5
                            GroupTable =2
                            LayoutCachedLeft =3420
                            LayoutCachedTop =3840
                            LayoutCachedWidth =3720
                            LayoutCachedHeight =4125
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =163
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2220
                    Top =3840
                    Width =1139
                    Height =285
                    TabIndex =9
                    BorderColor =7169897
                    Name ="txtImageFrom"
                    DefaultValue ="1"

                    LayoutCachedLeft =2220
                    LayoutCachedTop =3840
                    LayoutCachedWidth =3359
                    LayoutCachedHeight =4125
                End
            End
        End
        Begin FormFooter
            Height =660
            BackColor =6108695
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =3840
                    Top =120
                    Width =1920
                    Height =420
                    Name ="cmdCopy"
                    Caption ="Copy Photos"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3840
                    LayoutCachedTop =120
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =540
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =6720
                    Top =120
                    Width =1920
                    Height =420
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =6720
                    LayoutCachedTop =120
                    LayoutCachedWidth =8640
                    LayoutCachedHeight =540
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =215
                    TextAlign =2
                    TextFontFamily =34
                    Width =9360
                    Height =660
                    FontSize =14
                    TopMargin =115
                    BackColor =6108695
                    BorderColor =0
                    ForeColor =-2147483608
                    Name ="lblStatus"
                    Caption ="Initializing..."
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedWidth =9360
                    LayoutCachedHeight =660
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The VisitModule form encountered an error."

'General CopyPhotos variables
Private db As DAO.Database
Private rsPhotos As DAO.Recordset
Private strTargetPath As String

'------------------------------
'Events for form and controls
'------------------------------

Private Sub cmdBrowsePath_Click()
'Browse dialog for selecting destination folder

Dim dlg As Object
Dim strFilePath As String

On Error GoTo ErrHandler

Set dlg = Application.FileDialog(msoFileDialogFolderPicker)
strFilePath = ""

    If dlg.Show = -1 Then
        strFilePath = dlg.SelectedItems(1)
    End If

If Len(strFilePath) > 0 Then
    Me.txtPath = strFilePath
End If
Call txtPath_AfterUpdate

BrowseExit:
    Set dlg = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "The browse dialog triggered an error.", _
        Err.Number, Err.Description, Me.Name
    Resume BrowseExit

End Sub

Private Sub cmdCancel_Click()
'Close the form when cancel button is clicked

On Error GoTo ErrHandler

DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

Private Sub cmdCopy_Click()
'Run the copy procedure

CopyPhotos

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, Me.Name & " Form Help"

End Sub

Private Sub Form_Close()
'Release object variables

ReleaseVars

End Sub

Private Sub Form_Open(Cancel As Integer)
'Test that conditions for opening form are met

On Error GoTo ErrHandler

If TestForm Then
    Cancel = False
Else
    Cancel = True
    ReleaseVars
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

Private Sub optImages_AfterUpdate()

Me.txtImageFrom.Enabled = (Me.optImages = 2)
Me.txtImageTo.Enabled = (Me.optImages = 2)

End Sub

Private Sub txtPath_AfterUpdate()
'Update variable

On Error GoTo ErrHandler

strTargetPath = Nz(Me.txtPath, "")

'Check form for required info
EnableCopy

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub BuildQuery()

Dim strSQL As String

strSQL = "SELECT * FROM qryFilmStrip " & _
    "WHERE (((qryFilmStrip.VisitID)=" & Me.VisitID & ")"

If Me.optImages = 2 Then
    strSQL = strSQL & " AND ((qryFilmStrip.ImageNum)>=" & _
        Nz(Me.txtImageFrom, 1) & ") And ((qryFilmStrip.ImageNum)<=" & _
        Nz(Me.txtImageTo, Me.PhotoCount) & ")"
End If

strSQL = strSQL & ") ORDER BY qryFilmStrip.ImageDate"

SaveQuery "PhotoViewerQuery", strSQL

End Sub

Private Sub CopyPhotos()

Dim lngTotal As Long
Dim i As Long
Dim strSourceFile As String
Dim strDestFile As String
Dim bStayOpen As Boolean

On Error GoTo ErrHandler

ShowCaption "Initializing..."
LockForm
bStayOpen = True

If Me.optImages = 2 Then
    'Refresh query and test recordset
    If Not TestRSPhotos() Then
        GoTo CopyCancel
    End If
End If

'Test for duplicate filenames
If Not TestModDups() Then
    GoTo CopyCancel
End If

'Test for missing photos
If Not TestFiles() Then
    GoTo CopyCancel
End If

'Check for adequate disk space
If Not TestSpace() Then
    GoTo CopyCancel
End If

'Get number of files to copy
rsPhotos.MoveLast
lngTotal = rsPhotos.RecordCount

'Prompt for confirmation
If MsgBox(lngTotal & " image files ready to copy." & vbNewLine & vbNewLine & _
    "Press OK to continue.", vbOKCancel, "Confirm Copy") = vbCancel Then
    MsgBox "Copy Canceled."
    GoTo CopyCancel
End If

'Start module
ShowCaption "Creating module tables..."
CreateModuleTables strTargetPath

'Create target folder
CreateModuleFolders

'Get ready to copy files
i = 0
rsPhotos.MoveFirst

'Process files
Do Until rsPhotos.EOF
    i = i + 1
    ShowCaption "Processing image " & i & " of " & lngTotal & "..."
    strSourceFile = rsPhotos!ImgPath
    strDestFile = GetFileName()
    FileCopy strSourceFile, strDestFile
    DoEvents
    rsPhotos.MoveNext
Loop

'Create module database
strTargetPath = Me.txtPath
ShowCaption "Building runtime database..."
BuildRuntimeDB strTargetPath

'Results message
MsgBox i & " photos successfully copied."
bStayOpen = False

CopyCancel:
    LockForm False
    If Not bStayOpen Then
        DoCmd.Close acForm, "VisitModule", acSaveNo
    End If
    Exit Sub

ErrHandler:
    If Err.Number = -2147024814 Then
        'Too many files in one folder
        strDestFile = HandleOverflow(strDestFile)
        Resume
    End If
    ErrorMsg "An error occurred while copying the photos." & vbNewLine & _
        "Please double check your settings and try again." & vbNewLine & vbNewLine & _
        "If the error occurred partway through the procedure," & vbNewLine & _
        "it may be necessary to clean up some files or data.", _
        Err.Number, Err.Description, Me.Name
    Resume CopyCancel

End Sub

Private Sub CreateModuleFolders()
'Create photos subfolder

strTargetPath = AddSlash(strTargetPath) & "Photos"
If Dir(strTargetPath, vbDirectory) = "" Then
    MkDir strTargetPath
End If

strTargetPath = AddSlash(strTargetPath)

End Sub

Private Sub EnableCopy()
'Enable the action button when requirements are met

Dim bEnabled As Boolean

'Check path
bEnabled = Not IsNull(Me.txtPath)

Me.cmdCopy.Enabled = bEnabled

End Sub

Private Function GetCurrentDB() As Boolean
'Return true if db is initialized

If db Is Nothing Then
    Set db = CurrentDb
End If

GetCurrentDB = Not (db Is Nothing)

End Function

Private Function GetFileName() As String

Dim strNew As String

strNew = rsPhotos!FileName

strNew = AddSlash(strTargetPath) & strNew

If Dir(strNew) <> "" Then
    strNew = GetNextFilename(strNew)
End If

GetFileName = strNew

End Function

Private Function GetRSPhotos() As Boolean
'Return true if recordset is initialized

'Initialize currentdb
If GetCurrentDB Then
    If Not rsPhotos Is Nothing Then
        rsPhotos.Close
    End If
    'Open recordset
    Set rsPhotos = db.OpenRecordset("SELECT * FROM " & _
        "PhotoViewerQuery ORDER BY ImageID", _
        dbOpenDynaset, dbSeeChanges)
End If

GetRSPhotos = Not (rsPhotos Is Nothing)

End Function

Private Function HandleOverflow(strCurrFile As String) As String

strTargetPath = CreateOverflowFolder(strTargetPath)
HandleOverflow = AddSlash(strTargetPath) & ExtractFilename(strCurrFile)

End Function

Private Sub LockForm(Optional bLocked As Boolean = True)
'Prevent changes while code is running and show status

Me.txtFocus.SetFocus
AccessCloseButtonEnabled Not bLocked
Me.cmdCopy.Enabled = Not bLocked
Me.cmdCancel.Enabled = Not bLocked
Me.txtPath.Enabled = Not bLocked
Me.cmdBrowsePath.Enabled = Not bLocked
Me.lblStatus.Visible = bLocked
Me.Repaint
DoEvents

End Sub

Private Sub ReleaseVars()
'Clear rsPhotos and db variables

If Not rsPhotos Is Nothing Then
    rsPhotos.Close
    Set rsPhotos = Nothing
End If

Set db = Nothing

End Sub

Private Sub SetVars()
'Collect form information for variables

strTargetPath = Nz(Me.txtPath, "")

End Sub

Private Sub ShowCaption(strCaption As String)
'Update the progress label

Me.lblStatus.Caption = strCaption
Me.Repaint
DoEvents

End Sub

Private Function TestFiles() As Boolean
'Return true if destination folder exists
'and files are OK

Dim strMsg As String

TestFiles = False

'Check for missing photos
rsPhotos.MoveFirst
Do Until rsPhotos.EOF
    If Len(Dir(rsPhotos!ImgPath)) = 0 Then
        strMsg = "Some of the photos you selected could not be found."
        GoTo TFExit
    Else
        rsPhotos.MoveNext
    End If
Loop

'Check destination folder
If Dir(NoSlash(strTargetPath), vbDirectory) = "" Then
    If MsgBox("The folder you specified doesn't exist." & vbNewLine & _
        vbNewLine & "Do you want to create it?", _
        vbYesNo, "Folder Not Found") = vbNo Then
        strMsg = "You chose to cancel the operation."
        GoTo TFExit
    Else
        MkDir NoSlash(strTargetPath)
    End If
Else
    If Dir(AddSlash(strTargetPath) & "*") <> "" Then
        strMsg = "Modules can only be created in a new, empty folder."
        GoTo TFExit
    End If
End If

TestFiles = True

TFExit:
    'Show message if test failed
    If TestFiles = False Then
        MsgBox strMsg, vbExclamation, "Copy Canceled."
    End If

End Function

Private Function TestForm() As Boolean
'Check that form is OK to open

'Check for PhotoViewer form
If IsLoaded("PhotoViewer") Then
    DoCmd.Close acForm, "PhotoViewer", acSaveNo
End If

'Check that recordset can be initialized and contains records
If TestRSPhotos Then
    TestForm = True
    SetVars
Else
    TestForm = False
End If

End Function

Private Function TestModDups() As Boolean
'Check for duplicate filenames and prompt to rename

If DCount("*", "CopyTestDupFileNames") = 0 Then
    TestModDups = True
Else
    TestModDups = False
    MsgBox "You cannot include multiple files with the " & _
        vbNewLine & "same file name in a data module." & _
        vbNewLine & vbNewLine & "Please select different photos or " & _
        "select " & vbNewLine & "the option to rename " & _
        "the image files.", vbExclamation, "Copy canceled."
End If

End Function

Private Function TestRSPhotos() As Boolean
'Return true if RSPhotos is loaded and has records

TestRSPhotos = False

BuildQuery

If GetRSPhotos Then
    If (rsPhotos.BOF And rsPhotos.BOF) Then
        MsgBox "No photos selected", vbExclamation, _
            "Copy canceled."
    Else
        TestRSPhotos = True
    End If
Else
    MsgBox "An error occurred retrieving the " & _
        "filenames from PhotoViewerQuery.", _
        vbExclamation, "Copy canceled."
End If

End Function

Private Function TestSpace() As Boolean
'Check for adequate space on destination drive

Dim dblMBReqd As Double
Dim strDrive As String
Dim dblMBAvail As Double

On Error GoTo ErrHandler

'Default to true
TestSpace = True

'Calculate space required
dblMBReqd = PhotosSize()
dblMBReqd = dblMBReqd + FileLen(CurrentDb.Name) / 1000000

'Calculate space available
strDrive = Left(Me.txtPath, 1)
dblMBAvail = DiskSpace(strDrive)

'Compare and provide a message if there isn't enough disk space
If dblMBAvail > 0 And dblMBReqd > 0 Then
    If dblMBReqd > dblMBAvail Then
        TestSpace = False
        MsgBox "There isn't enough space on drive " & strDrive & "." & _
            vbNewLine & "Space required: " & Format(dblMBReqd, "#,##0.00") & _
            " Mb", vbExclamation, "Copy Canceled"
    End If
End If

Exit Function

ErrHandler:
    TestSpace = True

End Function
