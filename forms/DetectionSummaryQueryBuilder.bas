Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ViewsAllowed =1
    TabularCharSet =163
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =11520
    DatasheetFontHeight =11
    ItemSuffix =85
    Right =20595
    Bottom =14325
    RecSrcDt = Begin
        0xc9986d622d66e440
    End
    Caption ="DetectionSummaryQueryBuilder"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =163
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =163
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =585
            BackColor =6108695
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =60
                    Top =60
                    Width =7680
                    Height =525
                    FontSize =20
                    BackColor =6108695
                    BorderColor =5029044
                    ForeColor =-2147483608
                    Name ="Label2"
                    Caption ="Detection Summary Query Builder"
                    FontName ="Trebuchet MS"
                    GridlineColor =0
                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =7740
                    LayoutCachedHeight =585
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =11040
                    Top =120
                    Width =366
                    Height =366
                    Name ="cmdHelp"
                    Caption ="Help"
                    StatusBarText ="Help"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Help"
                    HorizontalAnchor =1
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End
                    BackStyle =0

                    LayoutCachedLeft =11040
                    LayoutCachedTop =120
                    LayoutCachedWidth =11406
                    LayoutCachedHeight =486
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =8880
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =2040
                    Width =2760
                    Height =285
                    TabIndex =1
                    BorderColor =7169897
                    Name ="cboSpecies"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT Species.SpeciesID, First(Species.CommonName) AS FirstOfCommonName FROM Sp"
                        "ecies INNER JOIN IndependentDetections ON Species.SpeciesID = IndependentDetecti"
                        "ons.SpeciesID GROUP BY Species.SpeciesID HAVING (((Species.SpeciesID)>0)) ORDER "
                        "BY First(Species.CommonName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2040
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =2325
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =900
                            Top =2040
                            Width =1799
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpecies_Label"
                            Caption ="Filter by species:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =900
                            LayoutCachedTop =2040
                            LayoutCachedWidth =2699
                            LayoutCachedHeight =2325
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    TextFontFamily =34
                    Left =2880
                    Top =2370
                    Width =2760
                    TabIndex =3
                    Name ="cmdMultiSp"
                    Caption ="Select Multiple Species"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2370
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =2730
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =255
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =2040
                    Width =2490
                    Height =285
                    TabIndex =2
                    BorderColor =7169897
                    Name ="txtMultiSp"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2040
                    LayoutCachedWidth =5370
                    LayoutCachedHeight =2325
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =3300
                    Width =7502
                    Height =1917
                    TabIndex =5
                    Name ="Frame100"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =3300
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =5217
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =3180
                            Width =1440
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label101"
                            Caption ="Location Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =3180
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =3465
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =3870
                    Width =2519
                    Height =285
                    TabIndex =7
                    BorderColor =7169897
                    Name ="txtNorthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3870
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4155
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =3870
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtNorthOfUTM_Label1"
                            Caption ="North of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =3870
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4155
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4199
                    Width =2519
                    Height =285
                    TabIndex =8
                    BorderColor =7169897
                    Name ="txtSouthOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="0000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4199
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4484
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4199
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtSouthOfUTM_Label1"
                            Caption ="South of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4199
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4484
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =3540
                    Width =2519
                    Height =285
                    TabIndex =6
                    BorderColor =7169897
                    Name ="cboStudyArea"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT StudyAreas.StudyAreaID, First(StudyAreas.StudyAreaName) AS FirstOfStudyAr"
                        "eaName FROM (StudyAreas INNER JOIN CameraLocations ON StudyAreas.StudyAreaID = C"
                        "ameraLocations.StudyAreaID) INNER JOIN IndependentDetections ON CameraLocations."
                        "LocationID = IndependentDetections.LocationID GROUP BY StudyAreas.StudyAreaID OR"
                        "DER BY First(StudyAreas.StudyAreaName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="=DisableButtons()"
                    Tag ="2: 1.9486/.2188"
                    AllowValueListEdits =0

                    LayoutCachedLeft =2880
                    LayoutCachedTop =3540
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =3825
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =3540
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboStudyArea_Label"
                            Caption ="Study Area:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =3540
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =3825
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4529
                    Width =2519
                    Height =285
                    TabIndex =9
                    BorderColor =7169897
                    Name ="txtEastOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4529
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =4814
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4529
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtEastOfUTM_Label1"
                            Caption ="East of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4529
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =4814
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =4859
                    Width =2519
                    Height =285
                    TabIndex =10
                    BorderColor =7169897
                    Name ="txtWestOfUTM"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    InputMask ="000000"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =4859
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =5144
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =4859
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtWestOfUTM_Label1"
                            Caption ="West of:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =4859
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5144
                        End
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =3870
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtNorthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =3870
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =4155
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4199
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtSouthOfUTM_Label2"
                    Caption ="(Enter UTM Northing)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4199
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =4484
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4529
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtEastOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4529
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =4814
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =5460
                    Top =4859
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtWestOfUTM_Label2"
                    Caption ="(Enter UTM Easting)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =4859
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =5144
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =5400
                    Width =7502
                    Height =1257
                    TabIndex =11
                    Name ="Frame22"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =5400
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =6657
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =5280
                            Width =1140
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label23"
                            Caption ="Date Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =5280
                            LayoutCachedWidth =1380
                            LayoutCachedHeight =5565
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =5970
                    Width =2519
                    Height =285
                    TabIndex =12
                    BorderColor =7169897
                    Name ="txtStartDate"
                    Format ="Short Date"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =5970
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6255
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =840
                            Top =5970
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtStartDate_Label"
                            Caption ="Images between:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =5970
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6255
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    TextFontCharSet =204
                    IMESentenceMode =3
                    Left =2880
                    Top =6299
                    Width =2519
                    Height =285
                    TabIndex =13
                    BorderColor =7169897
                    Name ="txtEndDate"
                    Format ="Short Date"
                    AfterUpdate ="=DisableButtons()"
                    OnEnter ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    Tag ="2: 1.9486/.2188"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =6299
                    LayoutCachedWidth =5399
                    LayoutCachedHeight =6584
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =6299
                            Width =1860
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="txtEndDate_Label"
                            Caption ="And:"
                            FontName ="Franklin Gothic Book"
                            Tag ="2: 1.9486/.1979"
                            LayoutCachedLeft =840
                            LayoutCachedTop =6299
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =6584
                        End
                    End
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    TextFontFamily =34
                    Left =1740
                    Top =5640
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="Label38"
                    Caption ="Absolute Date Filters"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =1740
                    LayoutCachedTop =5640
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =5925
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    TextFontFamily =34
                    Left =5460
                    Top =5970
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtStartDate_Label2"
                    Caption ="(Enter start date)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =5970
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =6255
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =3
                    TextFontFamily =34
                    Left =5460
                    Top =6299
                    Width =2040
                    Height =285
                    BackColor =16252927
                    ForeColor =7169897
                    Name ="txtEndDate_Label2"
                    Caption ="(Enter end date)"
                    FontName ="Franklin Gothic Book"
                    LayoutCachedLeft =5460
                    LayoutCachedTop =6299
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =6584
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =6837
                    Width =7502
                    Height =897
                    TabIndex =14
                    Name ="Frame46"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =6837
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =7734
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =6720
                            Width =1575
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label47"
                            Caption ="Additional Fields:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =6720
                            LayoutCachedWidth =1815
                            LayoutCachedHeight =7005
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =7080
                    Width =360
                    Height =270
                    TabIndex =15
                    Name ="chkInclUTM"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =1
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =7080
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =7350
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =7080
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclUTM_Label"
                            Caption ="UTM Fields"
                            FontName ="Franklin Gothic Book"
                            RowGroup =1
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =7080
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =7350
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =2760
                    Top =7410
                    Width =360
                    Height =270
                    TabIndex =16
                    Name ="chkInclLatLong"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="0"
                    RowGroup =2
                    GroupTable =9

                    LayoutCachedLeft =2760
                    LayoutCachedTop =7410
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =7680
                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =1
                            TextFontFamily =34
                            Left =840
                            Top =7410
                            Width =1860
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="chkInclLatLong_Label"
                            Caption ="Lat/Long Fields"
                            FontName ="Franklin Gothic Book"
                            RowGroup =2
                            GroupTable =9
                            LayoutCachedLeft =840
                            LayoutCachedTop =7410
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =7680
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5040
                    Top =7860
                    Width =1920
                    Height =420
                    TabIndex =17
                    Name ="cmdExport"
                    Caption ="Export"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5040
                    LayoutCachedTop =7860
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =8280
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =960
                    Top =7860
                    Width =1920
                    Height =420
                    TabIndex =18
                    Name ="cmdQuery"
                    Caption ="Open Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =960
                    LayoutCachedTop =7860
                    LayoutCachedWidth =2880
                    LayoutCachedHeight =8280
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =8400
                    Width =1920
                    Height =420
                    TabIndex =19
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =8400
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =8820
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3000
                    Top =7860
                    Width =1920
                    Height =420
                    TabIndex =20
                    Name ="cmdSave"
                    Caption ="Save Query"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =3000
                    LayoutCachedTop =7860
                    LayoutCachedWidth =4920
                    LayoutCachedHeight =8280
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5520
                    Top =120
                    Width =2100
                    TabIndex =4
                    Name ="cmdUpdate"
                    Caption ="Update Results"
                    OnClick ="=RefreshResults()"
                    FontName ="Trebuchet MS"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5520
                    LayoutCachedTop =120
                    LayoutCachedWidth =7620
                    LayoutCachedHeight =480
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    BackStyle =0
                    OverlapFlags =255
                    Left =120
                    Top =1800
                    Width =7502
                    Height =1317
                    TabIndex =21
                    Name ="Frame80"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =1800
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =3117
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =240
                            Top =1680
                            Width =1440
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label81"
                            Caption ="Species Filters:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =1680
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =1965
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =247
                    TextFontCharSet =204
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2880
                    Top =2775
                    Width =2760
                    Height =285
                    TabIndex =22
                    BorderColor =7169897
                    Name ="cboSpeciesGroup"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT SpeciesGroups.GroupID, First(SpeciesGroups.GroupName) AS FirstOfGroupName"
                        " FROM SpeciesGroups INNER JOIN Species ON SpeciesGroups.GroupID = Species.GroupI"
                        "D GROUP BY SpeciesGroups.GroupID ORDER BY First(SpeciesGroups.GroupName);"
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =2880
                    LayoutCachedTop =2775
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =3060
                    Begin
                        Begin Label
                            OverlapFlags =247
                            TextFontFamily =34
                            Left =900
                            Top =2775
                            Width =1799
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="cboSpeciesGroup_Label"
                            Caption ="Filter by Group:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =900
                            LayoutCachedTop =2775
                            LayoutCachedWidth =2699
                            LayoutCachedHeight =3060
                        End
                    End
                End
                Begin Subform
                    CanGrow = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =7920
                    Top =360
                    Width =3480
                    Height =8400
                    TabIndex =23
                    Name ="ResultsSubform"
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =7920
                    LayoutCachedTop =360
                    LayoutCachedWidth =11400
                    LayoutCachedHeight =8760
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextFontFamily =34
                            Left =7920
                            Top =120
                            Width =1440
                            Height =270
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="ResultsSubform_Label"
                            Caption ="Results Preview:"
                            FontName ="Franklin Gothic Book"
                            LayoutCachedLeft =7920
                            LayoutCachedTop =120
                            LayoutCachedWidth =9360
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin OptionGroup
                    BackStyle =0
                    OverlapFlags =85
                    Left =120
                    Top =660
                    Width =7502
                    Height =958
                    TabIndex =24
                    Name ="optFormat"
                    AfterUpdate ="=DisableButtons()"
                    DefaultValue ="1"
                    Tag ="3: 2.7083/.6549"

                    LayoutCachedLeft =120
                    LayoutCachedTop =660
                    LayoutCachedWidth =7622
                    LayoutCachedHeight =1618
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextFontFamily =34
                            Left =240
                            Top =540
                            Width =1260
                            Height =285
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Label59"
                            Caption ="Query Format:"
                            FontName ="Franklin Gothic Book"
                            Tag ="3: 2.625/.1979"
                            LayoutCachedLeft =240
                            LayoutCachedTop =540
                            LayoutCachedWidth =1500
                            LayoutCachedHeight =825
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =928
                            OptionValue =1
                            Name ="Option61"
                            Tag ="3: 2.8736/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =928
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1168
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =825
                                    Top =900
                                    Width =2880
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label62"
                                    Caption ="All Detections"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 2.8542/.1979"
                                    LayoutCachedLeft =825
                                    LayoutCachedTop =900
                                    LayoutCachedWidth =3705
                                    LayoutCachedHeight =1185
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =600
                            Top =1258
                            OptionValue =2
                            Name ="Option63"
                            Tag ="3: 3.1028/.1667"
                            LayoutCachedLeft =600
                            LayoutCachedTop =1258
                            LayoutCachedWidth =860
                            LayoutCachedHeight =1498
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    TextFontFamily =34
                                    Left =825
                                    Top =1230
                                    Width =2715
                                    Height =285
                                    BackColor =16252927
                                    ForeColor =7169897
                                    Name ="Label64"
                                    Caption ="Totals by Species/Location"
                                    FontName ="Franklin Gothic Book"
                                    Tag ="3: 3.0833/.1979"
                                    LayoutCachedLeft =825
                                    LayoutCachedTop =1230
                                    LayoutCachedWidth =3540
                                    LayoutCachedHeight =1515
                                End
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The DetectionSummary form encountered an error."

Private Sub cboSpecies_AfterUpdate()
'disable group combo

On Error GoTo ErrHandler

DisableButtons

If Not IsNull(Me.cboSpecies) Then
    Me.cboStudyArea.SetFocus
End If

Me.cmdMultiSp.Enabled = IsNull(Me.cboSpecies)
Me.cboSpeciesGroup.Enabled = IsNull(Me.cboSpecies)

ErrHandler:
    Exit Sub

End Sub

Private Sub cboSpeciesGroup_AfterUpdate()
'Disable species filters

On Error GoTo ErrHandler

DisableButtons

If Not IsNull(Me.cboSpeciesGroup) Then
    Me.cboStudyArea.SetFocus
End If

Me.cmdMultiSp.Enabled = IsNull(Me.cboSpeciesGroup)
Me.cboSpecies.Enabled = IsNull(Me.cboSpeciesGroup)

ErrHandler:
    Exit Sub

End Sub

Private Sub cmdClose_Click()
'Close the form

On Error GoTo ErrHandler

Me.ResultsSubform.SourceObject = ""
DoCmd.Close
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdExport_Click()
'Open the form for exporting quieries

On Error GoTo ErrHandler

DoCmd.OpenForm "ExportQuery", , , _
    "QueryName='DetectionSummaryQuery'", , acDialog, GetSettings()
Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the export form.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdHelp_Click()
'Display help message

HelpMsg Me.Name, "Detection Summary Query Help"

End Sub

Private Sub cmdMultiSp_Click()
'Allows user to select multiple species

Me.cboSpecies = Null
Me.cboSpeciesGroup = Null

If Me.cmdMultiSp.Caption = "Remove Multi-Species Filter" Then
    Me.cboSpecies.Tag = ""
    Me.cboSpecies.Enabled = True
    Me.cboSpecies.SetFocus
    Me.cboSpeciesGroup.Enabled = True
    Me.txtMultiSp = Null
    Me.txtMultiSp.Visible = False
    Me.cmdMultiSp.Caption = "Select Multiple Species"
Else
    'Create temporary table
    SpSelectTable
    'Go to selection form
    DoCmd.OpenForm "SpeciesTemp", , , , , acDialog, "DetSummary"
    If Len(Me.cboSpecies.Tag) > 0 Then
        Me.cmdMultiSp.Caption = "Remove Multi-Species Filter"
        Me.cmdMultiSp.SetFocus
        Me.cboSpecies.Enabled = False
        Me.cboSpeciesGroup.Enabled = False
        Me.txtMultiSp = "(Multiple)"
        Me.txtMultiSp.Visible = True
    End If
End If

DisableButtons
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub cmdQuery_Click()
'Open the query results in a separate tab

On Error GoTo ErrHandler

DoCmd.OpenQuery "DetectionSummaryQuery"

Exit Sub

ErrHandler:
    ErrorMsg "There was an error opening the query.", _
        Err.Number, Err.Description

End Sub

Private Sub cmdSave_Click()
'Saves a new query in the database

Dim strQryName As String
Dim lngObjID As Long
Dim lngGroupID As Long

On Error GoTo ErrHandler

'Prompt for name
strQryName = InputBox("Enter a name for the new query:")
SaveQuery strQryName, _
    CurrentDb.QueryDefs("DetectionSummaryQuery").SQL

'Add the query to the My Queries nav pane group
lngObjID = Nz(DLookup("ID", "MSysObjects", "Name='" & _
    strQryName & "'"), 0)
lngGroupID = Nz(DLookup("ID", "MSysNavPaneGroups", "Name='" & _
    "My Queries'"), 0)
If lngObjID <> 0 And lngGroupID <> 0 Then
    DoCmd.SetWarnings False
    DoCmd.RunSQL "INSERT INTO MSysNavPaneGroupToObjects " & _
        "( GroupID, ObjectID ) VALUES ( " & lngGroupID & _
        ", " & lngObjID & " )"
End If

CSExit:
    DoCmd.SetWarnings True
    Exit Sub

ErrHandler:
    ErrorMsg "An error occurred while saving the query.", _
        Err.Number, Err.Description
    Resume CSExit

End Sub

Private Sub Form_Close()
'Restore switchboard

RestoreSwitchboard

End Sub

Private Sub Form_Open(Cancel As Integer)
'Minimize switchboard

On Error GoTo ErrHandler

HideSwitchboard acForm, Me.Name
BuildQuery
RefreshResults
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description

End Sub

Private Sub txtEastOfUTM_Enter()
'Show label with guidance text

Me.txtEastOfUTM_Label2.Visible = True

End Sub

Private Sub txtEastOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtEastOfUTM_Label2.Visible = False

End Sub

Private Sub txtEndDate_Enter()
'Show label with guidance text

Me.txtEndDate_Label2.Visible = True

End Sub

Private Sub txtEndDate_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtEndDate_Label2.Visible = False

End Sub

Private Sub txtNorthOfUTM_Enter()
'Show label with guidance text

Me.txtNorthOfUTM_Label2.Visible = True

End Sub

Private Sub txtNorthOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtNorthOfUTM_Label2.Visible = False

End Sub

Private Sub txtSouthOfUTM_Enter()
'Show label with guidance text

Me.txtSouthOfUTM_Label2.Visible = True

End Sub

Private Sub txtSouthOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtSouthOfUTM_Label2.Visible = False

End Sub

Private Sub txtStartDate_Enter()
'Show label with guidance text

Me.txtStartDate_Label2.Visible = True

End Sub

Private Sub txtStartDate_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtStartDate_Label2.Visible = False

End Sub

Private Sub txtWestOfUTM_Enter()
'Show label with guidance text

Me.txtWestOfUTM_Label2.Visible = True

End Sub

Private Sub txtWestOfUTM_Exit(Cancel As Integer)
'Hide label with guidance text

Me.txtWestOfUTM_Label2.Visible = False

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub BuildQuery()
'Updates the SQL for the detection query

Dim strSelect As String
Dim strDate As String
Dim strFrom As String
Dim strWhere As String
Dim strGroup As String
Dim strOrder As String
Dim strSubQuery As String
Dim strSQL As String

Const strQGroup As String = "(SELECT IndependentDetections.IndDetectionID, " & _
    "Nz(Sum(IndDetGroups.Individuals),0) AS TotalIndividuals, " & _
    "Sum(IIf([AgeClassID]=1,[Individuals],0)) AS TotalAdults, " & _
    "Sum(IIf([AgeClassID]=2,[Individuals],0)) AS TotalJuveniles, " & _
    "Sum(IIf([AgeClassID]=3,[Individuals],0)) AS TotalSubadults, " & _
    "Sum(IIf([GenderID]=1,[Individuals],0)) AS TotalFemales, " & _
    "Sum(IIf([GenderID]=2,[Individuals],0)) AS TotalMales " & _
    "FROM IndependentDetections LEFT JOIN " & _
    "IndDetGroups ON " & _
    "IndependentDetections.IndDetectionID = IndDetGroups.IndDetectionID " & _
    "GROUP BY IndependentDetections.IndDetectionID) As qGroup"

Const strQKnown As String = "(SELECT IndependentDetections.IndDetectionID, " & _
    "Sum(IIf(IndividualDetections.IndividualID>0,1,0)) AS KnownIndividuals " & _
    "FROM IndependentDetections LEFT JOIN " & _
    "IndividualDetections ON " & _
    "IndependentDetections.IndDetectionID = IndividualDetections.IndDetectionID " & _
    "GROUP BY IndependentDetections.IndDetectionID) As qKnown "

'Get date filters
If Not IsNull(Me.txtStartDate) Then
    strDate = "IndependentDetections.ModifiedStart >= #" & _
        USDate(Me.txtStartDate) & "#"
End If
If Not IsNull(Me.txtEndDate) Then
    If Len(strDate) > 0 Then
        strDate = strDate & " AND "
    End If
    strDate = strDate & "IndependentDetections.ModifiedStart < #" & _
        USDate(DateAdd("d", 1, Me.txtEndDate)) & "#"
End If

'Start with subquery
strSelect = "SELECT IndependentDetections.SpeciesID, " & _
    "IndependentDetections.LocationID, "
If Me.optFormat = 1 Then
    strSelect = strSelect & "IndependentDetections.ModifiedStart As " & _
        "StartDateTime, qGroup.TotalIndividuals, qGroup.TotalAdults, " & _
        "qGroup.TotalJuveniles, qGroup.TotalSubadults, qGroup.TotalMales, " & _
        "qGroup.TotalMales, qGroup.TotalFemales, qKnown.KnownIndividuals As " & _
        "TotalKnownInd "
Else
    If Len(strDate) > 0 Then
        strSelect = strSelect & "Sum(IIf(" & strDate & ",1,0)) As Detections, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalIndividuals,0)) As TotalIndividuals, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalAdults,0)) As TotalAdults, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalJuveniles,0)) As TotalJuveniles, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalSubadults,0)) As TotalSubadults, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalMales,0)) As TotalMales, " & _
            "Sum(IIf(" & strDate & ",qGroup.TotalFemales,0)) As TotalFemales, " & _
            "Sum(IIf(" & strDate & ",qKnown.KnownIndividuals,0)) As TotalKnownInd "
    Else
        strSelect = strSelect & "Count(IndependentDetections.IndDetectionID) As Detections, " & _
            "Sum(qGroup.TotalIndividuals) As TotalIndividuals, " & _
            "Sum(qGroup.TotalAdults) As TotalAdults, " & _
            "Sum(qGroup.TotalJuveniles) As TotalJuveniles, " & _
            "Sum(qGroup.TotalSubadults) As TotalSubadults, " & _
            "Sum(qGroup.TotalMales) As TotalMales, " & _
            "Sum(qGroup.TotalFemales) As TotalFemales, " & _
            "Sum(qKnown.KnownIndividuals) As TotalKnownInd "
    End If
End If

strFrom = "FROM (IndependentDetections INNER JOIN " & strQGroup & _
    " ON IndependentDetections.IndDetectionID = qGroup.IndDetectionID) " & _
    "INNER JOIN " & strQKnown & " ON " & _
    "IndependentDetections.IndDetectionID = qKnown.IndDetectionID "

If Me.optFormat = 1 And Len(strDate) > 0 Then
    strWhere = Replace(strDate, " AND ", ") AND ((")
    strWhere = " AND ((" & Replace(strWhere, " <", ") <") & ")"
    strWhere = Replace(strWhere, " >", ") >")
End If

strWhere = "WHERE (((IndependentDetections.Deleted)=False)" & strWhere & ")"
If Me.optFormat = 2 Then
    strGroup = " GROUP BY IndependentDetections.SpeciesID, IndependentDetections.LocationID"
End If
strSubQuery = "(" & strSelect & strFrom & strWhere & strGroup & ") As qSub"

If Me.optFormat = 2 Then
    'Add unique individuals subquery
    strSelect = "SELECT IndependentDetections.SpeciesID, " & _
        "IndependentDetections.LocationID, IndividualDetections.IndividualID "
    strFrom = "FROM IndependentDetections LEFT JOIN IndividualDetections ON " & _
        "IndependentDetections.IndDetectionID = IndividualDetections.IndDetectionID "
    If Len(strDate) > 0 Then
        strFrom = strFrom & " WHERE (" & strDate & ") "
    End If
    strGroup = "GROUP BY IndependentDetections.SpeciesID, " & _
        "IndependentDetections.LocationID, IndividualDetections.IndividualID"
    strFrom = "FROM (" & strSelect & strFrom & strGroup & ") As qU "
    strSelect = "SELECT qU.SpeciesID, qU.LocationID, Sum(IIf(" & _
        "qU.IndividualID > 0,1,0)) As UniqueInd "
    strGroup = "GROUP BY qU.SpeciesID, qU.LocationID"
    strSubQuery = "(" & strSubQuery & " INNER JOIN (" & _
        strSelect & strFrom & strGroup & ") As qUnique " & _
        "ON qSub.SpeciesID = qUnique.SpeciesID AND " & _
        "qSub.LocationID = qUnique.LocationID)"
End If

'Get date filter again
If Len(strDate) > 0 Then
    If IsNull(Me.txtStartDate) Then
        'End date only
        strDate = "IIf(ActiveEnd > #" & USDate(DateAdd("d", 1, _
            Me.txtEndDate)) & "#,#" & USDate(DateAdd("d", 1, _
            Me.txtEndDate)) & "#,ActiveEnd) - " & _
            "IIf(ActiveStart < #" & USDate(DateAdd("d", 1, _
            Me.txtEndDate)) & "#,ActiveStart,#" & _
            USDate(DateAdd("d", 1, Me.txtEndDate)) & "#)"
    Else
        If IsNull(Me.txtEndDate) Then
            'Start date only
            strDate = "IIf(ActiveEnd > #" & USDate(Me.txtStartDate) & _
                "#,ActiveEnd,#" & USDate(Me.txtStartDate) & "#) - " & _
                "IIf(ActiveStart < #" & USDate(Me.txtStartDate) & _
                "#,#" & USDate(Me.txtStartDate) & "#,ActiveStart)"
        Else
            'Start and end dates
            strDate = "IIf(ActiveEnd > #" & USDate(DateAdd("d", 1, _
                Me.txtEndDate)) & "#,#" & USDate(DateAdd("d", 1, _
                Me.txtEndDate)) & "#,IIf(ActiveEnd > #" & _
                USDate(Me.txtStartDate) & "#,ActiveEnd,#" & _
                USDate(Me.txtStartDate) & "#)) - " & _
                "IIf(ActiveStart < #" & _
                USDate(Me.txtStartDate) & "#,#" & _
                USDate(Me.txtStartDate) & "#,IIf(ActiveStart < #" & _
                USDate(DateAdd("d", 1, Me.txtEndDate)) & _
                "#,ActiveStart,#" & USDate(DateAdd("d", 1, _
                Me.txtEndDate)) & "#))"
        End If
    End If
Else
    strDate = "ActiveEnd - ActiveStart"
End If

'Start main query
strSelect = "SELECT StudyAreas.StudyAreaName AS StudyArea, " & _
    "CameraLocations.LocationName AS Location, Species.CommonName AS Species, "
If Me.optFormat = 1 Then
    strSelect = strSelect & "qSub.StartDateTime, "
Else
    strSelect = strSelect & "qSub.Detections, "
End If
strSelect = strSelect & "qSub.TotalIndividuals, qSub.TotalAdults, qSub.TotalJuveniles, " & _
    "qSub.TotalSubadults, qSub.TotalFemales, qSub.TotalMales, qSub.TotalKnownInd, "
If Me.optFormat = 2 Then
    strSelect = strSelect & "qUnique.UniqueInd, (SELECT Round(Sum(" & _
        strDate & "),3) FROM Visits WHERE LocationID = [CameraLocations].[LocationID] AND " & _
        "ActiveStart Is Not Null AND ActiveEnd Is Not Null) As TrapNights, "
End If

'Add additional fields
If Me.chkInclUTM.Value = True Then
    strSelect = strSelect & "CameraLocations.UTM_E, " & _
        "CameraLocations.UTM_N, CameraLocations.UTMZone, "
End If
If Me.chkInclLatLong.Value = True Then
    strSelect = strSelect & "CameraLocations.LatitudeDD, " & _
        "CameraLocations.LongitudeDD, "
End If

'Finish select clause
strSelect = Left(strSelect, Len(strSelect) - 2) & " "

'Get from clause
strFrom = "FROM StudyAreas INNER JOIN (CameraLocations INNER JOIN (Species INNER JOIN " & _
    strSubQuery & " ON Species.SpeciesID = qSub.SpeciesID) ON " & _
    "CameraLocations.LocationID = qSub.LocationID) ON " & _
    "StudyAreas.StudyAreaID = CameraLocations.StudyAreaID"

strWhere = ""

'Add species filters
If Not IsNull(Me.cboSpecies) Then
    strWhere = "((Species.SpeciesID)=" & Me.cboSpecies & ") AND "
Else
    If Len(Nz(Me.cboSpecies.Tag, "")) > 0 Then
        strWhere = "((Species.SpeciesID) In(" & Me.cboSpecies.Tag & ")) AND "
    Else
        If Not IsNull(Me.cboSpeciesGroup) Then
            strWhere = "((Species.GroupID)=" & Me.cboSpeciesGroup & ") AND "
        End If
    End If
End If

'Add location filters
If Not IsNull(Me.cboStudyArea) Then
    strWhere = strWhere & "((StudyAreas.StudyAreaID)=" & _
        Me.cboStudyArea & ") AND "
End If
If Not IsNull(Me.txtNorthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N)>=" & _
        Me.txtNorthOfUTM & ") AND "
End If
If Not IsNull(Me.txtSouthOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_N)<=" & _
        Me.txtSouthOfUTM & ") AND "
End If
If Not IsNull(Me.txtEastOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E)>=" & _
        Me.txtEastOfUTM & ") AND "
End If
If Not IsNull(Me.txtWestOfUTM) Then
    strWhere = strWhere & "((CameraLocations.UTM_E)>=" & _
        Me.txtWestOfUTM & ") AND "
End If

'Finish where clause
If Len(strWhere) > 0 Then
    strWhere = Left(strWhere, Len(strWhere) - 5)
    strWhere = " WHERE (" & strWhere & ")"
End If

'Get order by clause
strOrder = " ORDER BY Species.CommonName, StudyAreas.StudyAreaName, " & _
    "CameraLocations.LocationName"
If Me.optFormat = 1 Then
    strOrder = strOrder & ", qSub.StartDateTime"
End If

'Assemble SQL statement
strSQL = strSelect & strFrom & strWhere & strOrder & ";"

'Replace query SQL
SaveQuery "DetectionSummaryQuery", strSQL

End Sub

Private Function DisableButtons() As Integer
'Disable output when data is not up to date

Dim strAC As String

On Error Resume Next
strAC = Me.ActiveControl.Name

On Error GoTo 0

If strAC = "cmdSave" Or strAC = "cmdExport" Or _
    strAC = "cmdQuery" Then
    Me.txtFocus.SetFocus
End If

Me.cmdSave.Enabled = False
Me.cmdExport.Enabled = False
Me.cmdQuery.Enabled = False
Me.cmdUpdate.Visible = True

End Function

Private Function GetSettings() As String
'Returns settings string for export

Dim strSpecies As String
Dim strSettings As String

strSettings = ""

'Get species settings
If Len(Nz(Me.cboSpecies.Tag, 0)) > 0 Then
    'Multiple species, get IDs from tag property
    strSpecies = Me.cboSpecies.Tag
    'Loop through IDS to get common name
    Do Until InStr(1, strSpecies, ",") = 0
        strSettings = strSettings & DLookup("CommonName", "Species", _
            "SpeciesID=" & Left(strSpecies, InStr(1, strSpecies, _
            ",") - 1)) & ", "
        strSpecies = Mid(strSpecies, InStr(1, strSpecies, ",") + 1)
    Loop
    'Remove final comma
    strSettings = Left(strSettings, Len(strSettings) - 2)
    'Add final species
    strSettings = strSettings & " and " & DLookup("CommonName", _
        "Species", "SpeciesID=" & strSpecies) & "; "
Else
    If Not IsNull(Me.cboSpecies) Then
        'Single species, get common name from dropdown
        strSettings = strSettings & Me.cboSpecies.Column(1) & "; "
    Else
        If Not IsNull(Me.cboSpeciesGroup) Then
            'Species group, get name from dropdown
            strSettings = strSettings & Me.cboSpeciesGroup.Column(1) & "; "
        End If
    End If
End If

'Add location filters
If Not IsNull(Me.cboStudyArea) Then
    strSettings = strSettings & "study area = " & _
        Me.cboStudyArea.Column(1) & "; "
End If
If Not IsNull(Me.txtNorthOfUTM) Then
    strSettings = strSettings & "north of " & _
        Me.txtNorthOfUTM & "; "
End If
If Not IsNull(Me.txtSouthOfUTM) Then
    strSettings = strSettings & "south of " & _
        Me.txtSouthOfUTM & "; "
End If
If Not IsNull(Me.txtEastOfUTM) Then
    strSettings = strSettings & "east of " & _
        Me.txtEastOfUTM & "; "
End If
If Not IsNull(Me.txtWestOfUTM) Then
    strSettings = strSettings & "west of " & _
        Me.txtWestOfUTM & "; "
End If

'Add date filters
If Not IsNull(Me.txtStartDate) Then
    strSettings = strSettings & "on or after " & _
        Me.txtStartDate & "; "
End If
If Not IsNull(Me.txtEndDate) Then
    strSettings = strSettings & "on or before " & _
        Me.txtEndDate & "; "
End If

If Len(strSettings) > 0 Then
    'Remove final semicolon and space
    strSettings = Left(strSettings, Len(strSettings) - 2)
Else
    strSettings = "No filters"
End If
GetSettings = strSettings

End Function

Private Function RefreshResults() As Integer
'Edit query definition and display new results in preview pane

Dim strAC As String

On Error Resume Next
strAC = Me.ActiveControl.Name

On Error GoTo 0

'Update query results and enable output buttons
Me.ResultsSubform.SourceObject = ""
BuildQuery
Me.ResultsSubform.SourceObject = "query.DetectionSummaryQuery"
Me.cmdQuery.Enabled = True
Me.cmdExport.Enabled = True
Me.cmdSave.Enabled = True

'Disable update button
If strAC = "cmdUpdate" Then
    Me.txtFocus.SetFocus
End If
Me.cmdUpdate.Visible = False

End Function
