Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =186
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =11160
    DatasheetFontHeight =11
    ItemSuffix =45
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0xb86c11ff0e38e440
    End
    OnDirty ="[Event Procedure]"
    RecordSource ="Visits"
    Caption ="Visits"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =186
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =186
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =0
            BackColor =6108695
            Name ="FormHeader"
        End
        Begin Section
            CanGrow = NotDefault
            Height =5460
            BackColor =16252927
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =93
                    TextFontCharSet =163
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2100
                    Top =450
                    Width =1680
                    Height =330
                    ColumnWidth =1620
                    TabIndex =1
                    BorderColor =7169897
                    Name ="VisitDate"
                    ControlSource ="VisitDate"
                    Format ="Short Date"
                    RowGroup =4
                    GroupTable =13

                    LayoutCachedLeft =2100
                    LayoutCachedTop =450
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =780
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =450
                            Width =1680
                            Height =330
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="VisitDate_Label"
                            Caption ="Visit Date"
                            FontName ="Franklin Gothic Book"
                            RowGroup =4
                            GroupTable =13
                            LayoutCachedLeft =360
                            LayoutCachedTop =450
                            LayoutCachedWidth =2040
                            LayoutCachedHeight =780
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =85
                    TextFontCharSet =163
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2100
                    Top =855
                    Width =6300
                    Height =600
                    ColumnWidth =3000
                    TabIndex =2
                    BorderColor =7169897
                    Name ="Comments"
                    ControlSource ="Comments"
                    RowGroup =2
                    GroupTable =11

                    LayoutCachedLeft =2100
                    LayoutCachedTop =855
                    LayoutCachedWidth =8400
                    LayoutCachedHeight =1455
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =855
                            Width =1680
                            Height =600
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="Comments_Label"
                            Caption ="Comments"
                            FontName ="Franklin Gothic Book"
                            RowGroup =2
                            GroupTable =11
                            LayoutCachedLeft =360
                            LayoutCachedTop =855
                            LayoutCachedWidth =2040
                            LayoutCachedHeight =1455
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =93
                    TextFontCharSet =163
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2100
                    Top =60
                    Width =1680
                    Height =315
                    ColumnWidth =1515
                    BorderColor =7169897
                    Name ="VisitType"
                    ControlSource ="VisitTypeID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lkupVisitTypes.ID, lkupVisitTypes.VisitType FROM lkupVisitTypes ORDER BY "
                        "lkupVisitTypes.VisitType;"
                    ColumnWidths ="0;1440"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    RowGroup =3
                    GroupTable =13
                    AllowValueListEdits =0

                    LayoutCachedLeft =2100
                    LayoutCachedTop =60
                    LayoutCachedWidth =3780
                    LayoutCachedHeight =375
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =60
                            Width =1680
                            Height =315
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="VisitType_Label"
                            Caption ="Visit Type"
                            FontName ="Franklin Gothic Book"
                            RowGroup =3
                            GroupTable =13
                            LayoutCachedLeft =360
                            LayoutCachedTop =60
                            LayoutCachedWidth =2040
                            LayoutCachedHeight =375
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =2100
                    Top =1560
                    Width =8655
                    Height =3780
                    TabIndex =3
                    Name ="CamPhotosSubform"
                    SourceObject ="Form.PhotosSubform"
                    LinkChildFields ="VisitID"
                    LinkMasterFields ="VisitID"
                    RowGroup =1
                    GroupTable =4

                    LayoutCachedLeft =2100
                    LayoutCachedTop =1560
                    LayoutCachedWidth =10755
                    LayoutCachedHeight =5340
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            TextFontFamily =34
                            Left =360
                            Top =1560
                            Width =1680
                            Height =3780
                            BackColor =16252927
                            ForeColor =7169897
                            Name ="CamPhotos Subform Label"
                            Caption ="Photos"
                            FontName ="Franklin Gothic Book"
                            EventProcPrefix ="CamPhotos_Subform_Label"
                            RowGroup =1
                            GroupTable =4
                            LayoutCachedLeft =360
                            LayoutCachedTop =1560
                            LayoutCachedWidth =2040
                            LayoutCachedHeight =5340
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =9780
                    Top =120
                    Width =996
                    Height =576
                    TabIndex =4
                    Name ="cmdNextVisit"
                    Caption ="Next Visit"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Next Record"

                    LayoutCachedLeft =9780
                    LayoutCachedTop =120
                    LayoutCachedWidth =10776
                    LayoutCachedHeight =696
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8700
                    Top =120
                    Width =996
                    Height =576
                    TabIndex =5
                    Name ="cmdPreviousVisit"
                    Caption ="Previous Visit"
                    OnClick ="[Event Procedure]"
                    FontName ="Trebuchet MS"
                    ControlTipText ="Previous Record"

                    LayoutCachedLeft =8700
                    LayoutCachedTop =120
                    LayoutCachedWidth =9696
                    LayoutCachedHeight =696
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =87
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3780
                    Top =60
                    Width =180
                    Height =315
                    TabIndex =6
                    ForeColor =2366701
                    Name ="txtVisitTypeReqd"
                    ControlSource ="=IIf([VisitType] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3780
                    LayoutCachedTop =60
                    LayoutCachedWidth =3960
                    LayoutCachedHeight =375
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =87
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3780
                    Top =450
                    Width =180
                    Height =330
                    TabIndex =7
                    ForeColor =2366701
                    Name ="txtVisitDateReqd"
                    ControlSource ="=IIf([VisitDate] Is Null,\"*\",\"\")"

                    LayoutCachedLeft =3780
                    LayoutCachedTop =450
                    LayoutCachedWidth =3960
                    LayoutCachedHeight =780
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const strGenericError As String = _
    "The Visits form encountered an error."

Private Sub cmdNextVisit_Click()
'Next record

On Error Resume Next

DoCmd.GoToRecord

End Sub

Private Sub cmdPreviousVisit_Click()
'Previous record

On Error Resume Next

DoCmd.GoToRecord , , acPrevious

End Sub

Private Sub Form_Current()
'Enable/disable navigation buttons based on current record

On Error GoTo ErrHandler

Me.VisitType.SetFocus
Me.cmdPreviousVisit.Enabled = Not (CurrentRecord = 1)
Me.cmdNextVisit.Enabled = Not Me.NewRecord

Call VisitType_AfterUpdate
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

Private Sub Form_Dirty(Cancel As Integer)
'Enable next button (disabled on new records)

On Error GoTo ErrHandler

Me.cmdNextVisit.Enabled = True
Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

Private Sub VisitType_AfterUpdate()
'Show/hide subform based on visit type

On Error GoTo ErrHandler

'Enable photos subform for visits other than setup
If IsNull(Me.VisitType) Or Me.VisitType = 3 Then
    Me.CamPhotosSubform.Visible = False
Else
    Me.CamPhotosSubform.Visible = True
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub

Private Sub VisitType_BeforeUpdate(Cancel As Integer)

On Error GoTo ErrHandler

If Me!VisitType = 3 Then
    If DCount("*", "Photos", "VisitID=" & Nz(Me.VisitID, 0)) > 0 Then
        Cancel = True
        Me!VisitType.Undo
        MsgBox "You cannot change this visit to a set " & _
            "because it is already associated with photos."
    End If
End If

Exit Sub

ErrHandler:
    ErrorMsg strGenericError, Err.Number, Err.Description, Me.Name

End Sub
