Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =204
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =5400
    DatasheetFontHeight =11
    ItemSuffix =20
    Left =3495
    Top =2490
    Right =28545
    Bottom =15015
    RecSrcDt = Begin
        0x726e623a977ce440
    End
    RecordSource ="Individuals"
    Caption ="ReferencePhotos"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    OnResize ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            TextFontFamily =18
            FontSize =10
            BorderColor =11644565
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            BackStyle =0
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Line
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            LabelX =230
            LabelY =-30
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            BackStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            BackStyle =0
            LabelX =-1800
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            TextFontCharSet =204
            LabelX =-1800
            FontSize =11
            BorderColor =11644565
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin Subform
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            BackStyle =0
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            TextFontFamily =18
            FontWeight =400
            ForeColor =7233610
            FontName ="Constantia"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =16118511
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            TextFontCharSet =204
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =11644565
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineColor =7233610
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
        End
        Begin FormHeader
            Height =0
            BackColor =6108695
            Name ="FormHeader"
        End
        Begin Section
            Height =8280
            BackColor =16252927
            Name ="Detail"
            AlternateBackColor =16777215
            Begin
                Begin Image
                    OldBorderStyle =0
                    Left =120
                    Top =480
                    Width =5160
                    Height =3840
                    Name ="imgRef1"
                    OnDblClick ="[Event Procedure]"
                    ControlSource ="ReferencePhoto1"

                    LayoutCachedLeft =120
                    LayoutCachedTop =480
                    LayoutCachedWidth =5280
                    LayoutCachedHeight =4320
                    TabIndex =9
                End
                Begin Image
                    OldBorderStyle =0
                    Left =120
                    Top =4380
                    Width =5160
                    Height =3840
                    Name ="imgRef2"
                    OnDblClick ="[Event Procedure]"
                    ImageData = Begin
                        0x00000000
                    End
                    ControlSource ="ReferencePhoto2"

                    LayoutCachedLeft =120
                    LayoutCachedTop =4380
                    LayoutCachedWidth =5280
                    LayoutCachedHeight =8220
                    TabIndex =8
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =180
                    Top =120
                    Width =5040
                    Height =315
                    FontSize =10
                    TabIndex =7
                    BorderColor =7169897
                    Name ="txtCurrentIndividual"
                    ControlSource ="=\"Reference photos for \" & [IndividualName]"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =180
                    LayoutCachedTop =120
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =435
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    BorderColor =7169897
                    Name ="txtFocus"

                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3660
                    Top =3960
                    Width =735
                    Height =285
                    FontSize =10
                    TabIndex =1
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkRef1"
                    ControlSource ="=\"Change\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to select a different reference photo"

                    LayoutCachedLeft =3660
                    LayoutCachedTop =3960
                    LayoutCachedWidth =4395
                    LayoutCachedHeight =4245
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3660
                    Top =7860
                    Width =735
                    Height =285
                    FontSize =10
                    TabIndex =4
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkRef2"
                    ControlSource ="=\"Change\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to select a different reference photo"

                    LayoutCachedLeft =3660
                    LayoutCachedTop =7860
                    LayoutCachedWidth =4395
                    LayoutCachedHeight =8145
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =255
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4440
                    Top =3960
                    Width =780
                    Height =285
                    FontSize =10
                    TabIndex =3
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkRemoveRef1"
                    ControlSource ="=\"Remove\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to remove this reference photo"

                    LayoutCachedLeft =4440
                    LayoutCachedTop =3960
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =4245
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =255
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4440
                    Top =7860
                    Width =780
                    Height =285
                    FontSize =10
                    TabIndex =6
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkRemoveRef2"
                    ControlSource ="=\"Remove\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to remove this reference photo"

                    LayoutCachedLeft =4440
                    LayoutCachedTop =7860
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =8145
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4680
                    Top =3960
                    Width =540
                    Height =285
                    FontSize =10
                    TabIndex =2
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkAddRef1"
                    ControlSource ="=\"Add\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to add a reference photo"

                    LayoutCachedLeft =4680
                    LayoutCachedTop =3960
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =4245
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    TabStop = NotDefault
                    IsHyperlink = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =247
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4680
                    Top =7860
                    Width =540
                    Height =285
                    FontSize =10
                    TabIndex =5
                    BorderColor =7169897
                    ForeColor =7233610
                    Name ="lnkAddRef2"
                    ControlSource ="=\"Add\""
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to add a reference photo"

                    LayoutCachedLeft =4680
                    LayoutCachedTop =7860
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =8145
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =6108695
            Name ="FormFooter"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const iSpace As Integer = 90
Private Const dblRatio As Double = 1.3333

Private Sub Form_Current()
'Show links depending on which photos are set

Dim bBlank As Boolean

bBlank = IsNull(Me.ReferencePhoto1)
Me.lnkAddRef1.Visible = bBlank
Me.lnkRef1.Visible = Not bBlank
Me.lnkRemoveRef1.Visible = Not bBlank

bBlank = IsNull(Me.ReferencePhoto2)
Me.lnkAddRef2.Visible = bBlank
Me.lnkRef2.Visible = Not bBlank
Me.lnkRemoveRef2.Visible = Not bBlank

End Sub

Private Sub Form_Resize()
'Resize controls to fit

ResizeForm

End Sub

Private Sub imgRef1_DblClick(Cancel As Integer)
'Open photo in default program

OpenPhoto Me.ReferencePhoto1

End Sub

Private Sub imgRef2_DblClick(Cancel As Integer)
'Open photo in default program

OpenPhoto Me.ReferencePhoto2

End Sub

Private Sub lnkAddRef1_Click()
'Browse for new photo

Me.txtFocus.SetFocus
GetNewPhoto 1

End Sub

Private Sub lnkAddRef2_Click()
'Browse for new photo

Me.txtFocus.SetFocus
GetNewPhoto 2

End Sub

Private Sub lnkRef1_Click()
'Browse for new photo

Me.txtFocus.SetFocus
GetNewPhoto 1

End Sub

Private Sub lnkRef2_Click()
'Browse for new photo

Me.txtFocus.SetFocus
GetNewPhoto 2

End Sub

Private Sub lnkRemoveRef1_Click()
'Clear field and requery form

Me.txtFocus.SetFocus
Me.ReferencePhoto1 = Null
Me.Requery

End Sub

Private Sub lnkRemoveRef2_Click()
'Clear field and requery form

Me.txtFocus.SetFocus
Me.ReferencePhoto2 = Null
Me.Requery

End Sub

Private Sub txtCurrentIndividual_GotFocus()
'Prevent clicking/tabbing into individual label

Me.txtFocus.SetFocus

End Sub

'------------------------------
'Form-specific custom functions
'------------------------------

Private Sub GetNewPhoto(iPhotoNum As Integer)
'Display dialog to select new jpg

Dim dlg As Object
Dim strFilePath As String

On Error GoTo ErrHandler

'Set dialog parameters
Set dlg = Application.FileDialog(msoFileDialogFilePicker)
strFilePath = ""
dlg.Filters.Add "Images", "*.gif; *.jpg; *.jpeg; *.bmp, " & _
    "*.tif; *.tiff; *.png"
dlg.AllowMultiSelect = False

'Get current photo as initial file
If iPhotoNum = 1 Then
    If Not IsNull(Me.ReferencePhoto1) Then
        dlg.InitialFileName = Me.ReferencePhoto1
    End If
Else
    If Not IsNull(Me.ReferencePhoto2) Then
        dlg.InitialFileName = Me.ReferencePhoto2
    End If
End If

'File selected - update field
If dlg.Show = -1 Then
    strFilePath = dlg.SelectedItems(1)
    If iPhotoNum = 1 Then
        Me.ReferencePhoto1 = strFilePath
    Else
        Me.ReferencePhoto2 = strFilePath
    End If
    Me.Requery
End If

BrowseExit:
    Set dlg = Nothing
    Exit Sub

ErrHandler:
    ErrorMsg "The browse dialog triggered an error.", _
        Err.Number, Err.Description
    Resume BrowseExit

End Sub

Private Sub ResizeForm()
'Shrink/expand photos and label

Dim lngW As Long
Dim lngH As Long
Dim lngV As Long

'Expand form to fit controls
lngW = Me.InsideWidth
If lngW > lngMaxFormWidth Then
    lngW = lngMaxFormWidth
End If
Me.Width = lngW
Me.Detail.Height = Me.InsideHeight

'Start with label
lngH = lngW - (2 * iSpace)
Me.txtCurrentIndividual.Left = iSpace
Me.txtCurrentIndividual.Top = iSpace
Me.txtCurrentIndividual.Width = lngH

'Calculate proper size for images
lngV = (Me.InsideHeight - (4 * iSpace) - _
    Me.txtCurrentIndividual.Height) / 2
If lngH / lngV > dblRatio Then
    lngH = lngV * dblRatio
Else
    lngV = lngH / dblRatio
End If

'Resize and position image controls
Me.imgRef1.Left = iSpace
Me.imgRef1.Top = Me.txtCurrentIndividual.Height + (2 * iSpace)
Me.imgRef1.Height = lngV
Me.imgRef1.Width = lngH
Me.imgRef2.Left = iSpace
Me.imgRef2.Top = Me.imgRef1.Top + lngV + iSpace
Me.imgRef2.Height = lngV
Me.imgRef2.Width = lngH

'Right align links
lngH = lngH - Me.lnkAddRef1.Width
Me.lnkAddRef1.Left = lngH
Me.lnkAddRef2.Left = lngH
lngH = lngH + Me.lnkAddRef1.Width - _
    Me.lnkRemoveRef1.Width
Me.lnkRemoveRef1.Left = lngH
Me.lnkRemoveRef2.Left = lngH
lngH = lngH - iSpace - Me.lnkRef1.Width
Me.lnkRef1.Left = lngH
Me.lnkRef2.Left = lngH

'Move links to bottom of photos
lngV = Me.imgRef1.Top + lngV - iSpace
lngV = lngV - Me.lnkRef1.Height
Me.lnkAddRef1.Top = lngV
Me.lnkRef1.Top = lngV
Me.lnkRemoveRef1.Top = lngV
lngV = Me.imgRef2.Top + Me.imgRef2.Height - iSpace
lngV = lngV - Me.lnkRef2.Height
Me.lnkAddRef2.Top = lngV
Me.lnkRef2.Top = lngV
Me.lnkRemoveRef2.Top = lngV

'Apply changes
Me.Repaint

End Sub
